# Copyright 2001-2015 Sourcefire, Inc. All Rights Reserved.
#
# This file contains (i) proprietary rules that were created, tested and certified by
# Sourcefire, Inc. (the "VRT Certified Rules") that are distributed under the VRT
# Certified Rules License Agreement (v 2.0), and (ii) rules that were created by
# Sourcefire and other third parties (the "GPL Rules") that are distributed under the
# GNU General Public License (GPL), v2.
# 
# The VRT Certified Rules are owned by Sourcefire, Inc. The GPL Rules were created
# by Sourcefire and other third parties. The GPL Rules created by Sourcefire are
# owned by Sourcefire, Inc., and the GPL Rules not created by Sourcefire are owned by
# their respective creators. Please see http://www.snort.org/snort/snort-team/ for a
# list of third party owners and their respective copyrights.
# 
# In order to determine what rules are VRT Certified Rules or GPL Rules, please refer
# to the VRT Certified Rules License Agreement (v2.0).
#
#------------------
# FILE-IMAGE RULES
#------------------

# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Oracle Outside In FlashPix image processing overflow attempt"; flow:to_server,established; flowbits:isset,file.fpx; file_data; content:"|FF D8 FF C0 00 11 08 00 40 00 40 03 01 22 00 02 11 01 03 FF 01|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2012-1744; classtype:attempted-user; sid:26979; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Oracle Outside In FlashPix image processing overflow attempt"; flow:to_server,established; flowbits:isset,file.fpx; file_data; content:"|03 01 22 00 02 11 01 03 62 01 FF DA|"; fast_pattern:only; metadata:service smtp; reference:cve,2012-1744; classtype:attempted-user; sid:26978; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Oracle Outside In FlashPix image processing overflow attempt"; flow:to_client,established; flowbits:isset,file.fpx; file_data; content:"|FF D8 FF C0 00 11 08 00 40 00 40 03 01 22 00 02 11 01 03 FF 01|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-1744; classtype:attempted-user; sid:26977; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Oracle Outside In FlashPix image processing overflow attempt"; flow:to_client,established; flowbits:isset,file.fpx; file_data; content:"|03 01 22 00 02 11 01 03 62 01 FF DA|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-1744; classtype:attempted-user; sid:26976; rev:7;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows WMF denial of service attempt"; flow:to_server,established; flowbits:isset,file.wmf; file_data; content:"|FC 02|"; pcre:"/\xFC\x02[\x08\x06]\x00.{4}(?!\x00\x00)/s"; metadata:service smtp; reference:bugtraq,21992; reference:cve,2006-4071; classtype:web-application-attack; sid:26909; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected zTXt overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"zTXt"; distance:0; byte_test:4,>,10000,-8,relative; metadata:service smtp; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:26866; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Multiple Products malformed PNG detected tEXt overflow attempt"; flow:to_server,established; file_data; content:"|89|PNG|0D 0A 1A 0A|"; fast_pattern; content:"tEXt"; distance:0; byte_test:4,>,10000,-8,relative; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,18385; reference:cve,2006-0025; reference:cve,2009-2501; reference:cve,2012-5470; reference:cve,2013-1331; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; reference:url,technet.microsoft.com/en-us/security/bulletin/ms09-062; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-051; classtype:attempted-user; sid:26865; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected iTXt overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"iTXt"; distance:0; byte_test:4,>,10000,-8,relative; metadata:service smtp; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:26864; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected tIME overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"tIME"; distance:0; byte_test:4,>,10000,-8,relative; metadata:service smtp; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:26863; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected sPLT overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"sPLT"; distance:0; byte_test:4,>,10000,-8,relative; metadata:service smtp; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:26862; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected pHYs overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"pHYs"; distance:0; byte_test:4,>,10000,-8,relative; metadata:service smtp; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:26861; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected tRNS overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"tRNS"; distance:0; byte_test:4,>,7000,-8,relative; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,13941; reference:bugtraq,18385; reference:cve,2005-1211; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:26860; rev:7;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected hIST overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"hIST"; distance:0; byte_test:4,>,10000,-8,relative; metadata:service smtp; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:26859; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected bKGD overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"bKGD"; distance:0; byte_test:4,>,10000,-8,relative; metadata:service smtp; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:26858; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected sRGB overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"sRGB"; distance:0; content:!"iCCP"; within:4; distance:-8; byte_test:4,>,10000,-8,relative; metadata:service smtp; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:26857; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected sBIT overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"sBIT"; distance:0; byte_test:4,>,10000,-8,relative; metadata:service smtp; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:26856; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected iCCP overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"iCCP"; distance:0; byte_test:4,>,10000,-8,relative; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:26855; rev:7;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected cHRM overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"cHRM"; distance:0; byte_test:4,>,7000,-8,relative; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:26854; rev:7;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Apple QuickTime PICT Image PnSize Opcode Stack Buffer Overflow attempt"; flow:to_server,established; flowbits:isset,file.pictmov; file_data; content:"|00 07|"; offset:512; fast_pattern; byte_test:2,>,0x7fff,2,relative; content:"|00 07 00 01 00|"; within:5; distance:4; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,49144; reference:cve,2011-0257; classtype:attempted-user; sid:26701; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Apple QuickTime PICT Image PnSize Opcode Stack Buffer Overflow attempt"; flow:to_client,established; flowbits:isset,file.pictmov; file_data; content:"|00 07|"; offset:512; fast_pattern; byte_test:2,>,0x7fff,2,relative; content:"|00 07 00 01 00|"; within:5; distance:4; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,49144; reference:cve,2011-0257; classtype:attempted-user; sid:26700; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Apple QuickTime PICT Image PnSize Opcode Stack Buffer Overflow attempt"; flow:to_server,established; flowbits:isset,file.pictmov; file_data; content:"|00 07|"; offset:512; byte_test:2,>,0x7fff,2,relative; content:!"|00 07|"; distance:0; metadata:policy security-ips drop, service smtp; reference:bugtraq,49144; reference:cve,2011-0257; classtype:attempted-user; sid:26699; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE BMP extremely large xpos opcodes"; flow:to_server,established; file_data; content:"BM"; depth:2; content:"|00 02 FF 00 00 02 FF 00 00 02 FF 00 00 02 FF 00 00 02 FF 00 00 02 FF 00 00 02 FF 00 00 02 FF 00|"; content:"|00 02 FF 00 00 02 FF 00 00 02 FF 00|"; within:12; distance:100; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-2729; reference:url,www.adobe.com/support/security/bulletins/apsb13-15.html; classtype:attempted-user; sid:26665; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE BMP extremely large xpos opcodes"; flow:to_client,established; file_data; content:"BM"; depth:2; content:"|00 02 FF 00 00 02 FF 00 00 02 FF 00 00 02 FF 00 00 02 FF 00 00 02 FF 00 00 02 FF 00 00 02 FF 00|"; content:"|00 02 FF 00 00 02 FF 00 00 02 FF 00|"; within:12; distance:100; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,59918; reference:cve,2013-2729; reference:url,osvdb.org/show/osvdb/93358; reference:url,www.adobe.com/support/security/bulletins/apsb13-15.html; classtype:attempted-user; sid:26664; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE ClamAV Antivirus Function Denial of Service attempt"; flow:established,to_client; flowbits:isset,file.jpeg; file_data; content:"|FF D8 FF ED|"; depth:4; content:"8BIM"; within:4; distance:16; content:"|04 09|"; within:2; content:"|FF D8 FF ED|"; distance:0; content:"8BIM"; within:4; distance:16; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,32555; reference:cve,2008-5314; classtype:attempted-dos; sid:26374; rev:9;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE ClamAV Antivirus Function Denial of Service attempt"; flow:established,to_server; flowbits:isset,file.jpeg; file_data; content:"|FF D8 FF ED|"; depth:4; content:"8BIM"; within:4; distance:16; content:"|04 09|"; within:2; content:"|FF D8 FF ED|"; distance:0; content:"8BIM"; within:4; distance:16; metadata:service smtp; reference:bugtraq,32555; reference:cve,2008-5314; classtype:attempted-dos; sid:26373; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE ClamAV Antivirus Function Denial of Service attempt"; flow:established,to_server; flowbits:isset,file.jpeg; file_data; content:"|FF D8 FF ED|"; depth:4; content:"8BIM"; within:4; distance:16; content:"|04 0C|"; within:2; content:"|FF D8 FF ED|"; distance:0; content:"8BIM"; within:4; distance:16; metadata:service smtp; reference:bugtraq,32555; reference:cve,2008-5314; classtype:attempted-dos; sid:26372; rev:4;)
alert tcp any any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE ImageMagick EXIF resolutionunit handling memory corruption attempt"; flow:to_server,established; flowbits:isset,file.jpeg|file.tiff; file_data; content:"|DE 00 00 00|(|01 03 00 CE FF FF 7F|(|01 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2012-0247; reference:url,osvdb.org/show/osvdb/79003; classtype:attempted-user; sid:25348; rev:7;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IMAGE ImageMagick EXIF resolutionunit handling memory corruption attempt"; flow:to_server,established; content:"POST"; http_method; content:"Content-Disposition|3A|"; http_client_body; content:".jpg"; distance:0; http_client_body; pcre:"/Content-Disposition\x3a[^\r\n]*?filename\s*=\s*[\x22\x27][^\x22\x27]*?\.(jpe?g|tiff?)[\x22\x27]/iP"; content:"|DE 00 00 00|(|01 03 00 CE FF FF 7F|(|01 00 00|"; fast_pattern:only; http_client_body; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2012-0247; reference:url,osvdb.org/show/osvdb/79003; classtype:attempted-user; sid:25347; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE ImageMagick EXIF resolutionunit handling memory corruption attempt"; flow:to_client,established; flowbits:isset,file.jpeg|file.tiff; file_data; content:"|DE 00 00 00|(|01 03 00 CE FF FF 7F|(|01 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0247; reference:url,osvdb.org/show/osvdb/79003; classtype:attempted-user; sid:25346; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [25,631] (msg:"FILE-IMAGE libpng chunk decompression integer overflow attempt"; flow:established,to_server; content:"|89 50 4E 47 0D 0A 1A 0A|"; content:"iTXt"; distance:0; fast_pattern; isdataat:512,relative; byte_test:4,>,0x100000,-8,relative; content:"|00|"; within:79; distance:12; content:"|00|"; within:1; metadata:service http, service smtp; reference:bugtraq,52453; reference:cve,2011-3026; reference:cve,2011-3045; classtype:attempted-admin; sid:25066; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE libpng chunk decompression integer overflow attempt"; flow:established,to_client; flowbits:isset,file.png; file_data; content:"|89 50 4E 47 0D 0A 1A 0A|"; content:"iTXt"; distance:0; fast_pattern; isdataat:512,relative; byte_test:4,>,0x7ffffff,-8,relative; content:"|00|"; within:79; distance:12; content:"|00|"; within:1; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,52453; reference:cve,2011-3026; reference:cve,2011-3045; classtype:attempted-admin; sid:25065; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Oracle Outside In JPEG COC parameter buffer overflow attempt"; flow:to_server,established; file_data; flowbits:isset,file.jp2; content:"|FF 90|"; fast_pattern:only; content:"|FF 53|"; byte_jump:2,0,relative,post_offset -6; byte_test:1,>,32,0,relative; content:"|FF 93|"; distance:0; metadata:policy max-detect-ips drop, service smtp; reference:cve,2011-4516; classtype:attempted-user; sid:24718; rev:8;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Oracle Outside In JPEG COD parameter buffer overflow attempt"; flow:to_server,established; file_data; flowbits:isset,file.jp2; content:"|FF 90|"; fast_pattern:only; content:"|FF 52|"; byte_jump:2,0,relative,post_offset -7; byte_test:1,>,32,0,relative; content:"|FF 93|"; distance:0; metadata:policy max-detect-ips drop, service smtp; reference:cve,2011-4516; classtype:attempted-user; sid:24717; rev:8;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Oracle Outside In JPEG COC parameter buffer overflow attempt"; flow:to_server,established; file_data; flowbits:isset,file.jp2; content:"|FF 4F FF 51|"; fast_pattern:only; content:"|FF 53|"; byte_jump:2,0,relative,post_offset -6; byte_test:1,>,32,0,relative; content:"|FF 5C|"; distance:0; metadata:policy max-detect-ips drop, service smtp; reference:cve,2011-4516; classtype:attempted-user; sid:24716; rev:8;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Oracle Outside In JPEG COD parameter buffer overflow attempt"; flow:to_server,established; file_data; flowbits:isset,file.jp2; content:"|FF 4F FF 51|"; fast_pattern:only; content:"|FF 52|"; byte_jump:2,0,relative,post_offset -7; byte_test:1,>,32,0,relative; content:"|FF 5C|"; distance:0; metadata:policy max-detect-ips drop, service smtp; reference:cve,2011-4516; classtype:attempted-user; sid:24715; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Oracle Outside In JPEG COC parameter buffer overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.jp2; content:"|FF 90|"; fast_pattern:only; content:"|FF 53|"; byte_jump:2,0,relative,post_offset -6; byte_test:1,>,32,0,relative; content:"|FF 93|"; distance:0; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-4516; classtype:attempted-user; sid:24714; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Oracle Outside In JPEG COD parameter buffer overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.jp2; content:"|FF 90|"; fast_pattern:only; content:"|FF 52|"; byte_jump:2,0,relative,post_offset -7; byte_test:1,>,32,0,relative; content:"|FF 93|"; distance:0; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-4516; classtype:attempted-user; sid:24713; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Oracle Outside In JPEG COC parameter buffer overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.jp2; content:"|FF 4F FF 51|"; fast_pattern:only; content:"|FF 53|"; byte_jump:2,0,relative,post_offset -6; byte_test:1,>,32,0,relative; content:"|FF 5C|"; distance:0; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-4516; classtype:attempted-user; sid:24712; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Oracle Outside In JPEG COD parameter buffer overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.jp2; content:"|FF 4F FF 51|"; fast_pattern:only; content:"|FF 52|"; byte_jump:2,0,relative,post_offset -7; byte_test:1,>,32,0,relative; content:"|FF 5C|"; distance:0; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-4516; classtype:attempted-user; sid:24711; rev:8;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Apple QuickTime PICT file opcode corruption attempt"; flow:to_server,established; flowbits:isset,file.pct; file_data; content:"|00 11 02 FF|"; isdataat:2,relative; content:!"|0C 00|"; within:2; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,53584; reference:cve,2012-0671; reference:url,community.qualys.com/docs/DOC-3511; reference:url,support.apple.com/kb/HT5261; classtype:attempted-user; sid:24695; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Apple QuickTime PICT file opcode corruption attempt"; flow:to_client,established; flowbits:isset,file.pct; file_data; content:"|00 11 02 FF|"; depth:4; offset:522; isdataat:2,relative; content:!"|0C 00|"; within:2; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,53584; reference:cve,2012-0671; reference:url,community.qualys.com/docs/DOC-3511; reference:url,support.apple.com/kb/HT5261; classtype:attempted-user; sid:24694; rev:7;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Apple QuickTime PICT Image PnSize Opcode Stack Buffer Overflow attempt"; flow:to_server,established; flowbits:isset,file.pct; file_data; content:"PICT"; depth:4; isdataat:594,relative; content:"|00 07|"; within:2; distance:594; byte_test:2,>,0x7fff,2,relative; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,49144; reference:cve,2011-0257; classtype:attempted-user; sid:24553; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Apple QuickTime PICT Image PnSize Opcode Stack Buffer Overflow attempt"; flow:to_server,established; flowbits:isset,file.pictmov; file_data; content:"|00 07|"; byte_test:2,>,0x7fff,2,relative; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,49144; reference:cve,2011-0257; classtype:attempted-user; sid:24552; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Apple QuickTime PICT Image PnSize Opcode Stack Buffer Overflow attempt"; flow:to_client,established; flowbits:isset,file.pictmov; file_data; content:"|00 07|"; offset:512; byte_test:2,>,0x7fff,2,relative; content:!"|00 07|"; distance:0; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,49144; reference:cve,2011-0257; classtype:attempted-user; sid:24551; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE XPM file format overflow attempt"; flow:to_server,established; flowbits:isset,file.xpm; file_data; content:"/* XPM */"; pcre:"/^\s*\x22[^\x22\n]{300}/mi"; metadata:service smtp; reference:bugtraq,23620; reference:cve,2007-2193; classtype:attempted-user; sid:24189; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows GDI+ TIFF file parsing heap overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff; file_data; content:"|01 00 01 00 01 00 01 00|"; depth:8; offset:278; content:"|02 01 03 00 04 00 00 00 16 01 00 00|"; content:"|06 01 03 00 01 00 00 00 05 00 00 00|"; distance:0; metadata:service smtp; reference:bugtraq,36646; reference:cve,2009-2502; reference:url,osvdb.org/show/osvdb/58865; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:23590; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows GDI+ TIFF file parsing heap overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff; file_data; content:"|01 00 01 00 01 00 01 00|"; depth:8; offset:266; content:"|02 01 03 00 04 00 00 00 0A 01 00 00|"; content:"|06 01 03 00 01 00 00 00 05 00 00 00|"; distance:0; metadata:service smtp; reference:bugtraq,36646; reference:cve,2009-2502; reference:url,osvdb.org/show/osvdb/58865; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:23589; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Kodak Imaging large offset malformed tiff - big-endian"; flow:to_server,established; flowbits:isset,file.tiff.big; file_data; content:"|01 02 00 03|"; byte_test:4,>,6,0,relative,big; metadata:service smtp; reference:cve,2007-2217; reference:cve,2010-3950; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-055; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-105; classtype:attempted-user; sid:23561; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows graphics rendering engine buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.emf; file_data; content:"|20|EMF"; depth:4; offset:40; byte_test:4,<,0x58,4,little; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,11375; reference:cve,2004-0209; classtype:attempted-user; sid:23110; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [25,631] (msg:"FILE-IMAGE libpng chunk decompression integer overflow attempt"; flow:established,to_server; content:"|89 50 4E 47 0D 0A 1A 0A|"; content:"iCCP"; distance:0; fast_pattern; isdataat:512,relative; byte_test:4,>,0x100000,-8,relative; metadata:policy max-detect-ips drop, service http, service smtp; reference:bugtraq,52453; reference:cve,2011-3026; reference:cve,2011-3045; classtype:attempted-admin; sid:22109; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [25,631] (msg:"FILE-IMAGE libpng chunk decompression integer overflow attempt"; flow:established,to_server; content:"|89 50 4E 47 0D 0A 1A 0A|"; content:"iTXt"; distance:0; fast_pattern; isdataat:512,relative; byte_test:4,>,0x100000,-8,relative; metadata:policy max-detect-ips drop, service http, service smtp; reference:bugtraq,52453; reference:cve,2011-3026; reference:cve,2011-3045; classtype:attempted-admin; sid:22108; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [25,631] (msg:"FILE-IMAGE libpng chunk decompression integer overflow attempt"; flow:established,to_server; content:"|89 50 4E 47 0D 0A 1A 0A|"; content:"zTXt"; distance:0; fast_pattern; isdataat:512,relative; byte_test:4,>,0x100000,-8,relative; metadata:policy max-detect-ips drop, service http, service smtp; reference:bugtraq,52453; reference:cve,2011-3026; reference:cve,2011-3045; classtype:attempted-admin; sid:22107; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE libpng chunk decompression integer overflow attempt"; flow:established,to_client; flowbits:isset,file.png; file_data; content:"|89 50 4E 47 0D 0A 1A 0A|"; content:"iCCP"; distance:0; fast_pattern; isdataat:512,relative; byte_test:4,>,0x100000,-8,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,52453; reference:cve,2011-3026; reference:cve,2011-3045; classtype:attempted-admin; sid:22106; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE libpng chunk decompression integer overflow attempt"; flow:established,to_client; flowbits:isset,file.png; file_data; content:"|89 50 4E 47 0D 0A 1A 0A|"; content:"iTXt"; distance:0; fast_pattern; isdataat:512,relative; byte_test:4,>,0x100000,-8,relative; content:"|00|"; within:79; distance:12; content:"|01|"; within:1; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,52453; reference:cve,2011-3026; reference:cve,2011-3045; classtype:attempted-admin; sid:22105; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE libpng chunk decompression integer overflow attempt"; flow:established,to_client; flowbits:isset,file.png; file_data; content:"|89 50 4E 47 0D 0A 1A 0A|"; content:"zTXt"; distance:0; fast_pattern; isdataat:512,relative; byte_test:4,>,0x100000,-8,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,52453; reference:cve,2011-3026; reference:cve,2011-3045; classtype:attempted-admin; sid:22104; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Photoshop CS4 TIFF parsing heap overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.little; file_data; content:"|03 01 03 00 01 00 00 00 74 87|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-2027; reference:url,www.adobe.com/support/security/bulletins/apsb12-11.html; classtype:attempted-user; sid:21948; rev:9;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Apple QuickDraw PICT images ARGB records handling memory corruption attempt"; flow:to_server,established; file_data; content:"|00 11 02 FF|"; depth:4; offset:522; content:"|00 9A 00 00 00 FF 80|"; distance:0; content:!"|00|"; within:1; distance:10; metadata:service smtp; reference:bugtraq,22207; reference:cve,2007-0462; classtype:attempted-user; sid:21766; rev:6;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows GDI+ arbitrary code execution attempt"; flow:to_server,established; flowbits:isset,file.emf; file_data; content:"|58 00 69 00 62 00 6E 00 61 00 57 00 6D 00 5A 00 31 00 63 00 38 00 42 00 4B 00 37 00 4D 00 71 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2011-0041; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-029; classtype:attempted-user; sid:21439; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows GDI+ TIFF file parsing heap overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff; file_data; content:"|01 00 01 00 01 00 01 00|"; depth:8; offset:278; content:"|02 01 03 00 04 00 00 00 16 01 00 00|"; content:"|06 01 03 00 01 00 00 00 05 00 00 00|"; distance:0; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,36646; reference:cve,2009-2502; reference:url,osvdb.org/show/osvdb/58865; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:21160; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Photoshop CS5 gif file heap corruption attempt"; flow:to_client,established; flowbits:isset,file.gif; file_data; content:"|FF 00 9B 09 1C 28 D0 CA 1A 02 02 49 28 20 C8 70 C0 40 32 11 46 34|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,49106; reference:cve,2011-2131; reference:url,osvdb.org/show/osvdb/74422; classtype:attempted-user; sid:20637; rev:12;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Photoshop CS5 gif file heap corruption attempt"; flow:to_client,established; flowbits:isset,file.gif; file_data; content:"|04 7F FF 00 00 08 0D 00 01 00 B0 63 67 20 C1 83 08 ED 04 04 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,49106; reference:cve,2011-2131; reference:url,osvdb.org/show/osvdb/74422; classtype:attempted-user; sid:20636; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Public LibTiff Exploit"; flow:to_client,established; flowbits:isset,file.tiff.little; file_data; content:"|63 89 E7 68 2F 73 68 00 68 2F 62 69 6E|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2006-3459; classtype:attempted-user; sid:20295; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Reader and Acrobat Libtiff TIFFFetchShortPair stack buffer overflow attempt"; flow:to_client,established; file_data; content:"|49 49 2A 00 1E 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 08 00 00 01 03 00 01 00 00 00 08 00 00 00 01 01 03 00 01 00 00 00 08 00 00 00 03 01 03 00 01 00 00 00 AA 00 00 00 06 01 03 00 01 00 00 00 BB 00 00 00 11 01 04 00 01 00 00 00 08 00 00 00 17 01 04 00 01 00 00 00 15 00 00 00 1C 01 03 00 01 00 00 00 01 00 00 00 50 01 03 00|"; fast_pattern:only; content:"|84 00 00 00 00 00 00 00|"; isdataat:196; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2006-3459; classtype:attempted-user; sid:20294; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Apple Quicktime PictureViewer GIF rendering vulnerability"; flow:to_client,established; flowbits:isset,file.gif; file_data; content:"GIF"; depth:3; content:"|01 00 00 00 21 F9 04 00 00 00 00 00 2C 00 00 00 00 00 01 00 01 00 FF FF|"; within:24; distance:6; fast_pattern; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2005-1106; classtype:attempted-user; sid:20059; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe jpeg 2000 image exploit attempt"; flow:to_client,established; file_data; content:"|FF 52 40 C3 AF 47 81 32 CF 93 99 8C FF 47 1E 0D D9 88 28|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2098; reference:url,www.adobe.com/support/security/bulletins/apsb11-16.html; classtype:attempted-user; sid:19247; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows MSPaint jpeg with malformed SOFx field exploit attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|FF C0 00 11 08 FF 37 55 99 03 01 22 00 02 11 01 03 11 01|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-0028; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-003; classtype:attempted-user; sid:19130; rev:15;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows GDI+ arbitrary code execution attempt"; flow:to_client,established; flowbits:isset,file.emf; file_data; content:"|60 00 00 00 02 10 C0 DB 09 00 00 00 00 00 00 00 00 00 80 3F 00 00 80 3F 00 00 FA 44 02 00 00 4D|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0041; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-029; classtype:attempted-user; sid:18645; rev:14;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Apple QuickTime PictureViewer buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|4A 46 49 46|"; content:"|EB 06 44 00|"; distance:0; content:"|42 42 42 42|"; distance:0; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,16202; reference:cve,2005-2340; classtype:attempted-user; sid:18600; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Apple QuickTime PictureViewer buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|4A 46 49 46|"; content:"|B8 EC 12 00|"; within:4; distance:269; content:"|42 42 42 42|"; within:4; distance:37; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,16202; reference:cve,2005-2340; classtype:attempted-user; sid:18599; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows wmf integer overflow attempt"; flow:to_client,established; file_data; content:"|D7 CD C6 9A 00 00|"; content:"|00 00 00 00|"; within:4; distance:10; content:"|09 00|"; within:2; distance:4; content:"|38 05|"; distance:0; byte_test:4,<,255,-6,relative,little; byte_test:2,>,4095,0,relative,little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,25302; reference:cve,2007-3034; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-046; classtype:web-application-attack; sid:18583; rev:15;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Apple QuickTime PICT file overread buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.pct; file_data; stream_size:server,<,16000; content:"|00 11 02 FF 0C 00 FF|"; byte_jump:2,-17,relative,post_offset -4,big; isdataat:1,relative; content:!"|00 FF|"; within:2; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,28583; reference:cve,2008-1019; classtype:attempted-user; sid:18561; rev:14;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Apple QuickTime FlashPix Movie file integer overflow attempt"; flow:to_client,established; flowbits:isset,file.fpx; file_data; content:"|00 01 00 54 C1 CE 11 85 53 00 AA 00 A1 F9 5B 01 00 00 00|"; byte_test:4,>,0x0FFFFFFF,12,relative,little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,39020; reference:cve,2010-0519; classtype:attempted-user; sid:18510; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows Flashpix graphics filter fpx32.flt remote code execution attempt"; flow:to_client,established; flowbits:isset,file.fpx; file_data; content:"|FE FF 00 00|"; content:"|00 64 61 56 54 C1 CE 11 85 53 00 AA 00 A1 F9 5B 01 00 00 00 00 64 61 56 54 C1 CE 11 85 53 00 AA 00 A1 F9 5B|"; within:36; distance:4; byte_jump:4,0,relative,little; byte_test:4,>,0,-44,relative; content:"|00 00 00 00|"; within:4; distance:-40; byte_jump:4,0,relative,little; byte_test:4,>,0x100,-8,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-3951; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-105; classtype:attempted-user; sid:18237; rev:14;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft FlashPix tile length overflow attempt"; flow:to_client,established; flowbits:isset,file.fpx; file_data; content:"|FF 5F 00 00 02 00 00 00 00 11 01 FE 56 0B 00 00 3C 0A 00 00|"; fast_pattern:only; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-3952; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-105; classtype:attempted-user; sid:18229; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Apple Quicktime FlashPix processing overflow attempt"; flow:to_client, established; flowbits:isset,file.fpx; file_data; content:"|D0 CF 11 E0 A1 B1 1A E1|"; content:"|FE FF 09 00|"; within:4; distance:20; content:"|00 00 80 00|"; within:4; distance:12; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,36328; reference:cve,2009-2798; classtype:attempted-user; sid:17740; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe BMP image handler buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.bmp; content:"Content-Type: text/plain|0D 0A 0D 0A|BM"; fast_pattern:only; file_data; content:"BM"; content:"|00 00 00 00|"; within:4; distance:4; byte_test:4, >, 256, 36, relative, little; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,28874; reference:cve,2008-1765; classtype:attempted-user; sid:17678; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Sun Microsystems Java gif handling memory corruption attempt"; flow:to_client,established; file_data; content:"|52 4B 55 F6 EF DF 63 70 A3 6C 5C 5B 48 71 BB 7A 70 77 3B 44 69 5B|"; fast_pattern:only; metadata:service http; reference:bugtraq,22085; reference:cve,2007-0243; classtype:attempted-user; sid:17628; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 631 (msg:"FILE-IMAGE CUPS Gif Decoding Routine Buffer Overflow attempt"; flow:to_server,established; content:"GIF89a"; content:"|3A 00 0B 00 00 0D 2C 00 FF|"; within:1024; metadata:policy max-detect-ips drop, service http; reference:bugtraq,28544; reference:cve,2008-1373; classtype:attempted-user; sid:17558; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Oracle Java Web Start Splashscreen GIF decoding buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.gif; file_data; content:"|46 38 39 61 FF FF FF FF B3 FF 00 FF FF FF CD CD CD A6 A6 A3 0E 0D 0D 05 05 83 ED EC EC AB AB B4|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2008-2086; classtype:attempted-user; sid:17395; rev:14;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE ClamAV Antivirus Function Denial of Service attempt"; flow:established,to_client; flowbits:isset,file.jpeg; file_data; content:"|FF D8 FF ED|"; depth:4; content:"8BIM"; within:4; distance:16; content:"|04 0C|"; within:2; content:"|FF D8 FF ED|"; distance:0; content:"8BIM"; within:4; distance:16; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,32555; reference:cve,2008-5314; classtype:attempted-dos; sid:17390; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE OpenOffice EMF file EMR record parsing integer overflow attempt"; flow:to_client,established; flowbits:isset,file.emf; file_data; content:"|54 00 00 00|"; byte_test:4,>=,0x80000000,40,relative,little; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2008-2238; reference:url,www.openoffice.org/security/cves/CVE-2008-2238.html; classtype:attempted-user; sid:17388; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows GRE WMF Handling Memory Read Exception attempt"; flow:to_client,established; flowbits:isset,file.wmf; file_data; content:"|00 09 00 00 03|"; content:"|04 00 00 00|"; distance:0; pcre:"/^(\x01|\x02)\x00\x09\x00{2}\x03/m"; pcre:"/\x04\x00{3}(\x26|\xff)/Rm"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,16167; reference:cve,2006-0143; classtype:attempted-user; sid:17330; rev:15;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Kodak Imaging large offset malformed tiff - big-endian"; flow:to_client,established; flowbits:isset,file.tiff.big; file_data; content:"|01 02 00 03|"; byte_test:4,>,6,0,relative,big; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2007-2217; reference:cve,2010-3950; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-055; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-105; classtype:attempted-user; sid:17232; rev:21;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Kodak Imaging small offset malformed tiff - little-endian"; flow:to_client,established; flowbits:isset,file.tiff.little; file_data; content:"|02 01 03 00|"; byte_test:4,>,6,0,relative,little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2007-2217; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-055; classtype:attempted-user; sid:17231; rev:19;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Photoshop CS4 ABR file processing buffer overflow attempt"; flow:to_client,established; file_data; content:"AnglUntF|23|Ang"; byte_test:4,>,1020,8,relative,big; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,40389; reference:cve,2010-1296; classtype:attempted-user; sid:17147; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Photoshop CS4 GRD file processing buffer overflow attempt"; flow:to_client,established; file_data; content:"|00|G|00|r|00|a|00|d|00|i|00|e|00|n|00|t"; nocase; byte_test:4,>,1020,13,relative,big; content:"8BGR"; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,40389; reference:cve,2010-1296; classtype:attempted-user; sid:17146; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Photoshop CS4 ASL file processing buffer overflow attempt"; flow:to_client,established; file_data; content:"Stylenum"; nocase; byte_test:4,>,1020,8,relative,big; content:"8BSL"; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,40389; reference:cve,2010-1296; classtype:attempted-user; sid:17145; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Photoshop CS4 ABR file processing buffer overflow attempt - 2"; flow:to_client,established; file_data; content:"AnglUntF"; nocase; byte_test:4,>,1020,12,relative,big; content:"8BBR"; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,40389; reference:cve,2010-1296; classtype:attempted-user; sid:17144; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Photoshop CS4 ABR file processing buffer overflow attempt - 1"; flow:to_client,established; file_data; content:"AnglUntF"; nocase; byte_test:4,>,1020,12,relative,big; content:"8BIM"; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,40389; reference:cve,2010-1296; classtype:attempted-user; sid:17143; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Oracle Java Web Start Splashscreen PNG processing buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.png; file_data; content:"|89|PNG|0D 0A 1A 0A 00 00 00 0D|IHDR"; depth:16; pcre:"/^([^\x00]|\x00[^\x00]|.{4}[^\x00]|.{4}\x00[^\x00]|.{8}[\x11-\xff])/Rs"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,34240; reference:cve,2009-1097; classtype:attempted-user; sid:16716; rev:15;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows Paint JPEG with malformed SOFx field"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|FF C0 00 11 08 FF 00|U|AC 03 01 22 00 02 11 01 03 11 01|"; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-0028; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-005; classtype:attempted-user; sid:16422; rev:17;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe tiff oversized image length attempt"; flow:to_client,established; flowbits:isset,file.tiff.little; file_data; content:"|14 01 00 00 01 01 04 00 01 00 00 00 01 01 01 01 02 01 03 00|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2009-2995; classtype:attempted-user; sid:16321; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows GDI+ interlaced PNG file parsing heap overflow attempt"; flow:to_client,established; flowbits:isset,file.png; file_data; content:"|89|PNG|0D 0A 1A 0A 00 00 00 0D|IHDR"; byte_test:4,>,59000,0,relative,big; byte_test:4,>,32000,4,relative,big; byte_test:1,>,7,8,relative; content:"|06|"; within:1; distance:9; content:"|01|"; within:1; distance:2; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2009-3126; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:16186; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows GDI+ TIFF file parsing heap overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff; file_data; content:"|01 00 01 00 01 00 01 00|"; depth:8; offset:266; content:"|02 01 03 00 04 00 00 00 0A 01 00 00|"; content:"|06 01 03 00 01 00 00 00 05 00 00 00|"; distance:0; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,36646; reference:cve,2009-2502; reference:url,osvdb.org/show/osvdb/58865; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:16184; rev:14;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows malformed WMF meta escape record memory corruption"; flow:to_client,established; flowbits:isset,file.wmf; file_data; content:"WMFC|01 00 00 00|"; byte_test:4,>,1000000,14,relative,little; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2009-2500; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:16153; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Apple QuickTime bitmap multiple header overflow"; flow:to_client,established; flowbits:isset,file.bmp; file_data; content:"BM"; content:"|00 00 00 00|"; within:4; distance:4; byte_test:4,>,65535,4,relative,little; byte_test:4,>,3,12,relative,little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,17953; reference:cve,2006-2238; classtype:attempted-user; sid:16054; rev:14;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Apple QuickDraw PICT images ARGB records handling memory corruption attempt"; flow:to_client,established; file_data; content:"|00 11 02 FF|"; depth:4; offset:522; content:"|00 9A 00 00 00 FF 80|"; distance:0; content:!"|00|"; within:1; distance:10; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,22207; reference:cve,2007-0462; classtype:attempted-user; sid:16001; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Sun Microsystems Java gif handling memory corruption attempt"; flow:to_client,established; flowbits:isset,file.gif; file_data; content:"|F9 04 01 00 00 10 00|,|00 00 00 00 00 00 90 01|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,22085; reference:cve,2007-0243; classtype:attempted-user; sid:16000; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE ACD Systems ACDSee XPM file format overflow attempt"; flow:to_client,established; flowbits:isset,file.xpm; file_data; content:"/* XPM */"; pcre:"/^\s*\x22[^\x22\n]{300}/mi"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,23620; reference:cve,2007-2193; classtype:attempted-user; sid:15236; rev:14;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft GDI WMF file parsing integer overflow attempt"; flow:to_client,established; flowbits:isset,file.wmf; file_data; content:"|01 00 09 00|"; pcre:"/(\x40\x09.{19}|\x41\x0b.{23})[\xf0-\xff].{8}\x01\x00[\x00\x01\x02\x04\x08\x10\x18\x20]\x00/smi"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2008-2249; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-071; classtype:attempted-admin; sid:15105; rev:19;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE BMP image handler buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.bmp; content:"image/bmp"; fast_pattern:only; http_header; file_data; content:"BM"; content:"|00 00 00 00|"; within:4; distance:4; byte_test:4, >, 256, 36, relative, little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,28874; reference:cve,2008-1765; reference:cve,2008-3020; classtype:attempted-user; sid:13865; rev:18;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows metafile SetPaletteEntries heap overflow attempt"; flow:to_client,established; flowbits:isset,file.wmf; file_data; content:"|00 09 00|"; content:"|FF FF FF|"; distance:12; content:"|00|"; within:1; distance:2; pcre:"/[\x00\x01]\x00\x09\x00.*?\xff\xff\xff[\xff\xf7][\x36\x37]\x00/smi"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,15356; reference:cve,2005-2124; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-053; classtype:attempted-user; sid:13807; rev:16;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Apple QuickTime uncompressed PICT stack overflow attempt"; flow:to_client,established; flowbits:isset,file.pct; file_data; content:"|00 00 00 00 00 00 00 00 00 00|"; content:"|00 11 02 FF|"; distance:0; fast_pattern; content:"|82 01|"; distance:0; byte_test:4,<,50,0,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,26344; reference:cve,2007-4672; classtype:attempted-user; sid:12757; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows 2000 Kodak Imaging large offset malformed tiff 2"; flow:to_client,established; flowbits:isset,file.tiff; file_data; content:"MM|00|*"; byte_jump:4,0,relative,big; content:"|01 02 00 03|"; distance:-8; byte_test:4,>,6,0,relative,big; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2007-2217; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-055; classtype:attempted-user; sid:12634; rev:17;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Photoshop PNG file handling stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.png; file_data; content:"|89|PNG|0D 0A 1A 0A|"; content:"PLTE"; byte_test:4,>,768,-8,relative,big; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,23698; reference:cve,2007-2365; classtype:attempted-user; sid:11267; rev:15;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Apple QuickTime JPEG Huffman Table integer underflow attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|FF C4 02 11 00 FF FF 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,12905; reference:cve,2005-0903; classtype:attempted-user; sid:10126; rev:19;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows WMF denial of service attempt"; flow:to_client,established; flowbits:isset,file.wmf; file_data; content:"|FC 02|"; pcre:"/\xFC\x02[\x08\x06]\x00.{4}(?!\x00\x00)/s"; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,21992; reference:cve,2006-4071; classtype:web-application-attack; sid:10115; rev:14;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Oracle Java Virtual Machine malformed GIF buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.gif; file_data; content:"GIF"; byte_test:1,!&,128,7,relative; content:","; within:1; distance:10; content:"|00 00|"; within:2; distance:4; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,22085; reference:cve,2007-0243; classtype:attempted-user; sid:10062; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected zTXt overflow attempt"; flow:to_client,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"zTXt"; distance:0; byte_test:4,>,10000,-8,relative; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:6701; rev:18;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Multiple Products malformed PNG detected tEXt overflow attempt"; flow:to_client,established; file_data; content:"|89|PNG|0D 0A 1A 0A|"; fast_pattern; content:"tEXt"; distance:0; byte_test:4,>,10000,-8,relative; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,18385; reference:cve,2006-0025; reference:cve,2009-2501; reference:cve,2012-5470; reference:cve,2013-1331; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; reference:url,technet.microsoft.com/en-us/security/bulletin/ms09-062; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-051; classtype:attempted-user; sid:6700; rev:19;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected iTXt overflow attempt"; flow:to_client,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"iTXt"; distance:0; byte_test:4,>,10000,-8,relative; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:6699; rev:18;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected tIME overflow attempt"; flow:to_client,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"tIME"; distance:0; byte_test:4,>,10000,-8,relative; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:6698; rev:18;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected sPLT overflow attempt"; flow:to_client,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"sPLT"; distance:0; byte_test:4,>,10000,-8,relative; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:6697; rev:18;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected pHYs overflow attempt"; flow:to_client,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"pHYs"; distance:0; byte_test:4,>,10000,-8,relative; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:6696; rev:18;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected tRNS overflow attempt"; flow:to_client,established; flowbits:isset,file.png; file_data; content:"IHDR"; content:"tRNS"; distance:0; fast_pattern; byte_test:4,>,7000,-8,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,13941; reference:bugtraq,18385; reference:cve,2005-1211; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:6695; rev:24;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected hIST overflow attempt"; flow:to_client,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"hIST"; distance:0; byte_test:4,>,10000,-8,relative; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:6694; rev:18;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected bKGD overflow attempt"; flow:to_client,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"bKGD"; distance:0; byte_test:4,>,10000,-8,relative; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:6693; rev:18;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected sRGB overflow attempt"; flow:to_client,established; flowbits:isset,file.png; file_data; content:"IHDR"; content:"sRGB"; distance:0; fast_pattern; content:!"iCCP"; within:4; distance:-8; byte_test:4,>,10000,-8,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:6692; rev:24;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected sBIT overflow attempt"; flow:to_client,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"sBIT"; distance:0; byte_test:4,>,10000,-8,relative; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:6691; rev:18;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected iCCP overflow attempt"; flow:to_client,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"iCCP"; distance:0; byte_test:4,>,10000,-8,relative; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:6690; rev:18;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected cHRM overflow attempt"; flow:to_client,established; flowbits:isset,file.png; file_data; content:"IHDR"; content:"cHRM"; distance:0; fast_pattern; byte_test:4,>,7000,-8,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:6689; rev:23;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Apple QuickTime fpx file SectNumMiniFAT overflow attempt"; flow:to_client,established; flowbits:isset,file.fpx; file_data; content:"|D0 CF 11 E0 A1 B1 1A E1|"; depth:8; byte_test:4,>,8388606,56,little,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,17074; reference:cve,2006-1249; classtype:attempted-user; sid:6505; rev:14;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Mozilla GIF single packet heap overflow - ANIMEXTS1.0"; flow:to_client,established; flowbits:isset,file.gif; file_data; content:"GIF"; content:"!|FF 0B|ANIMEXTS1.0"; distance:0; nocase; content:"|02|"; within:1; distance:1; byte_test:4,>,0x7f,3,relative; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,12881; reference:cve,2005-0399; reference:nessus,17605; classtype:attempted-user; sid:6502; rev:14;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows Media Player invalid data offset bitmap heap overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.bmp; content:"BM"; depth:2; byte_test:4,<,14,8,little,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,16633; reference:cve,2006-0006; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-005; reference:url,www.eeye.com/html/research/advisories/AD2006021.html; classtype:attempted-admin; sid:5712; rev:17;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows Media Player zero length bitmap heap overflow attempt"; flow:to_client,established; flowbits:isset,file.bmp; file_data; content:"BM|00 00 00 00|"; depth:6; pcre:"/^BM\x00\x00\x00\x00/sm"; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,16633; reference:cve,2006-0006; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-005; reference:url,www.eeye.com/html/research/advisories/AD20060214.html; classtype:attempted-admin; sid:5711; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows Bitmap width integer overflow attempt"; flow:to_client,established; flowbits:isset,file.bmp; file_data; content:"BM"; depth:2; byte_test:4,>,83386080,16,relative,little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,11171; reference:cve,2004-0904; reference:cve,2008-3015; reference:url,bugzilla.mozilla.org/show_bug.cgi?id=255067; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-052; classtype:attempted-admin; sid:3632; rev:23;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Mozilla GIF single packet heap overflow - NETSCAPE2.0"; flow:to_client,established; flowbits:isset,file.gif; file_data; content:"GIF"; content:"!|FF 0B|NETSCAPE2.0"; distance:0; nocase; content:"|02|"; within:1; distance:1; byte_test:4,>,0x7f,3,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,12881; reference:cve,2005-0399; reference:nessus,17605; classtype:attempted-user; sid:3534; rev:26;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft PNG large colour depth download attempt"; flow:to_client,established; flowbits:isset,file.png; file_data; content:"|89|PNG|0D 0A 1A 0A|"; content:"IHDR"; within:8; byte_test:1,>,16,8,relative; metadata:ruleset community, service ftp-data, service http, service imap, service pop3; reference:bugtraq,11523; reference:cve,2004-0990; reference:cve,2004-1244; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-009; classtype:attempted-user; sid:3134; rev:14;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Multiple Products PNG large image height download attempt"; flow:to_client,established; flowbits:isset,file.png; file_data; content:"|89|PNG|0D 0A 1A 0A|"; content:"IHDR"; within:8; byte_test:4,>,32767,4,relative; metadata:ruleset community, service ftp-data, service http, service imap, service pop3; reference:bugtraq,11481; reference:bugtraq,11523; reference:cve,2004-0599; reference:cve,2004-0990; reference:cve,2004-1244; reference:cve,2007-5503; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-009; classtype:attempted-user; sid:3133; rev:15;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft and libpng multiple products PNG large image width overflow attempt"; flow:to_client,established; flowbits:isset,file.png; file_data; content:"|89|PNG|0D 0A 1A 0A|"; content:"IHDR"; within:8; byte_test:4,>,32767,0,relative; metadata:ruleset community, service ftp-data, service http, service imap, service pop3; reference:bugtraq,11523; reference:cve,2004-0990; reference:cve,2004-1244; reference:cve,2007-5503; reference:url,sourceforge.net/p/png-mng/mailman/message/33173462/; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-009; classtype:attempted-user; sid:3132; rev:15;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE JPEG parser multipacket heap overflow attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|00 48 00 00 FF|"; fast_pattern:only; pcre:"/\x00\x48\x00\x00\xFF[\xE1\xE2\xED\xFE]\x00[\x00\x01]/"; metadata:ruleset community, service ftp-data, service http, service imap, service pop3; reference:bugtraq,11173; reference:cve,2004-0200; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-028; classtype:attempted-admin; sid:2707; rev:13;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Multiple Products JPEG parser heap overflow attempt"; flow:to_client,established; content:"Content-Type"; nocase; http_header; content:"image/"; nocase; http_header; pcre:"/^Content-Type\x3A\s*image\x2F/smiH"; file_data; content:"|FF D8|"; within:2; fast_pattern; pcre:"/^.{0,100}\xFF[\xE1\xE2\xED\xFE]\x00[\x00\x01]/sR"; metadata:ruleset community, service http; reference:bugtraq,11173; reference:cve,2004-0200; reference:url,www.microsoft.com/security/bulletins/200409_jpeg.mspx; classtype:attempted-user; sid:2705; rev:18;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE libpng tRNS overflow attempt"; flow:to_client,established; flowbits:isset,file.png; file_data; content:"|89|PNG|0D 0A 1A 0A|"; content:"IHDR"; within:4; distance:4; content:"tRNS"; distance:0; byte_test:4,>,256,-8,relative,big; pcre:"/IHDR(?!.*?PLTE).*?tRNS/s"; metadata:ruleset community, service ftp-data, service http, service imap, service pop3; reference:bugtraq,10872; reference:cve,2004-0597; classtype:attempted-user; sid:2673; rev:12;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Directshow GIF logical height overflow attempt"; flow:to_server,established; file_data; content:"GIF8"; depth:4; byte_extract:2,8,gif_height,little; content:!"|00 3B|"; within:1500; content:"|2C 00 00|"; within:3; distance:387; byte_test:2,>,gif_height,0,relative,little; content:!"|96 00|"; within:2; distance:6; metadata:policy security-ips drop, service smtp; reference:cve,2013-3174; classtype:attempted-user; sid:27530; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Directshow GIF logical height overflow attempt"; flow:to_server,established; file_data; content:"GIF8"; depth:4; byte_extract:2,8,gif_height,little; content:!"|00 3B|"; within:1500; content:"|2C 00 00|"; within:3; distance:387; byte_test:2,>,gif_height,4,relative,little; content:!"|96 00|"; within:2; distance:6; metadata:policy security-ips drop, service smtp; reference:cve,2013-3174; classtype:attempted-user; sid:27529; rev:7;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Directshow GIF logical width overflow attempt"; flow:to_server,established; file_data; content:"GIF8"; depth:4; byte_extract:2,6,gif_width,little; content:!"|00 3B|"; within:1500; content:"|2C 00 00|"; within:3; distance:389; byte_test:2,>,gif_width,2,relative,little; content:!"|96 00|"; within:2; distance:4; metadata:policy security-ips drop, service smtp; reference:cve,2013-3174; classtype:attempted-user; sid:27528; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Directshow GIF logical height overflow attempt"; flow:to_client,established; file_data; content:"GIF8"; depth:4; byte_extract:2,8,gif_height,little; content:!"|00 3B|"; within:1500; content:"|2C|"; distance:0; byte_test:2,>,gif_height,2,relative,little; content:"|08 FF 00|"; within:3; distance:9; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3174; classtype:attempted-user; sid:27527; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Directshow GIF logical height overflow attempt"; flow:to_client,established; file_data; content:"GIF8"; depth:4; byte_extract:2,8,gif_height,little; content:!"|00 3B|"; within:1500; content:"|2C|"; distance:0; byte_test:2,>,gif_height,6,relative,little; content:!"|96 00|"; within:2; distance:6; content:"|08 FF 00|"; within:3; distance:9; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3174; classtype:attempted-user; sid:27526; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Directshow GIF logical width overflow attempt"; flow:to_client,established; file_data; content:"GIF8"; depth:4; byte_extract:2,6,gif_width,little; content:!"|00 3B|"; within:1500; content:"|2C|"; distance:0; byte_test:2,>,gif_width,4,relative,little; content:!"|96 00|"; within:2; distance:4; content:"|08 FF 00|"; within:3; distance:9; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3174; classtype:attempted-user; sid:27525; rev:9;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE JPEG parser multipacket heap overflow attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|00 48 00 00 FF|"; fast_pattern:only; pcre:"/\x00\x48\x00\x00\xFF[\xE1\xE2\xED\xFE]\x00[\x00\x01]/"; metadata:service smtp; reference:bugtraq,11173; reference:cve,2004-0200; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-028; classtype:attempted-admin; sid:27569; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Apple QuickTime PICT file overread buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.pct; file_data; content:"|00 11 02 FF 0C 00 FF|"; byte_jump:2,-17,relative,post_offset -4,big; isdataat:1,relative; content:!"|00 FF|"; within:2; metadata:service smtp; reference:bugtraq,28583; reference:cve,2008-1019; classtype:attempted-user; sid:29434; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Camera Raw Plug-in TIFF image processing buffer underflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.big; file_data; content:"|80 38 9B CD 97 FB A5 C8 B8 00 0C 06 6E 00 00 10 0C 03 00 00 1F EF F8 8C 56 2D 17 8A BF DF D1 10|"; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-5679; reference:url,www.adobe.com/support/security/bulletins/apsb12-28.html; classtype:attempted-user; sid:29433; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Photoshop malformed PNG detected tRNS overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"IHDR"; content:"tRNS"; distance:0; fast_pattern; byte_test:4,>,3000,-8,relative; metadata:service smtp; reference:bugtraq,13941; reference:bugtraq,18385; reference:cve,2005-1211; reference:cve,2006-0025; reference:cve,2012-4170; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:29620; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Apple QuickTime Targa image file buffer overflow attempt"; flow:to_server,established; file_data; flowbits:isset,file.tga; content:"|00 00 02 00 00 00 00 00 00 00 00 00|"; depth:12; byte_test:2,>,0x2AAA,0,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,56438; reference:cve,2012-3755; reference:url,support.apple.com/kb/HT5581; classtype:attempted-user; sid:25378; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Apple QuickTime Targa image file buffer overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.tga; content:"|00 00 02 00 00 00 00 00 00 00 00 00|"; depth:12; byte_test:2,>,0x2AAA,0,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,56438; reference:cve,2012-3755; reference:url,support.apple.com/kb/HT5581; classtype:attempted-user; sid:25376; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE GIMP heap buffer overflow vulnerability attempt"; flow:to_server,established; flowbits:isset,file.psd; file_data; content:"8BPS|00 01 00 00 00 00 00 00|"; depth:12; byte_test:2,>,56,0,relative; metadata:service smtp; reference:cve,2012-3402; classtype:attempted-user; sid:30213; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE GIMP heap buffer overflow vulnerability attempt"; flow:to_client,established; flowbits:isset,file.psd; file_data; content:"8BPS|00 01 00 00 00 00 00 00|"; depth:12; byte_test:2,>,56,0,relative; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-3402; classtype:attempted-user; sid:30212; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE XnView PCT file processing buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.pct; file_data; content:"|36 32 36 36 32 3C 36 32 3C 32 15 32 33 34 44 43 42 41 AA AA AA AA 34 35 36 37 38 90 91 26 32 32|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-2577; reference:url,www.coresecurity.com/advisories/xnview-buffer-overflow-vulnerability; classtype:attempted-user; sid:31041; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE XnView PCT file processing buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.pct; file_data; content:"|7F 7F 7F 7F 97 01 8F EE 8C 8F 83 7F 7D 73 71 6D 6D 67 66 61 65 60 5E 59 57 56 01 55 E6 57 5C 56|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-2577; reference:url,www.coresecurity.com/advisories/xnview-buffer-overflow-vulnerability; classtype:attempted-user; sid:31040; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE XnView PCT file processing buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.pct; file_data; content:"|36 32 36 36 32 3C 36 32 3C 32 15 32 33 34 44 43 42 41 AA AA AA AA 34 35 36 37 38 90 91 26 32 32|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-2577; reference:url,www.coresecurity.com/advisories/xnview-buffer-overflow-vulnerability; classtype:attempted-user; sid:31039; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE XnView PCT file processing buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.pct; file_data; content:"|7F 7F 7F 7F 97 01 8F EE 8C 8F 83 7F 7D 73 71 6D 6D 67 66 61 65 60 5E 59 57 56 01 55 E6 57 5C 56|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-2577; reference:url,www.coresecurity.com/advisories/xnview-buffer-overflow-vulnerability; classtype:attempted-user; sid:31038; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE GIMP XWD RedMask file-handling stack buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.xwd; file_data; content:"|00 00 00 64 00 00 00 07|"; depth:8; isdataat:48,relative; content:!"|00 FF 00 00|"; within:4; distance:48; metadata:policy security-ips drop, service smtp; reference:bugtraq,56647; reference:cve,2012-5576; classtype:attempted-user; sid:31576; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE GIMP XWD GreenMask file-handling stack buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.xwd; file_data; content:"|00 00 00 64 00 00 00 07|"; depth:8; isdataat:52,relative; content:!"|00 00 FF 00|"; within:4; distance:52; metadata:policy security-ips drop, service smtp; reference:bugtraq,56647; reference:cve,2012-5576; classtype:attempted-user; sid:31575; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE GIMP XWD BlueMask file-handling stack buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.xwd; file_data; content:"|00 00 00 64 00 00 00 07|"; depth:8; isdataat:56,relative; content:!"|00 00 00 FF|"; within:4; distance:56; metadata:policy security-ips drop, service smtp; reference:bugtraq,56647; reference:cve,2012-5576; classtype:attempted-user; sid:31574; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE GIMP XWD RedMask file-handling stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.xwd; file_data; content:"|00 00 00 64 00 00 00 07|"; depth:8; isdataat:48,relative; content:!"|00 FF 00 00|"; within:4; distance:48; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,56647; reference:cve,2012-5576; classtype:attempted-user; sid:31573; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE GIMP XWD GreenMask file-handling stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.xwd; file_data; content:"|00 00 00 64 00 00 00 07|"; depth:8; isdataat:52,relative; content:!"|00 00 FF 00|"; within:4; distance:52; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,56647; reference:cve,2012-5576; classtype:attempted-user; sid:31572; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE GIMP XWD BlueMask file-handling stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.xwd; file_data; content:"|00 00 00 64 00 00 00 07|"; depth:8; isdataat:56,relative; content:!"|00 00 00 FF|"; within:4; distance:56; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,56647; reference:cve,2012-5576; classtype:attempted-user; sid:31571; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Multiple Products JPEG parser heap overflow attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|00 10|JFIF"; depth:6; offset:4; pcre:"/^.{0,100}\xFF[\xE1\xE2\xED\xFE]\x00[\x00\x01]/s"; metadata:ruleset community, service smtp; reference:bugtraq,11173; reference:cve,2004-0200; reference:url,www.microsoft.com/security/bulletins/200409_jpeg.mspx; classtype:attempted-user; sid:31719; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows GDI+ TIFF file parsing heap overflow attempt"; flow:to_client,established; file_data; content:"|6D 36 54 55 6C 6A 43 41 43 7A 56 2F 77 79 35 34|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2009-2502; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:32833; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows GDI+ TIFF file parsing heap overflow attempt"; flow:to_client,established; file_data; content:"|72 ED A6 A4 B6 87 E8 BE ED 5A 64 F4 51 DD 37 F3 31 40 00 B4 B7 3A 61 16 DD 75 A0 40 0F 03 82 16|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2009-2502; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:32832; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows GDI+ TIFF file parsing heap overflow attempt"; flow:to_client,established; file_data; content:"|CE 28 C5 56 76 58 A4 26 88 A0 A2 AA 57 D1 FA 7A 23 93 93 A7 A2 D6 0A 18 F9 D5 43 CD 9A 32 88 75|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2009-2502; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:32831; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows GDI+ TIFF file parsing heap overflow attempt"; flow:to_server,established; file_data; content:"|6D 36 54 55 6C 6A 43 41 43 7A 56 2F 77 79 35 34|"; fast_pattern:only; metadata:service smtp; reference:cve,2009-2502; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:32830; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows GDI+ TIFF file parsing heap overflow attempt"; flow:to_server,established; file_data; content:"|72 ED A6 A4 B6 87 E8 BE ED 5A 64 F4 51 DD 37 F3 31 40 00 B4 B7 3A 61 16 DD 75 A0 40 0F 03 82 16|"; fast_pattern:only; metadata:service smtp; reference:cve,2009-2502; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:32829; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows GDI+ TIFF file parsing heap overflow attempt"; flow:to_server,established; file_data; content:"|CE 28 C5 56 76 58 A4 26 88 A0 A2 AA 57 D1 FA 7A 23 93 93 A7 A2 D6 0A 18 F9 D5 43 CD 9A 32 88 75|"; fast_pattern:only; metadata:service smtp; reference:cve,2009-2502; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:32828; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft and libpng multiple products PNG large image width overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"|89|PNG|0D 0A 1A 0A|"; content:"IHDR"; within:8; byte_test:4,>,32767,0,relative; metadata:ruleset community, service smtp; reference:bugtraq,11523; reference:cve,2004-0990; reference:cve,2004-1244; reference:cve,2007-5503; reference:url,sourceforge.net/p/png-mng/mailman/message/33173462/; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-009; classtype:attempted-user; sid:32889; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows GDI+ TIFF file parsing heap overflow attempt"; flow:to_client,established; file_data; content:"|49 49 2A 00|"; depth:4; content:"|02 01 03 00 04 00 00 00|"; depth:100; content:"|06 01 04 00 01 00 00 00 05 00 00 00 0D 01 02 00|"; within:16; distance:4; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,36646; reference:cve,2009-2502; reference:url,osvdb.org/show/osvdb/58865; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:33518; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows GDI+ TIFF file parsing heap overflow attempt"; flow:to_server,established; file_data; content:"|49 49 2A 00|"; depth:4; content:"|02 01 03 00 04 00 00 00|"; depth:100; content:"|06 01 04 00 01 00 00 00 05 00 00 00 0D 01 02 00|"; within:16; distance:4; metadata:service smtp; reference:bugtraq,36646; reference:cve,2009-2502; reference:url,osvdb.org/show/osvdb/58865; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:33517; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows GDI+ TIFF file parsing heap overflow attempt"; flow:to_server,established; file_data; content:"|4D 4D 00 2A|"; depth:4; content:"|01 02 00 03 00 00 00 04 00 00 00|"; depth:100; content:"|01 06 00 04 00 00 00 01 00 00 00 05 01 0D 00 02 00 00 00|"; within:19; distance:1; metadata:service smtp; reference:bugtraq,36646; reference:cve,2009-2502; reference:url,osvdb.org/show/osvdb/58865; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:33516; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows GDI+ TIFF file parsing heap overflow attempt"; flow:to_client,established; file_data; content:"|4D 4D 00 2A|"; depth:4; content:"|01 02 00 03 00 00 00 04 00 00 00|"; depth:100; content:"|01 06 00 04 00 00 00 01 00 00 00 05 01 0D 00 02 00 00 00|"; within:19; distance:1; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,36646; reference:cve,2009-2502; reference:url,osvdb.org/show/osvdb/58865; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:33515; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Photoshop CS4 TIFF parsing heap overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.little; file_data; content:"|03 01 03 00 01 00 00 00 74 87|"; fast_pattern:only; metadata:service smtp; reference:cve,2012-2027; reference:url,www.adobe.com/support/security/bulletins/apsb12-11.html; classtype:attempted-user; sid:33591; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Photoshop CS4 TIFF parsing heap overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.big; file_data; content:"|01 03 00 03 00 00 00 01 87 74|"; fast_pattern:only; metadata:service smtp; reference:cve,2012-2027; reference:url,www.adobe.com/support/security/bulletins/apsb12-11.html; classtype:attempted-user; sid:33590; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Photoshop CS4 TIFF parsing heap overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.big; file_data; content:"|01 03 00 03 00 00 00 01 87 74|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-2027; reference:url,www.adobe.com/support/security/bulletins/apsb12-11.html; classtype:attempted-user; sid:33589; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Photoshop CS5 gif file heap corruption attempt"; flow:to_server,established; flowbits:isset,file.gif; file_data; content:"|08 0A 00 00 00 2C|"; content:"|00 66 00|"; within:3; distance:1; content:"|00|"; within:1; distance:1; content:"|00 07|"; within:2; distance:2; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,49106; reference:cve,2011-2131; reference:url,osvdb.org/show/osvdb/74422; classtype:attempted-user; sid:33615; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Internet Explorer PNG tRNS chuck size 1 information disclosure attempt"; flow:to_server,established; file_data; content:"|89|PNG|0D 0A 1A 0A|"; depth:8; content:"IHDR"; within:4; distance:4; content:"|00|"; within:1; distance:9; content:"|00 00 00 01|tRNS"; distance:0; fast_pattern; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0080; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-024; classtype:misc-attack; sid:33761; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Internet Explorer PNG tRNS chuck size 1 information disclosure attempt"; flow:to_client,established; file_data; content:"|89|PNG|0D 0A 1A 0A|"; depth:8; content:"IHDR"; within:4; distance:4; content:"|00|"; within:1; distance:9; content:"|00 00 00 01|tRNS"; within:500; fast_pattern; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0080; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-024; classtype:misc-attack; sid:33760; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft emf file download request"; flow:to_server,established; flowbits:isset,file.emf; file_data; content:" EMF"; depth:4; offset:40; metadata:ruleset community, service smtp; reference:bugtraq,10120; reference:bugtraq,28819; reference:bugtraq,9707; reference:cve,2003-0906; reference:cve,2007-5746; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-011; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-032; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-053; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-001; classtype:misc-activity; sid:33740; rev:1;)
