# Copyright 2001-2015 Sourcefire, Inc. All Rights Reserved.
#
# This file contains (i) proprietary rules that were created, tested and certified by
# Sourcefire, Inc. (the "VRT Certified Rules") that are distributed under the VRT
# Certified Rules License Agreement (v 2.0), and (ii) rules that were created by
# Sourcefire and other third parties (the "GPL Rules") that are distributed under the
# GNU General Public License (GPL), v2.
# 
# The VRT Certified Rules are owned by Sourcefire, Inc. The GPL Rules were created
# by Sourcefire and other third parties. The GPL Rules created by Sourcefire are
# owned by Sourcefire, Inc., and the GPL Rules not created by Sourcefire are owned by
# their respective creators. Please see http://www.snort.org/snort/snort-team/ for a
# list of third party owners and their respective copyrights.
# 
# In order to determine what rules are VRT Certified Rules or GPL Rules, please refer
# to the VRT Certified Rules License Agreement (v2.0).
#
#------------------
# BROWSER-IE RULES
#------------------

# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"BROWSER-IE Microsoft Internet Explorer image download spoofing attempt"; flow:to_server,established; content:".bat."; fast_pattern:only; http_uri; content:"MSIE "; http_header; pcre:"/^User-Agent:[^\n]*?MSIE\s[56]/Hmi"; metadata:service http; reference:bugtraq,11768; classtype:bad-unknown; sid:26937; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"BROWSER-IE Microsoft Internet Explorer image download spoofing attempt"; flow:to_server,established; content:".html."; fast_pattern:only; http_uri; content:"MSIE "; http_header; pcre:"/^User-Agent:[^\n]*?MSIE\s[56]/Hmi"; metadata:service http; reference:bugtraq,11768; classtype:bad-unknown; sid:26936; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"BROWSER-IE Microsoft Internet Explorer image download spoofing attempt"; flow:to_server,established; content:".exe."; fast_pattern:only; http_uri; content:"MSIE "; http_header; content:!".lz"; http_uri; pcre:"/^User-Agent:[^\n]*?MSIE\s[56]/Hmi"; metadata:service http; reference:bugtraq,11768; classtype:bad-unknown; sid:26935; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CDocument use after free attempt"; flow:to_client,established; file_data; content:"CollectGarbage()"; fast_pattern:only; content:".createElement"; nocase; content:"xml"; within:10; nocase; content:".setAttributeNode"; within:100; nocase; content:".XMLDocument"; within:100; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-3114; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-047; classtype:attempted-user; sid:26890; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode use after free memory corruption attempt"; flow:to_server,established; file_data; content:"jquery"; fast_pattern:only; content:"document.createElement"; nocase; content:".document.body.appendChild"; within:100; nocase; content:".replaceAll"; within:150; nocase; pcre:"/css\s*?\x28\s*?[\x22\x27]margin[^\x29]*?[\x22\x27]\s*?\x2c\s*?[\x22\x27]\d{12,}\s*?px/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3142; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047; classtype:attempted-user; sid:26889; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode use after free memory corruption attempt"; flow:to_client,established; file_data; content:"jquery"; fast_pattern:only; content:"document.createElement"; nocase; content:".document.body.appendChild("; within:100; nocase; content:".replaceAll("; within:150; nocase; pcre:"/css\s*?\x28\s*?[\x22\x27]margin[^\x29]*?[\x22\x27]\s*?\x2c\s*?[\x22\x27]\d{12,}\s*?px/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3142; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047; classtype:attempted-user; sid:26888; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer onscroll use after free attempt"; flow:to_server,established; file_data; content:"<body onload"; nocase; content:"onscroll="; within:50; fast_pattern; content:"location.reload("; pcre:"/<script\s*>((?!</script>).)*?function (?P<onload>\w+).*?\{[^}]*?location\.reload\(.*?<body[^>]*?onload\s*=\s*[\x22\x27](?P=onload)/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3123; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-047; classtype:attempted-user; sid:26887; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer onscroll use after free attempt"; flow:to_server,established; file_data; content:"<body onload"; nocase; content:"onscroll="; within:50; fast_pattern; content:"history.go(0)"; pcre:"/<script\s*>((?!</script>).)*?function (?P<onload>\w+).*?\{[^}]*?history\.go\(\s*0\s*\).*?<body[^>]*?onload\s*=\s*[\x22\x27](?P=onload)/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3123; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-047; classtype:attempted-user; sid:26886; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer onscroll use after free attempt"; flow:to_server,established; file_data; content:"<body onload"; nocase; content:"onscroll="; within:50; fast_pattern; content:"<meta"; content:"http-equiv=|22|refresh|22|"; within:20; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3123; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-047; classtype:attempted-user; sid:26885; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer onscroll use after free attempt"; flow:to_client,established; file_data; content:"<body onload"; nocase; content:"onscroll="; within:50; fast_pattern; content:"location.reload("; pcre:"/<script\s*>((?!</script>).)*?function (?P<onload>\w+).*?\{[^}]*?location\.reload\(.*?<body[^>]*?onload\s*=\s*[\x22\x27](?P=onload)/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3123; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-047; classtype:attempted-user; sid:26884; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer onscroll use after free attempt"; flow:to_client,established; file_data; content:"<body onload"; nocase; content:"onscroll="; within:50; fast_pattern; content:"history.go(0)"; pcre:"/<script\s*>((?!</script>).)*?function (?P<onload>\w+).*?\{[^}]*?history\.go\(\s*0\s*\).*?<body[^>]*?onload\s*=\s*[\x22\x27](?P=onload)/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3123; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-047; classtype:attempted-user; sid:26883; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer onscroll use after free attempt"; flow:to_client,established; file_data; content:"<body onload"; nocase; content:"onscroll="; within:50; fast_pattern; content:"<meta"; content:"http-equiv=|22|refresh|22|"; within:20; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3123; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-047; classtype:attempted-user; sid:26882; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 tree element use after free attempt"; flow:to_client,established; file_data; content:"document.getElementById"; nocase; content:"appendChild"; within:50; nocase; content:"ClientRects"; within:50; fast_pattern; nocase; content:"p id"; distance:0; content:"p id"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-3110; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-047; classtype:attempted-user; sid:26878; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 cached display node use-after-free attempt"; flow:to_client,established; file_data; content:"document.getElementsByTagName(|22|input|22|)[0].focus()"; content:"document.getElementsByTagName(|22|input|22|)[0].applyElement(a)"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3116; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047; classtype:attempted-user; sid:26876; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 CTreeNodeobject use-after-free attempt"; flow:to_client,established; file_data; content:"div1.removeEventListener( |27|DOMNodeRemoved|27|, callback, true )"; fast_pattern:only; content:"addEventListener"; content:"DOMNodeRemoved"; within:40; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3119; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047; classtype:attempted-user; sid:26875; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 9 CSS rules cache use-after-free attempt"; flow:to_server,established; file_data; content:"document.getElementsByTagName(|22|link|22|)[0].href"; fast_pattern:only; content:"document.createStyleSheet"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3117; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047; classtype:attempted-user; sid:26874; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 CSS rules cache use-after-free attempt"; flow:to_client,established; file_data; content:"document.getElementsByTagName(|22|link|22|)[0].href"; fast_pattern:only; content:"document.createStyleSheet"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3117; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047; classtype:attempted-user; sid:26873; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer double-free memory corruption attempt"; flow:to_server,established; file_data; content:"www.w3.org"; nocase; content:"document.getElementsByTagNameNS("; within:100; nocase; content:"removeAttributeNS("; within:100; nocase; content:"null"; within:20; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3118; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047; classtype:attempted-user; sid:26872; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer double-free memory corruption attempt"; flow:to_client,established; file_data; content:"www.w3.org"; nocase; content:"document.getElementsByTagNameNS("; within:100; nocase; content:"removeAttributeNS("; within:100; nocase; content:"null"; within:20; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3118; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047; classtype:attempted-user; sid:26871; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer double-free memory corruption attempt"; flow:to_server,established; file_data; content:"document.getElementsByTagNameNS("; nocase; content:"www.w3.org"; within:50; nocase; content:"removeAttributeNS("; nocase; content:"null"; within:20; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3118; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047; classtype:attempted-user; sid:26870; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer double-free memory corruption attempt"; flow:to_client,established; file_data; content:"document.getElementsByTagNameNS("; nocase; content:"www.w3.org"; within:50; nocase; content:"removeAttributeNS("; nocase; content:"null"; within:20; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3118; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047; classtype:attempted-user; sid:26869; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 8 select element deleted object access attempt"; flow:to_server,established; file_data; content:"document.body.appendChild(document.createElement('select'))"; fast_pattern:only; content:"document.getElementsByTagName('select')"; nocase; content:"parentNode.removeChild(document.getElementsByTagName('select')"; within:100; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3139; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047; classtype:attempted-user; sid:26868; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 select element deleted object access attempt"; flow:to_client,established; file_data; content:"document.body.appendChild(document.createElement('select'))"; fast_pattern:only; content:"document.getElementsByTagName('select')"; nocase; content:"parentNode.removeChild(document.getElementsByTagName('select')"; within:100; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3139; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047; classtype:attempted-user; sid:26867; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer create-add range on DOM objects memory corruption attempt"; flow:to_server,established; file_data; content:".addRange("; content:".addRange("; within:1024; content:".addRange("; within:1024; content:".addRange("; within:1024; content:".addRange("; within:1024; content:".createRange()"; content:".createRange()"; within:1024; content:".createRange()"; within:1024; content:".createRange()"; within:1024; content:".createRange()"; within:1024; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3124; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047; classtype:attempted-user; sid:26853; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer create-add range on DOM objects memory corruption attempt"; flow:to_client,established; file_data; content:".addRange("; content:".addRange("; within:1024; content:".addRange("; within:1024; content:".addRange("; within:1024; content:".addRange("; within:1024; content:".createRange()"; content:".createRange()"; within:1024; content:".createRange()"; within:1024; content:".createRange()"; within:1024; content:".createRange()"; within:1024; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3124; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047; classtype:attempted-user; sid:26852; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE IE5 compatibility mode use after free attempt"; flow:to_client,established; file_data; content:"meta http-equiv=|22|X-UA-Compatible|22| content=|22|IE=5|22|"; fast_pattern:only; content:".runtimeStyle.setExpression"; content:"document.body.innerHTML"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-3121; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-047; classtype:attempted-user; sid:26851; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer IE5 compatibility mode enable attempt"; flow:established,to_client; file_data; content:"meta http-equiv=|22|X-UA-Compatible|22| content=|22|IE=5|22|"; fast_pattern:only; metadata:policy security-ips drop, service http; reference:url,blogs.msdn.com/b/askie/archive/2009/03/23/understanding-compatibility-modes-in-internet-explorer-8.aspx; classtype:policy-violation; sid:26850; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer superscript use after free attempt"; flow:to_client,established; file_data; content:"document.execCommand"; content:"superscript"; within:20; content:".swapNode"; distance:0; pcre:"/document\.execCommand\s*\(\s*([\x22\x27])superscript\1\s*\)/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3111; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047; classtype:attempted-user; sid:26849; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 7 emulation via meta tag"; flow:to_client,established; file_data; content:"<meta "; content:"content=|22|IE=EmulateIE7|22|"; within:200; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; classtype:attempted-user; sid:26848; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 10 use after free attempt"; flow:to_client,established; file_data; content:"for (var i = 0|3B| i < param.childNodes.length|3B| i++)"; content:"document.selection.createRange().pasteHTML('<td>2<nobr>')"; fast_pattern:only; content:"document.selection.createRange().pasteHTML('<td>3')"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3125; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047; classtype:attempted-user; sid:26847; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 10 insertImage with designMode on deleted object access attempt"; flow:to_server,established; file_data; content:"window.open"; nocase; content:".eval"; distance:0; content:"document.designMode"; distance:0; nocase; content:"on"; distance:0; nocase; content:"window.getSelection"; distance:0; nocase; content:"document.designMode"; distance:0; nocase; content:"off"; distance:0; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3120; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047; classtype:attempted-user; sid:26846; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 10 insertImage with designMode on deleted object access attempt"; flow:to_client,established; file_data; content:"window.open"; nocase; content:".eval"; distance:0; content:"document.designMode"; distance:0; fast_pattern; nocase; content:"on"; distance:0; nocase; content:"window.getSelection"; distance:0; nocase; content:"document.designMode"; distance:0; nocase; content:"off"; distance:0; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3120; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047; classtype:attempted-user; sid:26845; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 layout engine memory corruption attempt"; flow:to_client,established; file_data; content:"}catch|28|"; content:"|29|{}try{"; within:10; content:"obj,obj,obj,obj,obj"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-3122; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-047; classtype:attempted-user; sid:26844; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 array element property use after free attempt"; flow:to_client,established; file_data; content:"new Array"; content:".push|28|"; distance:0; content:".appendChild|28|"; content:"onpropertychange"; content:"applyElement"; within:50; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-3112; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-047; classtype:attempted-user; sid:26843; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CDispNode float css element use after free attempt"; flow:to_server,established; file_data; content:"<input type=|22|text|22| style=|22|zoom:10|22|/>"; fast_pattern:only; content:"<body onload=|22|history.go(0)|22|>"; content:"<img style=|22|float:right|22|/>"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-1309; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037; classtype:attempted-user; sid:26754; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CDispNode float css element use after free attempt"; flow:to_client,established; file_data; content:"<input type=|22|text|22| style=|22|zoom:10|22|/>"; fast_pattern:only; content:"<body onload=|22|history.go(0)|22|>"; content:"<img style=|22|float:right|22|/>"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-1309; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037; classtype:attempted-user; sid:26753; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer null object access attempt"; flow:to_client,established; content:"offsetParent"; fast_pattern; content:"null"; within:10; nocase; content:"createElement"; content:"datalist"; within:20; content:"createElement"; content:"table"; within:20; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-1347; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-038; classtype:attempted-user; sid:26668; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer ANIMATECOLOR SMIL access attempt"; flow:to_client,established; file_data; content:"<?IMPORT namespace=|22|t|22| implementation=|22|#default#time2|22|>"; fast_pattern:only; content:"<t:ANIMATECOLOR id=|22|myanim|22|/>"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-1347; classtype:attempted-user; sid:26666; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer runtimeStyle memory corruption attempt"; flow:to_server,established; file_data; content:"document.createElement("; nocase; content:".runtimeStyle"; within:100; fast_pattern; nocase; content:".border"; within:100; nocase; pcre:"/var\s+?(?P<var>[^\s]+?)\s*?=\s*?document\.createElement\(.*?(?P=var)\.runtimeStyle.*?\.border[^=\x3b]*?=\s*?[^\x3b]*?[\x22\x27](\d+?\s|\s+?\d)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-1307; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037; classtype:attempted-user; sid:26642; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer runtimeStyle memory corruption attempt"; flow:to_client,established; file_data; content:"document.createElement("; nocase; content:".runtimeStyle"; within:100; fast_pattern; nocase; content:".border"; within:100; nocase; pcre:"/var\s+?(?P<var>[^\s]+?)\s*?=\s*?document\.createElement\(.*?(?P=var)\.runtimeStyle.*?\.border[^=\x3b]*?=\s*?[^\x3b]*?[\x22\x27](\d+?\s|\s+?\d)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-1307; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037; classtype:attempted-user; sid:26641; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer XML digital signature transformation of digest value"; flow:to_server, established; flowbits:isset,file.xml; file_data; content:"<CanonicalizationMethod"; fast_pattern; content:"<xsl"; distance:0; pcre:"/[^>]*\x26lt\x3bCanonicalizationMethod[^>]*\x26lt\x3bDigestValue\x26gt\x3b(?P<DV>[^\x26]+).*[^\x2f]DigestValue>(?!P=DV)/smR"; metadata:service smtp; reference:cve,2013-1336; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-040; classtype:misc-activity; sid:26640; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer XML digital signature transformation of digest value"; flow:to_client, established; flowbits:isset,file.xml; file_data; content:"<CanonicalizationMethod"; fast_pattern; content:"<xsl"; distance:0; pcre:"/[^>]*\x26lt\x3bCanonicalizationMethod[^>]*\x26lt\x3bDigestValue\x26gt\x3b(?P<DV>[^\x26]+).*[^\x2f]DigestValue>(?!P=DV)/smR"; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2013-1336; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-040; classtype:misc-activity; sid:26639; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer VML array with negative length memory corruption attempt"; flow:to_client,established; file_data; content:"#default#VML"; content:".dashstyle.array.length"; fast_pattern:only; pcre:"/\.dashstyle\.array\.length\s*?=[^\x3b]*?-\s*?\d/i"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,58570; reference:cve,2013-2551; reference:url,osvdb.org/show/osvdb/91197; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037; classtype:attempted-user; sid:26638; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer DCOMTextNode object use after free attempt"; flow:to_server,established; file_data; content:".focusNode"; content:"focusNode.dispatchEvent"; distance:0; content:"CollectGarbage"; distance:0; content:"previousSibling"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-1312; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037; classtype:attempted-user; sid:26637; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer DCOMTextNode object use after free attempt"; flow:to_client,established; file_data; content:".focusNode"; content:"focusNode.dispatchEvent"; distance:0; content:"CollectGarbage"; distance:0; content:"previousSibling"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-1312; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037; classtype:attempted-user; sid:26636; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 8 deleted object access via timer memory corruption attempt"; flow:to_server,established; file_data; content:"document.createElement|28|"; nocase; content:".innerHTML"; distance:0; nocase; content:"document.body.appendChild|28|"; distance:0; content:"document.styleSheets"; distance:0; nocase; content:"CollectGarbage()"; distance:0; nocase; content:"setTimeout|28|function"; distance:0; nocase; content:"onload=|27|setTimeout"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-1311; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037; classtype:attempted-user; sid:26635; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 deleted object access via timer memory corruption attempt"; flow:to_client,established; file_data; content:"document.createElement|28|"; depth:100; nocase; content:".innerHTML"; distance:0; nocase; content:"document.body.appendChild|28|"; distance:0; content:"document.styleSheets"; distance:0; nocase; content:"CollectGarbage()"; distance:0; nocase; content:"setTimeout|28|function"; distance:0; nocase; content:"onload=|27|setTimeout"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-1311; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037; classtype:attempted-user; sid:26634; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer html reload loop attempt"; flow:to_client,established; file_data; content:"onload"; content:"location.reload"; within:25; content:"|3C|iframe"; pcre:"/onload\s*\x3D\s*[\x22\x27]?location\.reload\s*\x28/smi"; metadata:policy security-ips drop, policy balanced-ips alert, service http; reference:bugtraq,59745; reference:cve,2013-1306; reference:url,osvdb.org/show/osvdb/93291; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-037; classtype:misc-activity; sid:26633; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CDispNode float css element use after free attempt"; flow:to_server,established; file_data; content:"<q class=|22|border float zoom|22| xml:space=|22|preserve|22|>"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-1309; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037; classtype:attempted-user; sid:26631; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CDispNode float css element use after free attempt"; flow:to_client,established; file_data; content:"<q class=|22|border float zoom|22| xml:space=|22|preserve|22|>"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-1309; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037; classtype:attempted-user; sid:26630; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer setInterval focus use after free attempt"; flow:to_client,established; file_data; content:"setInterval"; content:".focus()"; within:100; content:"history.go(0)"; fast_pattern:only; pcre:"/setInterval\s*\x28[^\x29]+\x2efocus\x28\x29/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-1308; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-037; classtype:attempted-admin; sid:26629; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 7-9 VBScript JSON reference information disclosure attempt"; flow:to_server,established; file_data; content:"language=vbs"; depth:200; content:"<script"; within:200; distance:-150; pcre:"/<script[^>]*src\s*=\s*[\x22\x27][^\x22\x27]*\.json[\x22\x27][^>]*language=vbs/i"; metadata:service smtp; reference:cve,2013-1297; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037; classtype:attempted-recon; sid:26625; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 7-9 VBScript JSON reference information disclosure attempt"; flow:to_client,established; file_data; content:"language=vbs"; depth:200; content:"<script"; within:200; distance:-150; pcre:"/<script[^>]*src\s*=\s*[\x22\x27][^\x22\x27]*\.json[\x22\x27][^>]*language=vbs/i"; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2013-1297; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037; classtype:attempted-recon; sid:26624; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Windows Live Writer wlw protocol handler information disclosure attempt"; flow:to_client,established; file_data; content:"wlw|3A|//"; fast_pattern; nocase; content:"/proxy"; within:100; nocase; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2013-0096; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-045; classtype:attempted-recon; sid:26623; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Windows Live Writer wlw protocol handler information disclosure attempt"; flow:to_client,established; file_data; content:"wlw|3A|//"; fast_pattern; nocase; content:"/perflog"; within:100; nocase; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2013-0096; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-045; classtype:attempted-recon; sid:26622; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer vector graphics reference counting use-after-free attempt"; flow:to_server,established; file_data; content:"|3C 3F|IMPORT namespace=|22|"; nocase; content:"implementation=|22|#default#VML|22 3E|"; within:50; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,52906; reference:cve,2012-0172; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-023; classtype:attempted-user; sid:26584; rev:6;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer null object access attempt"; flow:to_server,established; file_data; content:"Base64.decode"; base64_decode:bytes 10000,offset 2, relative; base64_data; content:"offsetParent"; fast_pattern; content:"null"; within:10; nocase; content:"createElement"; content:"datalist"; within:20; content:"createElement"; content:"table"; within:20; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-1347; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-038; classtype:attempted-user; sid:26572; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer null object access attempt"; flow:to_server,established; file_data; content:"offsetParent"; fast_pattern; content:"null"; within:10; nocase; content:"createElement"; content:"datalist"; within:20; content:"createElement"; content:"table"; within:20; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-1347; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-038; classtype:attempted-user; sid:26571; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer null object access attempt"; flow:to_client,established; file_data; content:"offsetParent"; fast_pattern; content:"null"; within:10; nocase; content:"createElement"; content:"datalist"; within:20; content:"createElement"; content:"table"; within:20; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-1347; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-038; classtype:attempted-user; sid:26569; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 9 onbeforeprint use after free attempt"; flow:to_server,established; content:"setTimeout('window.print()"; content:"onbeforeprint='document.write"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-0092; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021; classtype:attempted-user; sid:26420; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 onbeforeprint use after free attempt"; flow:to_client,established; file_data; content:"setTimeout('window.print()"; content:"onbeforeprint='document.write"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-0092; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021; classtype:attempted-user; sid:26419; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer expression clause in style tag cross site scripting attempt"; flow:to_client,established; file_data; content:"style"; content:"expression"; within:256; pcre:"/<\s*style[^>]*?(?=.{20,512}<\s*\/\s*style\s*>).{0,500}\{\s*\;\s*\w+\s*=\s*expression\s*\x28/ims"; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2013-1289; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-032; classtype:web-application-attack; sid:26354; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor object use after free attempt"; flow:to_client,established; file_data; content:"querycommandvalue("; nocase; content:"copy"; within:5; nocase; content:"onbeforecopy"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-0027; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009; classtype:attempted-user; sid:26225; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor object use after free attempt"; flow:to_client,established; file_data; content:"querycommandvalue("; nocase; content:"paste"; within:6; nocase; content:"onbeforepaste"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-0027; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009; classtype:attempted-user; sid:26224; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor object use after free attempt"; flow:to_client,established; file_data; content:"querycommandindeterm("; nocase; content:"cut"; within:4; nocase; content:"onbeforecut"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-0027; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009; classtype:attempted-user; sid:26223; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor object use after free attempt"; flow:to_client,established; file_data; content:"querycommandindeterm("; nocase; content:"copy"; within:5; nocase; content:"onbeforecopy"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-0027; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009; classtype:attempted-user; sid:26222; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor object use after free attempt"; flow:to_client,established; file_data; content:"querycommandindeterm("; nocase; content:"paste"; within:6; nocase; content:"onbeforepaste"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-0027; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009; classtype:attempted-user; sid:26221; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor object use after free attempt"; flow:to_client,established; file_data; content:"querycommandenabled("; nocase; content:"cut"; within:4; nocase; content:"onbeforecut"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-0027; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009; classtype:attempted-user; sid:26220; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor object use after free attempt"; flow:to_client,established; file_data; content:"querycommandenabled("; nocase; content:"copy"; within:5; nocase; content:"onbeforecopy"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-0027; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009; classtype:attempted-user; sid:26219; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor object use after free attempt"; flow:to_client,established; file_data; content:"querycommandenabled("; nocase; content:"paste"; within:6; nocase; content:"onbeforepaste"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-0027; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009; classtype:attempted-user; sid:26218; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor object use after free attempt"; flow:to_client,established; file_data; content:"querycommandstate("; nocase; content:"cut"; within:4; nocase; content:"onbeforecut"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-0027; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009; classtype:attempted-user; sid:26217; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor object use after free attempt"; flow:to_client,established; file_data; content:"querycommandstate("; nocase; content:"copy"; within:5; nocase; content:"onbeforecopy"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-0027; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009; classtype:attempted-user; sid:26216; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor use after free attempt"; flow:to_server,established; file_data; content:"onload="; content:"document.onfocusin"; fast_pattern:only; content:"document.open(|22 22|)"; content:"content=|27|IE=9|27|"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-0090; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021; classtype:attempted-user; sid:26169; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor use after free attempt"; flow:to_client,established; file_data; content:"onload="; content:"document.onfocusin"; fast_pattern:only; content:"document.open(|22 22|)"; content:"content=|27|IE=9|27|"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-0090; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021; classtype:attempted-user; sid:26168; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 9 onbeforeprint use after free attempt"; flow:to_server,established; file_data; content:"document.execCommand"; content:"print"; within:15; nocase; content:"onbeforeprint="; content:"document.write"; within:15; content:"document.write"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-0092; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021; classtype:attempted-user; sid:26162; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 9 onbeforeprint use after free attempt"; flow:to_server,established; content:"document.execCommand"; content:"print"; within:15; nocase; content:"onbeforeprint"; fast_pattern:only; content:"document.write"; pcre:"/<body.*?onbeforeprint\s*=\s*[\x22\x27]?(?P<func>\w*).*?<script.*?function\s*(?P=func)\s*\x28\x29.*?\x7b[^\x7d]*?document\x2ewrite/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-0092; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021; classtype:attempted-user; sid:26161; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 9 onbeforeprint use after free attempt"; flow:to_server,established; file_data; content:"document.execCommand"; content:"print"; within:15; nocase; content:"onbeforeprint"; fast_pattern:only; content:"document.write"; pcre:"/<script.*?function\s*(?P<func>\w*)\s*\x28\x29.*?\x7b[^\x7d]*?document\x2ewrite.*?<body.*?onbeforeprint\s*=\s*[\x22\x27]?(?P=func)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-0092; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021; classtype:attempted-user; sid:26160; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 onbeforeprint use after free attempt"; flow:to_client,established; file_data; content:"document.execCommand"; content:"print"; within:15; nocase; content:"onbeforeprint="; content:"document.write"; within:15; content:"document.write"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-0092; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021; classtype:attempted-user; sid:26159; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 onbeforeprint use after free attempt"; flow:to_client,established; file_data; content:"document.execCommand"; content:"print"; within:15; nocase; content:"onbeforeprint"; fast_pattern:only; content:"document.write"; pcre:"/<body.*?onbeforeprint\s*=\s*[\x22\x27]?(?P<func>\w*).*?<script.*?function\s*(?P=func)\s*\x28\x29.*?\x7b[^\x7d]*?document\x2ewrite/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-0092; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021; classtype:attempted-user; sid:26158; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 onbeforeprint use after free attempt"; flow:to_client,established; file_data; content:"document.execCommand"; content:"print"; within:15; nocase; content:"onbeforeprint"; fast_pattern:only; content:"document.write"; pcre:"/<script.*?function\s*(?P<func>\w*)\s*\x28\x29.*?\x7b[^\x7d]*?document\x2ewrite.*?<body.*?onbeforeprint\s*=\s*[\x22\x27]?(?P=func)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-0092; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021; classtype:attempted-user; sid:26157; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 9 onBeforeCopy use after free attempt"; flow:to_server,established; file_data; content:"<body onload=|27|document.execCommand(|22|SelectAll|22|)|3B 27| onbeforecopy="; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-0093; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021; classtype:attempted-user; sid:26138; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 onBeforeCopy use after free attempt"; flow:to_client,established; file_data; content:"<body onload=|27|document.execCommand(|22|SelectAll|22|)|3B 27| onbeforecopy="; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-0093; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021; classtype:attempted-user; sid:26137; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer saveHistory use after free attempt"; flow:to_server,established; file_data; content:".saveHistory {behavior|3A|url(#default#savehistory)|3B|}"; fast_pattern:only; content:"CLASS=saveHistory onsave="; nocase; content:"setTimeout"; content:"document.open()"; content:"document.createElement("; within:100; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-0089; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021; classtype:attempted-user; sid:26136; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer saveHistory use after free attempt"; flow:to_client,established; file_data; content:".saveHistory {behavior|3A|url(#default#savehistory)|3B|}"; fast_pattern:only; content:"CLASS=saveHistory onsave="; nocase; content:"setTimeout"; content:"document.open()"; content:"document.createElement("; within:100; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-0089; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021; classtype:attempted-user; sid:26135; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 deleted object access memory corruption attempt"; flow:to_client,established; file_data; content:"<title onreadystatechange ="; content:"style = '-ms-behavior: url("; within:50; distance:10; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-0091; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021; classtype:attempted-user; sid:26134; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer saveHistory use after free attempt"; flow:to_server,established; file_data; content:"behavior"; nocase; content:"url"; within:5; nocase; content:"#savehistory"; distance:0; fast_pattern; nocase; content:".outerHTML"; distance:0; nocase; pcre:"/<\s*meta[^>]*?(?>content\s*=\s*"history"[^>]*?name\s*=\s*"save"|name\s*=\s*"save"[^>]*?content\s*=\s*"history")\s*>.*?<\s*style[^>]*?>.*?\.(?P<class>\w+)\s*\{[^}]*?behavior\s*\:[^\;]*?url\s*\x28[^\x29]*?#savehistory[^\x29]*?\x29.*?(?P<element>\w+)\.outerHTML\s*=.*?id\s*=\s*[\x22\x27](?P=element)[\x22\x27].*?class=[\x22\x27]?(?P=class)[\x23\x27]?/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-0088; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021; classtype:attempted-dos; sid:26133; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer saveHistory use after free attempt"; flow:to_client,established; file_data; content:"behavior"; nocase; content:"url"; within:5; nocase; content:"#savehistory"; distance:0; fast_pattern; nocase; content:".outerHTML"; distance:0; nocase; pcre:"/<\s*meta[^>]*?(?>content\s*=\s*"history"[^>]*?name\s*=\s*"save"|name\s*=\s*"save"[^>]*?content\s*=\s*"history")\s*>.*?<\s*style[^>]*?>.*?\.(?P<class>\w+)\s*\{[^}]*?behavior\s*\:[^\;]*?url\s*\x28[^\x29]*?#savehistory[^\x29]*?\x29.*?(?P<element>\w+)\.outerHTML\s*=.*?id\s*=\s*[\x22\x27](?P=element)[\x22\x27].*?class=[\x22\x27]?(?P=class)[\x23\x27]?/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-0088; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021; classtype:attempted-dos; sid:26132; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer htc file use after free attempt"; flow:to_server,established; file_data; content:"PUBLIC:COMPONENT>"; content:"<PUBLIC:PROPERTY"; content:"PUT"; distance:0; content:"CollectGarbage()"; fast_pattern:only; pcre:"/<PUBLIC:PROPERTY[^>]*?PUT\s*=\s*[\x22\x27](?P<func>\w*).*?function\s*(?P=func).*?\x7b[^\x7c]*?CollectGarbage\x28\x29/sm"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-0094; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021; classtype:attempted-user; sid:26130; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer htc file use after free attempt"; flow:to_client,established; file_data; content:"PUBLIC:COMPONENT>"; content:"<PUBLIC:PROPERTY"; content:"PUT"; distance:0; content:"CollectGarbage()"; fast_pattern:only; pcre:"/<PUBLIC:PROPERTY[^>]*?PUT\s*=\s*[\x22\x27](?P<func>\w*).*?function\s*(?P=func).*?\x7b[^\x7c]*?CollectGarbage\x28\x29/sm"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-0094; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021; classtype:attempted-user; sid:26129; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 2D-position use after free attempt"; flow:to_client,established; file_data; content:"document.execCommand"; content:"2D-position"; within:100; fast_pattern; nocase; content:"contenteditable"; distance:0; nocase; content:"true"; within:10; nocase; content:"onresize"; distance:0; nocase; content:"document.write"; within:30; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-0087; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021; classtype:attempted-user; sid:26125; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer userdata behavior memory corruption attempt"; flow:to_server,established; file_data; content:"|3C|script|3E|"; nocase; content:"|2E|style|2E|behavior"; nocase; content:"|23|default|23|userData"; distance:0; nocase; content:"setAttribute|28|"; pcre:"/(?P<obj>[A-Z\d_]+)\x2Estyle\x2Ebehavior\s*\x3D\s*\x22url\x28\x27\x23default\x23userData\x27\x29\x22.*?(?P=obj)\x2EsetAttribute\x28[^,]+,\s*[A-Z]/smi"; content:"|3C 2F|script|3E|"; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,38615; reference:cve,2010-0806; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-018; classtype:attempted-user; sid:25986; rev:7;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer userdata behavior memory corruption attempt"; flow:to_server,established; file_data; content:"|6F 48 6F 6D 65 39 36 44 43 47 6F 48 6F 6D 65 38 33 38 33 47|"; fast_pattern:only; content:"|3C|script"; nocase; content:"addBehavior|28|"; nocase; content:"|23|default|23|userData"; within:30; nocase; content:"setAttribute|28|"; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,38615; reference:cve,2010-0806; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-018; classtype:attempted-user; sid:25985; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer userdata behavior memory corruption attempt"; flow:to_client,established; file_data; content:"|6F 48 6F 6D 65 39 36 44 43 47 6F 48 6F 6D 65 38 33 38 33 47|"; fast_pattern:only; content:"|3C|script"; nocase; content:"addBehavior|28|"; nocase; content:"|23|default|23|userData"; within:30; nocase; content:"setAttribute|28|"; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,38615; reference:cve,2010-0806; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-018; classtype:attempted-user; sid:25984; rev:9;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer bitmap BitmapOffset integer overflow attempt"; flow:to_server,established; flowbits:isset,file.bmp; file_data; content:"BM"; byte_test:4,>,2147480000,8,relative,little; metadata:service smtp; reference:bugtraq,9663; reference:cve,2004-0566; reference:url,technet.microsoft.com/en-us/security/bulletin/ms04-025; classtype:attempted-user; sid:25853; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer invalid Shift_JIS character xss attempt"; flow:to_server,established; file_data; content:"<input value="; fast_pattern:only; pcre:"/<input value=[\x22\x27][\x80-\xa0\xe0-\xff][\x22\x27]/i"; metadata:service smtp; reference:cve,2013-0015; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009; classtype:attempted-user; sid:25794; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer invalid Shift_JIS character xss attempt"; flow:to_client,established; file_data; content:"<input value="; fast_pattern:only; pcre:"/<input value=[\x22\x27][\x80-\xa0\xe0-\xff][\x22\x27]/i"; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2013-0015; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009; classtype:attempted-user; sid:25793; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer SVG object use after free attempt"; flow:to_client,established; file_data; content:"image x=|22|60|22| y=|22|50|22| width=|22|240|22| height=|22|240|22| xlink|3A|href=|22|2.svg"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-0023; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-009; classtype:attempted-admin; sid:25792; rev:3;)
alert tcp $HOME_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer compatibility mode invalid memory access attempt"; flow:to_server,established; file_data; content:"meta http-equiv=|22|X-UA-Compatible|22| content=|22|IE=7|22|"; nocase; content:"attachEvent|28|"; content:"onreadystatechange"; within:25; fast_pattern; content:".createElement(|22|div|22|)"; distance:0; nocase; content:".removeChild"; within:256; nocase; content:".createElement(|22|div|22|)"; within:256; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-0021; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009; classtype:attempted-user; sid:25791; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer compatibility mode invalid memory access attempt"; flow:to_client,established; file_data; content:"meta http-equiv=|22|X-UA-Compatible|22| content=|22|IE=7|22|"; nocase; content:"attachEvent|28|"; content:"onreadystatechange"; within:25; fast_pattern; content:".createElement(|22|div|22|)"; distance:0; nocase; content:".removeChild"; within:256; nocase; content:".createElement(|22|div|22|)"; within:256; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-0021; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009; classtype:attempted-user; sid:25790; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer iframe use after free attempt"; flow:to_server,established; file_data; content:"<iframe"; nocase; content:!"src="; within:40; content:"></iframe"; fast_pattern:only; content:"window.open"; nocase; content:"name"; nocase; pcre:"/<iframe[^>]+name\s*=\s*[\x22\x27](?P<iframe_name>\w+)[\x22\x27].*?><\x2fiframe\s*>.*?window\x2eopen\x28.{1,30}(?P=iframe_name).*?window\x2eopen\x28.{1,60}(?P=iframe_name)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-0019; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-009; classtype:attempted-user; sid:25789; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer iframe use after free attempt"; flow:to_client,established; file_data; content:"<iframe"; nocase; content:!"src="; within:40; content:"window.open"; nocase; content:"></iframe"; fast_pattern:only; content:"name"; nocase; pcre:"/<iframe(\s*(name|height|width)\s*=\s*[\x22\x27]?(?P<iframe_name>\w+)[\x22\x27]?)*><\x2fiframe\s*>.*?window\x2eopen\x28.{1,30}(?P=iframe_name).*?window\x2eopen\x28.{1,60}(?P=iframe_name)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-0019; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-009; classtype:attempted-user; sid:25788; rev:6;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 9 deleted object access memory corruption attempt"; flow:to_server,established; file_data; content:"<script>"; nocase; content:"SelectAll"; within:60; nocase; content:"execCommand|28 22|Justify"; within:40; nocase; content:"execCommand|28 22|Justify"; within:60; nocase; content:"SelectAll"; within:45; nocase; content:"</script>"; within:16; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,57832; reference:cve,2013-0026; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-009; classtype:attempted-user; sid:25787; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 deleted object access memory corruption attempt"; flow:to_client,established; file_data; content:"<script>"; nocase; content:"SelectAll"; within:60; nocase; content:"execCommand|28 22|Justify"; within:40; nocase; content:"execCommand|28 22|Justify"; within:60; nocase; content:"SelectAll"; within:45; nocase; content:"</script>"; within:16; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,57832; reference:cve,2013-0026; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009; classtype:attempted-user; sid:25786; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer text layout calculation use after free attempt"; flow:to_server,established; file_data; content:"<figure"; nocase; content:"dir"; within:50; nocase; content:"rtl"; within:50; nocase; content:"&"; within:50; pcre:"/<figure[^>]+?dir\s*?=\s*?[\x22\x27]\s*?rtl\s*?[\x22\x27].*?(&#?x?[a-z\d]{2,4}\x3b){100}/si"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-0022; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009; classtype:attempted-user; sid:25785; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer text layout calculation use after free attempt"; flow:to_client,established; file_data; content:"<figure"; nocase; content:"dir"; within:50; nocase; content:"rtl"; within:50; nocase; content:"&"; within:50; pcre:"/<figure[^>]+?dir\s*?=\s*?[\x22\x27]\s*?rtl\s*?[\x22\x27].*?(&#?x?[a-z\d]{2,4}\x3b){100}/si"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-0022; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009; classtype:attempted-user; sid:25784; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer SVG use after free attempt"; flow:to_client,established; file_data; content:".setCapture("; fast_pattern:only; content:"<svg"; nocase; content:" id="; distance:0; nocase; content:".getElementById("; distance:0; nocase; content:".setCapture("; distance:0; nocase; pcre:"/<svg[^>]*?>.*?<[^>]*?\sid=(?P<q1>(\x22|\x27|))(?P<id1>[^\x22\x27\s>]+?)(?P=q1).*?<[^>]*?\s+id=(?P<q2>(\x22|\x27|))(?P<id2>[^\x22\x27\s>]+?)(?P=q2).*?<\x2fsvg>.*?<script[^>]*?>.*?(document\.getElementById\([^)]*?((?P=id1)|(?P=id2))[^)]*?\).*?\.setCapture\(.*?\).*?){2}/smiO"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-0018; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-009; classtype:attempted-user; sid:25778; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos use after free memory corruption attempt"; flow:to_client,established; file_data; content:"document.selection.createRange("; content:"getElementsByTagName("; within:50; content:"moveToElementText("; within:50; content:"collapse("; within:50; content:"select("; within:50; content:"pasteHTML("; within:50; pcre:"/var\s+?(?P<range>[^\s]+?)\s*?=\s*?document\.selection\.createRange\([^\(]*?\).*?var\s+?(?P<elements>[^\s]+?)\s*?=\s*?document\.body\.getElementsByTagName\(\s*?[\x22\x27]\s*?\*\s*?[\x22\x27]\s*?\).*?var\s+?(?P<el>[^\s]+?)\s*?=\s*?(?P=elements)\s*?\[\s*?\d\s*?\].*?(?P=range)\.moveToElementText\(\s*?(?P=el)\s*?\).*?(?P=range)\.collapse\(\s*?true\s*?\).*?(?P=range)\.select\(.*?(?P=range)\.pasteHTML\(/si"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-0024; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009; classtype:attempted-user; sid:25777; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos use after free memory corruption attempt"; flow:to_client,established; file_data; content:"getElementsByTagName("; content:"document.selection.createRange("; within:100; content:"moveToElementText("; within:50; content:"collapse("; within:50; content:"select("; within:50; content:"pasteHTML("; within:50; pcre:"/var\s+?(?P<elements>[^\s]+?)\s*?=\s*?document\.body\.getElementsByTagName\(\s*?[\x22\x27]\s*?\*\s*?[\x22\x27]\s*?\).*?var\s+?(?P<el>[^\s]+?)\s*?=\s*?(?P=elements)\s*?\[\s*?\d\s*?\].*?var\s+?(?P<range>[^\s]+?)\s*?=\s*?document\.selection\.createRange\([^\(]*?\).*?(?P=range)\.moveToElementText\(\s*?(?P=el)\s*?\).*?(?P=range)\.collapse\(\s*?true\s*?\).*?(?P=range)\.select\(.*?(?P=range)\.pasteHTML\(/si"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-0024; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009; classtype:attempted-user; sid:25776; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer pre-line use after free attempt"; flow:to_client,established; file_data; content:".style.whiteSpace = |22|pre-line|22|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-0025; reference:cve,2013-1288; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-021; classtype:attempted-user; sid:25775; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer VML shape object malformed path attempt"; flow:to_client,established; file_data; content:"document.createElement("; nocase; content:"shape"; nocase; content:"setAttribute("; distance:0; fast_pattern; nocase; content:"path"; within:5; distance:1; nocase; isdataat:506,relative; content:!")"; within:506; pcre:"/var\s*?(?P<m1>\w+)s*?=s*?document.createElement\s*?\([\x22\x27][\w]s*?[\x3a\x3b]\s*?shape[\x22\x27]\).*?(?P=m1)s*?.\s*?setAttribute\s*?\(\s*?[\x22\x27]\s*?path\s*?[\x22\x27]\s*?,\s*?[\x22\x27][^\x29]{506}.*?(?P=m1)\.s*?path/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-0030; classtype:attempted-user; sid:25773; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer onbeforeeditfocus element attribute use after free attempt"; flow:to_client,established; file_data; content:"onbeforeeditfocus"; nocase; content:"document.write"; within:30; pcre:"/onbeforeeditfocus\s*?=\s*?[\x22\x27]document\x2ewrite/ism"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-0029; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-009; classtype:attempted-user; sid:25772; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer custom cursor file use after free attempt"; flow:to_client,established; file_data; content:"location.reload()"; nocase; content:"style"; distance:0; nocase; content:"cursor"; within:256; nocase; content:"|3A|"; within:5; content:"URL"; within:5; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-0028; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-009; classtype:attempted-user; sid:25771; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted object access memory corruption attempt"; flow:to_client,established; file_data; content:"DOMParser"; fast_pattern:only; content:"createCDATASection"; nocase; content:"|2E|cloneNode"; nocase; content:"adoptNode"; distance:0; nocase; content:"CollectGarbage()"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-0020; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-009; classtype:attempted-user; sid:25770; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor object use after free attempt"; flow:to_client,established; file_data; content:"querycommandstate("; nocase; content:"paste"; within:6; nocase; content:"onbeforepaste"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-0027; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009; classtype:attempted-user; sid:25769; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer malformed iframe buffer overflow attempt"; flow:to_server,established; file_data; content:"<IFRAME"; nocase; content:"SRC="; within:20; distance:1; nocase; isdataat:248,relative; content:"NAME="; within:700; nocase; isdataat:2084,relative; metadata:service smtp; reference:bugtraq,11515; reference:cve,2004-1050; classtype:attempted-user; sid:25650; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSS style memory corruption attempt"; flow:to_client,established; file_data; content:"table"; content:!"."; within:1; content:!"selec"; within:5; distance:-10; content:"clip"; within:120; nocase; content:"position"; within:120; nocase; content:"absolute"; within:80; nocase; metadata:policy max-detect-ips drop, service http; reference:cve,2010-3962; reference:url,technet.microsoft.com/en-us/security/advisory/2458511; classtype:attempted-user; sid:25329; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer nonexistent attribute removal memory corruption attempt"; flow:to_client,established; file_data; content:"|22 70 22 29 5B 30 5D 2E 72 65 6D 6F 76 65 41 74 74 72 69 62 75 74 65 28 27 78 6D 6C 6E 73 3A 6F|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-1524; reference:url,osvdb.org/show/osvdb/83652; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-044; classtype:attempted-dos; sid:25320; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer html table column span width increase memory corruption attempt"; flow:to_client,established; file_data; content:"table-layout|3A|"; nocase; content:"fixed"; within:7; nocase; content:"<col id="; within:20; content:"width="; within:20; nocase; content:"span="; within:30; distance:-10; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-1876; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-037; classtype:attempted-user; sid:25246; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer deleted button use after free attempt"; flow:to_server,established; file_data; content:"window.location"; content:"unescape"; within:30; content:"http"; within:30; pcre:"/window\x2elocation\s*=\s*unescape\s*\x28\s*["']\x25[^"']*https?\x3a/"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-4792; reference:url,technet.microsoft.com/en-us/security/advisory/2794220; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-008; classtype:attempted-user; sid:25235; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted button use after free attempt"; flow:to_client,established; file_data; content:"window.location"; content:"unescape"; within:30; content:"http"; within:30; pcre:"/window\x2elocation\s*=\s*unescape\s*\x28\s*["']\x25[^"']*https?\x3a/"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-4792; reference:url,technet.microsoft.com/en-us/security/advisory/2794220; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-008; classtype:attempted-user; sid:25234; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Marquee stylesheet object removal"; flow:to_client,established; file_data; content:"marquee"; fast_pattern:only; pcre:"/getElementById\s*\x28\s*[\x22\x27](?P<id>[^\x22\x27]*?)[\x22\x27]\s*\x29\.remove.*?<\s*marquee[^>]*?id\s*=\s*[\x22\x27](?P=id)[\x22\x27]/ims"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,49966; reference:cve,2011-2001; reference:url,osvdb.org/show/osvdb/76213; reference:url,technet.microsoft.com/en-us/security/bulletin/ms11-081; classtype:attempted-user; sid:25226; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Marquee stylesheet object removal"; flow:to_client,established; file_data; content:"marquee"; fast_pattern:only; pcre:"/<\s*marquee\s*([^>]*?height\s*=\s*[\x22\x27]?0[^\d]|>\s*<\s*\/\s*marquee\s*>|[^>]*?id\s*=\s*[\x22\x27](?P<id>[^\x22\x27]*?)[\x22\x27].*?getElementById\s*\x28\s*[\x22\x27](?P=id)[\x22\x27]\s*\x29\.remove)/ims"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,49966; reference:cve,2011-2001; reference:url,osvdb.org/show/osvdb/76213; reference:url,technet.microsoft.com/en-us/security/bulletin/ms11-081; classtype:attempted-user; sid:25225; rev:8;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer deleted button use after free attempt"; flow:to_server,established; file_data; content:"appendChild|28|"; content:"document.createElement|28|"; within:50; content:"button"; within:20; content:"outerText"; within:200; pcre:"/appendChild\x28\s*document\x2ecreateElement\x28\s*[\x22\x27]button[\x22\x27].*?outerText\s*=\s*[\x22\x27]{2}/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-4792; reference:url,technet.microsoft.com/en-us/security/advisory/2794220; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-008; classtype:attempted-user; sid:25134; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer deleted button use after free attempt"; flow:to_server,established; file_data; content:"|EB D7 77 82 93 D0 7C F6 8B 08 73 08 FD 8B 6B FD|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-4792; reference:url,technet.microsoft.com/en-us/security/advisory/2794220; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-008; classtype:attempted-user; sid:25133; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer deleted button use after free attempt"; flow:to_server,established; file_data; content:"D27CDB6E-AE6D-11cf-96B8-444553540000"; content:"<param name=|5C 22|movie|5C 22| value=|5C 22|today.swf|5C 22| />"; fast_pattern:only; content:"<iframe src=news.html></iframe>"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-4792; reference:url,technet.microsoft.com/en-us/security/advisory/2794220; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-008; classtype:attempted-user; sid:25132; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer deleted button use after free attempt"; flow:to_server,established; file_data; content:"jj76jj61jj72jj20jj65jj30jj20jj3D"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-4792; reference:url,technet.microsoft.com/en-us/security/advisory/2794220; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-008; classtype:attempted-user; sid:25131; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer deleted button use after free attempt"; flow:to_server,established; file_data; content:".replace|28|/jj/g,|22|%|22 29 3B|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-4792; reference:url,technet.microsoft.com/en-us/security/advisory/2794220; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-008; classtype:attempted-user; sid:25130; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted button use after free attempt"; flow:to_client,established; file_data; content:"appendChild|28|"; content:"document.createElement|28|"; within:50; content:"button"; within:20; content:"outerText"; within:200; pcre:"/appendChild\x28\s*document\x2ecreateElement\x28\s*[\x22\x27]button[\x22\x27].*?outerText\s*=\s*[\x22\x27]{2}/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-4792; reference:url,technet.microsoft.com/en-us/security/advisory/2794220; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-008; classtype:attempted-user; sid:25129; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted button use after free attempt"; flow:to_client,established; file_data; content:"|EB D7 77 82 93 D0 7C F6 8B 08 73 08 FD 8B 6B FD|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-4792; reference:url,technet.microsoft.com/en-us/security/advisory/2794220; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-008; classtype:attempted-user; sid:25128; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted button use after free attempt"; flow:to_client,established; file_data; content:"D27CDB6E-AE6D-11cf-96B8-444553540000"; content:"<param name=|5C 22|movie|5C 22| value=|5C 22|today.swf|5C 22| />"; fast_pattern:only; content:"<iframe src=news.html></iframe>"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-4792; reference:url,technet.microsoft.com/en-us/security/advisory/2794220; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-008; classtype:attempted-user; sid:25127; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted button use after free attempt"; flow:to_client,established; file_data; content:"jj76jj61jj72jj20jj65jj30jj20jj3D"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-4792; reference:url,technet.microsoft.com/en-us/security/advisory/2794220; classtype:attempted-user; sid:25126; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted button use after free attempt"; flow:to_client,established; file_data; content:".replace|28|/jj/g,|22|%|22 29 3B|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-4792; reference:url,technet.microsoft.com/en-us/security/advisory/2794220; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-008; classtype:attempted-user; sid:25125; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer sign extension vulnerability exploitation attempt"; flow:to_server,established; file_data; content:"while|28| str2.length < 0x10000000|29|"; fast_pattern:only; content:"if |28|str1.length < 0x40000000|29|"; nocase; content:"setTimeout|28|poc, 10|29|"; distance:0; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-2523; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-052; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-056; classtype:attempted-user; sid:25079; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer sign extension vulnerability exploitation attempt"; flow:to_client,established; file_data; content:"while|28| str2.length < 0x10000000|29|"; fast_pattern:only; content:"if |28|str1.length < 0x40000000|29|"; nocase; content:"setTimeout|28|poc, 10|29|"; distance:0; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-2523; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-052; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-056; classtype:attempted-user; sid:25078; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer invalid object property use after free memory corruption attempt"; flow:to_client,established; file_data; content:"document.getElement"; content:".style."; within:100; content:"document.createElement"; within:45; content:"CollectGarbage"; within:75; fast_pattern; content:"HTML"; within:55; pcre:"/(body\s*?onload\s*?\x3d\s*?[\x22\x22](?P<func>\w+).*?function\s*?(?P=func)\s*?\x28[^\x7b]+?\x7b[^\x7d]+?var\s*?(?P<var>\w+)\s*?\x3d\s*?document\.getElement[^\x7d]+?\.style\.\w+\s*?\x3d\s*?document\.createElement[^\x7d]+?CollectGarbage[^\x7d]+?(?P=var)\.(inner|outer)HTML)|(function\s*?(?P<func2>\w+)\s*?\x28[^\x7b]+?\x7b[^\x7d]+?var\s*?(?P<var2>\w+)\s*?\x3d\s*?document\.getElement[^\x7d]+?\.style\.\w+\s*?\x3d\s*?document\.createElement[^\x7d]+?CollectGarbage[^\x7d]+?(?P=var2)\.(inner|outer)HTML.*?body\s*?onload[^\x3e]+?)(?P=func2)/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-4787; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-077; classtype:attempted-dos; sid:24956; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer DOM mergeAttributes memory corruption attempt"; flow:to_server,established; file_data; content:"body.mergeAttributes|28|body|29|"; fast_pattern:only; content:"body.swapNode|28|body|29|"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,37893; reference:cve,2010-0247; reference:cve,2011-0094; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-002; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-018; classtype:misc-activity; sid:24872; rev:7;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer DOM mergeAttributes memory corruption attempt"; flow:to_server,established; file_data; content:"redhat.mergeAttributes|28|redhat|29|"; fast_pattern:only; content:"redhat.swapNode|28|redhat|29|"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,37893; reference:cve,2010-0247; reference:cve,2011-0094; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-002; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-018; classtype:misc-activity; sid:24871; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer DOM mergeAttributes memory corruption attempt"; flow:to_client,established; file_data; content:"body.mergeAttributes|28|body|29|"; fast_pattern:only; content:"body.swapNode|28|body|29|"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,37893; reference:cve,2010-0247; reference:cve,2011-0094; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-002; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-018; classtype:misc-activity; sid:24870; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer DOM mergeAttributes memory corruption attempt"; flow:to_client,established; file_data; content:"redhat.mergeAttributes|28|redhat|29|"; fast_pattern:only; content:"redhat.swapNode|28|redhat|29|"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,37893; reference:cve,2010-0247; reference:cve,2011-0094; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-002; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-018; classtype:misc-activity; sid:24869; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer button object use after free memory corruption attempt"; flow:to_server,established; file_data; content:"<fieldset"; fast_pattern:only; content:"<button"; content:".innerHTML"; pcre:"/<fieldset[^>]+?id\s*?\x3d\s*?(?P<quoteVar1>\x22|\x27|)(?P<fieldName>\w+)(?P=quoteVar1).*?button.*(?P=fieldName)\x2einnerHTML.*?button/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-1538; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-071; classtype:attempted-user; sid:24663; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer button object use after free memory corruption attempt"; flow:to_client,established; file_data; content:"<fieldset"; fast_pattern:only; content:"<button"; content:".innerHTML"; pcre:"/<fieldset[^>]+?id\s*?\x3d\s*?(?P<quoteVar1>\x22|\x27|)(?P<fieldName>\w+)(?P=quoteVar1).*?button.*(?P=fieldName)\x2einnerHTML.*?button/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-1538; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-071; classtype:attempted-user; sid:24662; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 style properties use after free attempt"; flow:to_client,established; file_data; content:"badstyle|3A 3A|first-line|7B|-ms-background-position-x|3A| 1ex|3B 7D|"; fast_pattern:only; content:"javascript:window.location.reload"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-1539; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-071; classtype:attempted-user; sid:24661; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 9 style properties use after free attempt"; flow:to_server,established; file_data; content:"badstyle|3A 3A|first-line|7B|-ms-background-position-x|3A| 1ex|3B 7D|"; fast_pattern:only; content:"javascript:window.location.reload"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-1539; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-071; classtype:attempted-user; sid:24660; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 9 table th element use after free attempt"; flow:to_server,established; file_data; content:"<th"; content:"document.getElementById"; content:".innerHTML = |22 22 3B|"; fast_pattern:only; pcre:"/(?P<elemName>\w*?)\x2einnerHTML\s*?=\s*?[\x22\x27][\x22\x27].*?<th[^>]id=[\x22\x27](?P=elemName).*?(<em>|<dfn>|<code>|<var>|<kbd>|<strong>|<samp>)/smi"; pcre:"/var\s*?(?P<varName>\w*?)\s*?=\s*?document\x2egetElementById\x28[\x22\x27](?P<tableName>\w*?).*?(?P=varName)\x2e(cellpadding|cellspacing|width|).*?<table[^>]id=[\x22\x27](?P=tableName)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-4775; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-071; classtype:attempted-user; sid:24654; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 table th element use after free attempt"; flow:to_client,established; file_data; content:"<th"; content:"document.getElementById"; content:".innerHTML = |22 22 3B|"; fast_pattern:only; pcre:"/(?P<elemName>\w*?)\x2einnerHTML\s*?=\s*?[\x22\x27][\x22\x27].*?<th[^>]id=[\x22\x27](?P=elemName).*?(<em>|<dfn>|<code>|<var>|<kbd>|<strong>|<samp>)/smi"; pcre:"/var\s*?(?P<varName>\w*?)\s*?=\s*?document\x2egetElementById\x28[\x22\x27](?P<tableName>\w*?).*?(?P=varName)\x2e(cellpadding|cellspacing|width|).*?<table[^>]id=[\x22\x27](?P=tableName)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-4775; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-071; classtype:attempted-user; sid:24653; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer JPEG rendering buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|FA FF DA 00 0C 03|"; content:!"R|00|G|00|B|00|"; within:6; pcre:!"/\xFA\xFF\xDA\x00\x0C\x03((\x00.\x01.\x02)|(\x01.\x02.\x03)|(\x01.\x04.\x05))/"; metadata:service smtp; reference:bugtraq,14282; reference:bugtraq,14284; reference:cve,2005-1988; reference:cve,2005-2308; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-038; classtype:attempted-user; sid:24452; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer execCommand use embedded within javascript tags"; flow:to_client,established; file_data; content:"<script>"; nocase; content:"execCommand("; distance:0; content:"</script>"; distance:0; nocase; content:"onselect="; distance:0; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2012-4969; classtype:attempted-user; sid:24252; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer execCommand use-after-free attempt"; flow:to_client,established; file_data; content:"body"; nocase; content:"onselect="; within:50; nocase; content:"selectAll"; fast_pattern:only; content:"document.write"; nocase; content:"execCommand"; nocase; pcre:"/execCommand\x28\s*?[\x22\x27]selectAll[\x22\x27]\s*?\x29/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2012-4969; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-063; classtype:attempted-user; sid:24212; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer execCommand use-after-free attempt"; flow:to_client,established; file_data; content:"execCommand(|22|selectAll|22|)"; fast_pattern:only; content:"onload="; nocase; content:"onselect="; within:50; nocase; pcre:"/body[^>]*?onload[^>]*?onselect/i"; metadata:policy max-detect-ips drop, service http; reference:url,labs.alienvault.com/labs/index.php/2012/new-internet-explorer-zero-day-being-exploited-in-the-wild/; classtype:attempted-user; sid:24210; rev:8;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer html table column span width increase memory corruption attempt"; flow:to_server,established; file_data; content:"table-layout|3A|"; nocase; content:"fixed"; within:7; nocase; content:"var divt = document.getElementById(|22|div_table|22|)"; nocase; content:"<col id='col_id' width='41' span='9'>"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-1876; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-037; classtype:attempted-user; sid:24205; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer html table column span width increase memory corruption attempt"; flow:to_client,established; file_data; content:"table-layout|3A|"; nocase; content:"fixed"; within:7; nocase; content:"var divt = document.getElementById(|22|div_table|22|)"; nocase; content:"<col id='col_id' width='41' span='9'>"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-1876; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-037; classtype:attempted-user; sid:24204; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer html table column span width increase memory corruption attempt"; flow:to_server,established; file_data; content:"table-layout|3A|"; fast_pattern; nocase; content:"fixed"; within:7; nocase; pcre:"/<\s*script.*?(?P<var>\w+)\s*=\s*document\.getElementById\s*\x28\s*[\x22\x27](?P<col_id>[^\x22\x27]+)[\x22\x27]\s*\x29.*?((?P=var)\.span.*?<\s*table.*?<col[^>]*?id\s*=\s*[\x22\x27]?(?P=col_id)[^>]*?>.*?<\s*\/\s*table\s*>|<\s*col.*?id\s*=\s*[\x22\x27]?(?P=col_id)[^>]*?span\s*=\s*[\x22\x27]?\d)/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-1876; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-037; classtype:attempted-user; sid:24203; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer sign extension vulnerability exploitation attempt"; flow:to_server,established; file_data; content:"var reprostr"; nocase; content:"if |28|reprostr.length < 0x7fffffff|29|"; distance:0; nocase; content:"reprostr = reprostr + reprostr"; distance:0; nocase; content:"window.onload"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-2523; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-052; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-056; classtype:attempted-user; sid:23841; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer sign extension vulnerability exploitation attempt"; flow:to_client,established; file_data; content:"var reprostr"; nocase; content:"if |28|reprostr.length < 0x7fffffff|29|"; distance:0; nocase; content:"reprostr = reprostr + reprostr"; distance:0; nocase; content:"window.onload"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-2523; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-052; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-056; classtype:attempted-user; sid:23840; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer negative margin use after free attempt"; flow:to_client,established; file_data; content:"<object"; nocase; content:"align="; within:60; nocase; content:"width"; within:100; distance:-50; nocase; content:!"height"; within:200; distance:-100; nocase; content:!"hspace"; within:200; distance:-100; nocase; content:"dir="; nocase; content:"margin"; nocase; pcre:"/<[^>]*?style\s*[>=].{1,1024}margin\s*\x3a\s*[^\x3b\x7d]*?-\d+.*?[\x7b\x3b]/ims"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,54950; reference:cve,2012-1526; reference:url,osvdb.org/show/osvdb/84595; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-052; classtype:attempted-user; sid:23836; rev:13;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer asynchronous code execution attempt"; flow:to_server,established; file_data; content:"font-face"; nocase; content:"font-family"; distance:0; nocase; content:"src"; distance:0; nocase; content:"url|28|"; within:30; nocase; content:"mailto|3A|"; within:12; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2012-2521; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-052; classtype:attempted-user; sid:23835; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer asynchronous code execution attempt"; flow:to_client,established; file_data; content:"font-face"; nocase; content:"font-family"; distance:0; nocase; content:"src"; distance:0; nocase; content:"url|28|"; within:30; nocase; content:"mailto|3A|"; within:12; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-2521; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-052; classtype:attempted-user; sid:23834; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer getBoundingClientRect incorrect rebalancing attempt"; flow:to_client,established; file_data; content:".getClientRects|28 29|"; fast_pattern:only; content:"for|28|n=0|3B|n<tList.length|3B|n++|29 7B|"; content:"tList|5B|n|5D|.tBodies|5B|0|5D|.appendChild|28|document.createElement|28 27|tr|27 29 29|"; content:"tList|5B|n|5D|.removeChild|28|tList|5B|n|5D|.children|5B|0|5D 29|"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2012-1880; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-037; classtype:attempted-user; sid:23609; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer iframe onreadystatechange handler use after free attempt"; flow:to_client,established; file_data; content:".getElement"; nocase; content:"iframe"; within:25; nocase; content:".onreadystatechange"; within:75; fast_pattern; nocase; pcre:"/\x2eonreadystatechange\s*=\s*(?P<del_func>\w+)\s*\x3b.*?function\s+(?P=del_func)\s*\x28[^\x7b]*?\x7b[^\x7d]*?\x2e(?:innerHTML\s*=|outerHTML\s*=|write)/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,52904; reference:cve,2012-0170; reference:url,osvdb.org/show/osvdb/81128; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-023; classtype:attempted-user; sid:23285; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer corrupted HROW instance write access violation attempt"; flow:to_client,established; file_data; content:"cachesize"; fast_pattern:only; content:"recordset"; nocase; content:"move"; nocase; pcre:"/function\s+[a-z0-9_]+\s*\x28.*?(?P<var>[a-z0-9_]+)\s*=\s*[^\x3B]*?\x2Erecordset\x3B.*?(?P=var)\x2EcacheSize\s*=\s*-0x.*?(?P=var)\x2EMove/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2012-1891; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-045; classtype:attempted-user; sid:23280; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer nested list memory corruption attempt"; flow:to_client,established; file_data; content:"document.body.innerHTML"; fast_pattern:only; content:"<span>"; nocase; content:"<table"; distance:0; nocase; content:"<script>"; distance:0; nocase; pcre:"/(<span>.*?(<[uo]l[^>]*?>.*?){6,}<table[^>]*?>.*?<script[^>]*?>[^\x3b]*?innerHTML\s*=[^\x3b]*?\x3b)|(<script>.*?function\s+(?P<function>[a-z_-]+)\x28\x29\s+\{.*?document\.body\.innerHTML\s*=[^\x3b]*?\x3b.*?<span>.*?(<[uo]l[^>]*?>.*?){6,}<table[^>]*?>.*?<script[^>]*?>\s*(?P=function)\x28\x29\x3b)/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2012-1522; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-044; classtype:attempted-user; sid:23278; rev:8;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft multiple product toStaticHTML XSS attempt"; flow:to_server,established; file_data; content:"<style"; fast_pattern:only; pcre:"/<\s*style\s*>\s*\w+\s*\{\s*(\w+|\w+-\w+)\s*\:\s*\w+\s*\(.*?(\s*\x27\s*|\s*\&\#39\;\s*|\s*\&\#x27\;\s*|\s*\\u0027\;\s*){1}.*?\)\s*(\s*\x27\s*|\s*\&\#39\;\s*|\s*\&\#x27\;\s*|\s*\\u0027\;\s*){3,}.*?\}|(\s*\x27\s*|\s*\&\#39\;\s*|\s*\&\#x27\;\s*|\s*\\u0027\;\s*){1,}.*?\}\s*(\s*\x27\s*|\s*\&\#39\;\s*|\s*\&\#x27\;\s*|\s*\\u0027\;\s*){3,}/smi"; metadata:policy max-detect-ips drop, service smtp; reference:cve,2012-1858; reference:cve,2012-2520; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-037; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-039; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-050; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-066; classtype:attempted-user; sid:23137; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft multiple product toStaticHTML XSS attempt"; flow:to_client,established; file_data; content:"toStaticHTML"; fast_pattern:only; pcre:"/<\s*style\s*>\s*\w+\s*\{\s*(\w+|\w+-\w+)\s*\:\s*\w+\s*\(.*?(\s*\x27\s*|\s*\&\#39\;\s*|\s*\&\#x27\;\s*|\s*\\u0027\;\s*){1}.*?\)\s*(\s*\x27\s*|\s*\&\#39\;\s*|\s*\&\#x27\;\s*|\s*\\u0027\;\s*){3,}.*?\}|(\s*\x27\s*|\s*\&\#39\;\s*|\s*\&\#x27\;\s*|\s*\\u0027\;\s*){1,}.*?\}\s*(\s*\x27\s*|\s*\&\#39\;\s*|\s*\&\#x27\;\s*|\s*\\u0027\;\s*){3,}/smi"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-1858; reference:cve,2012-2520; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-037; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-039; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-050; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-066; classtype:attempted-user; sid:23136; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 memory disclosure attempt"; flow:to_client,established; file_data; content:"event.data.replace("; fast_pattern; nocase; content:"/|5C|0/g"; within:10; content:".postMessage("; nocase; content:"X-UA-Compatible"; pcre:"/var\s+?(?P<var>[^\s=\x3b]+?)\s*?=\s*?[\x22\x27]\x5C0[\x22\x27]\s*?\x3b.*?\.postMessage\(\s*?(?P=var)/smi"; metadata:service http; reference:bugtraq,53844; reference:cve,2012-1873; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-037; classtype:attempted-recon; sid:23128; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer insertAdjacentText memory corruption attempt"; flow:to_client,established; file_data; content:"insertAdjacentText(|22|beforeEnd|22 2C| string1.substring(0,96000))"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2012-1879; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-037; classtype:attempted-user; sid:23126; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer DOM manipulation memory corruption attempt"; flow:to_client,established; file_data; content:"|5D|.fireEvent|28|"; fast_pattern:only; content:"document.getElementsByTagName|28|"; nocase; content:"<div "; nocase; content:"<img "; within:200; nocase; content:"<div "; within:200; nocase; content:".innerHTML"; distance:0; nocase; pcre:"/<img[^>]+id\s*=\s*(?P<q1>\x22|\x27|)(?P<id>[^\x22\x27\x20]+)(?P=q1)[^>]*?>.*?<div[^>]+id\s*=\s*(\x22|\x27|)(?P=id)/smi"; pcre:"/<div[^>]+id\s*=\s*(\x22|\x27|)(?P<id>[^\x22\x27\x20\x3E]+)[^>]*>.*?(?P=id)\.innerHTML/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,53847; reference:cve,2012-1875; reference:url,osvdb.org/show/osvdb/82865; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-037; classtype:attempted-user; sid:23125; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer html table column span width increase memory corruption attempt"; flow:to_client,established; file_data; content:"table-layout|3A|"; fast_pattern; nocase; content:"fixed"; within:7; nocase; pcre:"/<\s*script.*?(?P<var>\w+)\s*=\s*document\.getElementById\s*\x28\s*[\x22\x27](?P<col_id>[^\x22\x27]+)[\x22\x27]\s*\x29.*?((?P=var)\.span.*?<\s*table.*?<col[^>]*?id\s*=\s*[\x22\x27]?(?P=col_id)[^>]*?>.*?<\s*\/\s*table\s*>|<\s*col.*?id\s*=\s*[\x22\x27]?(?P=col_id)[^>]*?span\s*=\s*[\x22\x27]?\d)/ims"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2012-1876; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-037; classtype:attempted-user; sid:23124; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer getBoundingClientRect incorrect rebalancing attempt"; flow:to_client,established; file_data; content:".getBoundingClientRect|28 29|"; fast_pattern:only; content:".insertAdjacentElement"; nocase; content:".insertRow|28 29|"; nocase; pcre:"/document.getElementById\x28\x22(?P<dfnelement>\w+?)\x22\x29\x2einsertAdjacentElement.*document.getElementById\x28\x22\w+?\x22\x29.getBoundingClientRect\x28\x29.*?document.getElementById\x28\x22\w+?\x22\x29.insertRow\x28\x29.*?\x3cdfn id\x3d\x22(?P=dfnelement)\x22\x3e/smi"; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-1880; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-037; classtype:attempted-user; sid:23123; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"; flow:to_client,established; file_data; content:".attachEvent("; content:"onrowsdelete"; within:12; distance:1; content:"srcElement.parentNode.removeChild("; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2012-1881; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-037; classtype:misc-attack; sid:23122; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer center element dynamic manipulation attempt"; flow:to_client,established; file_data; content:"|3C|script|3E|"; nocase; content:"getElementsByTagName"; fast_pattern:only; content:"center"; nocase; content:"appendChild"; nocase; pcre:"/var (?P<centerelement>\w+)\s*\x3D\s*document\x2EgetElementsByTagName\x28\x22center\x22\x29.*?(?P=centerelement)\x5B\w+?\x5D\x2EappendChild\x28/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-1523; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-037; classtype:attempted-user; sid:23121; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer console object use after free attempt"; flow:to_client,established; file_data; content:"console."; fast_pattern:only; content:"CollectGarbage|28 29|"; nocase; content:"alert|28|"; nocase; pcre:"/\x7B\s*?(?P<consoleobject>\w+?)\s*\x3d\s*console\x2e(?=log|error).*?console\s*?\x3d\s*?[^\x3b]*?\x3b.*?CollectGarbage\x28\x29.*?alert\x28(?P=consoleobject)\x29/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2012-1874; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-037; classtype:attempted-user; sid:23118; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 DOM element use after free attempt"; flow:to_client,established; file_data; content:"onpropertychange"; fast_pattern:only; pcre:"/<script[^>]*?for\s*=\s*[\x22\x27]?.*?event\s*=\s*[\x22\x27]?onpropertychange[\x22\x27]?[^>]*?>/ims"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2012-1877; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-037; classtype:attempted-user; sid:23117; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 CTreeNode use after free attempt"; flow:to_client,established; file_data; content:"srcElement.parentNode.removeChild"; fast_pattern:only; pcre:"/\w+\.getElementById\(.*?\)\.attachEvent\(\s*(?P<q1>[\x22\x27]?)(?P<eventid>.*?)(?P=q1)\s*,\s*(?P<repro>\w+)\s*\)\;.*?var\s+(?P<target>\w+)\s*=\s*\w+\.getElementById\(.*?\)\;.*?(?P=target)\.fireEvent\(\s*(?P<q2>[\x22\x27]?)(?P=eventid)(?P=q2)\s*\)\;.*?(?P=target)\.fireEvent\(\s*(?P<q3>[\x22\x27]?)(?P=eventid)(?P=q3)\s*\)\;.*?function\s+(?P=repro)\s*\(\s*(?P<arg>\w+)\s*\)\s*{.*?(?P=arg)\.srcElement\.parentNode\.removeChild\(\s*(?P=arg)\.srcElement\s*\)\;.*?}/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2012-1878; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-037; classtype:attempted-user; sid:23116; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer style.position use-after-free memory corruption attempt"; flow:to_client,established; file_data; content:"style.position"; fast_pattern:only; content:"<script>"; content:"focus"; nocase; pcre:"/(?P<ElementName>\w+)\.focus\s*\x28\s*(?P=ElementName)\s*\x29.*?(?P=ElementName)\.style\.position\s*=\s*[\x27\x22\s]/ims"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0011; reference:cve,2012-0155; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-010; classtype:attempted-dos; sid:23060; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer xbap custom ISeralizable object exception attempt"; flow:to_client,established; file_data; flowbits:isset,file.exe; content:"|86 18 A1 01 90 00 1C 00 23 24 00 00 00 00 86 00 17 03 1F 00 1E 00 38 24 00 00 00 00 96 00 20 04|"; fast_pattern:only; content:"MarshalByRefObject"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0161; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-035; classtype:attempted-user; sid:22080; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer SelectAll dangling pointer use after free attempt"; flow:to_client,established; file_data; content:"document.execCommand|28|'selectAll'|29|"; nocase; content:"document.execCommand|28|'selectAll'|29|"; distance:0; nocase; content:"<body onload"; distance:0; nocase; content:"onbeforedeactivate="; distance:0; nocase; metadata:policy balanced-ips alert, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0171; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-023; classtype:attempted-user; sid:22038; rev:7;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 DOM memory corruption attempt"; flow:to_client,established; file_data; content:"|22|X-UA-Compatible|22|"; nocase; content:"content|3D 22|IE|3D|8|22|"; distance:0; nocase; pcre:"/<\s*script.*?(?P<element2>\w+?)\x2Eparentnode\x2Eremovechild\x28(?P=element2)\x29/smi"; content:"|3C|ul|3E|"; nocase; metadata:service http; reference:bugtraq,37188; reference:cve,2009-3671; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-072; classtype:attempted-user; sid:21994; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer data stream header remote code execution attempt"; flow:to_client,established; content:"|48 54 54 50 2F 31 2E 31 20 32 30 30 20 4F 4B 0A 43 6F 6E 74 65 6E 74 2D 45 6E 63 6F 64 69 6E 67 3A 64 65 66 6C 61 74 65 0A 43 6F 6E 74 65 6E 74 2D 52 61 6E 67 65 3A 0D 09 09 09 09 09 09 09 09 09 0A 0D 0A 20 20|"; fast_pattern:only; metadata:service http; reference:cve,2009-1547; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-054; classtype:attempted-user; sid:21993; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer data stream header remote code execution attempt"; flow:to_client,established; content:"|48 54 54 50 20 0A 43 6F 6E 74 65 6E 74 2D 45 6E 63 6F 64 69 6E 67 3A 64 65 66 6C 61 74 65 0A 43 6F 6E 74 65 6E 74 2D 52 61 6E 67 65 3A 0A 0A|"; fast_pattern:only; metadata:service http; reference:cve,2009-1547; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-054; classtype:attempted-user; sid:21992; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer data stream header remote code execution attempt"; flow:to_client,established; content:"|48 54 54 50 2F 2E 0A 43 6F 6E 74 65 6E 74 2D 45 6E 63 6F 64 69 6E 67 3A 64 65 66 6C 61 74 65 0D 09 0A 0D 0A 20 20|"; fast_pattern:only; metadata:service http; reference:cve,2009-1547; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-054; classtype:attempted-user; sid:21991; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer iframe onreadystatechange handler use after free attempt"; flow:to_client,established; file_data; content:"<iframe"; nocase; content:"onreadystatechange"; within:75; fast_pattern; nocase; pcre:"/function\s+(?P<del_func>\w+)\s*\x28[^\x7b]*?\x7b[^\x7d]*?\x2e(?:innerHTML\s*=|outerHTML\s*=|write).*?<iframe[^>]+onreadystatechange\s*=\s*[\x22\x27]\s*(?P=del_func)/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,52904; reference:cve,2012-0170; reference:url,osvdb.org/show/osvdb/81128; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-023; classtype:attempted-user; sid:21796; rev:12;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer vector graphics reference counting use-after-free attempt"; flow:to_client,established; file_data; content:"|3C 3F|IMPORT namespace=|22|"; nocase; content:"implementation=|22|#default#VML|22 3E|"; within:50; nocase; metadata:policy balanced-ips alert, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,52906; reference:cve,2012-0172; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-023; classtype:attempted-user; sid:21793; rev:12;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer SelectAll dangling pointer use after free attempt"; flow:to_client,established; file_data; content:"document.execCommand|28|'selectAll'|29|"; nocase; content:"document.execCommand|28|'selectAll'|29|"; distance:0; nocase; content:"document.execCommand|28|'selectAll'|29|"; distance:0; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0171; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-023; classtype:attempted-user; sid:21791; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer SelectAll dangling pointer use after free attempt"; flow:to_client,established; file_data; content:"document.designMode='off'"; nocase; content:"document.execCommand('selectAll')"; distance:0; nocase; content:"<body onload=|22|document.execCommand('selectAll')|22| onbeforedeactivate='f()'>"; distance:0; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0171; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-023; classtype:attempted-user; sid:21790; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer toStaticHTML XSS attempt"; flow:to_client,established; file_data; content:"toStaticHTML"; nocase; pcre:"/toStaticHtml\s*\x28[^\x29]*?<\s*style\s*>.*?[&\x22<>]\s*\w+[\x3a=].*?\x29\x3b/i"; metadata:service http; reference:cve,2011-1252; reference:url,technet.microsoft.com/en-us/security/bulletin/ms11-074; classtype:web-application-activity; sid:21569; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer writing-mode property memory corruption attempt"; flow:to_client,established; file_data; content:"table"; nocase; content:"span"; within:50; nocase; content:"writing-mode"; within:50; nocase; content:">"; within:50; content:"table"; within:50; nocase; metadata:policy max-detect-ips drop, service http; reference:bugtraq,36616; reference:cve,2009-2531; classtype:attempted-user; sid:21392; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer mouse drag hijack"; flow:to_client,established; file_data; content:"createPopup"; nocase; content:"onmousedown"; distance:0; nocase; content:"pop.show"; distance:0; nocase; pcre:"/(?P<q1>\w+)\x3Dwindow\x2EcreatePopup.*?onmousedown[^\x3C]*(?P=q1)\x2Eshow/smi"; metadata:service http; reference:cve,2004-0841; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-038; classtype:attempted-user; sid:21353; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 null character in string information disclosure attempt"; flow:to_client,established; file_data; content:"http-equiv=|22|X-UA-Compatible|22|"; nocase; content:"content=|22|IE=9|22|"; fast_pattern:only; content:"|5C|u0000"; nocase; pcre:"/\x3Cmeta\s*http\x2Dequiv\x3D\x22X\x2DUA\x2DCompatible\x22[^\x3E]*content\x3D\x22IE\x3D9\x22.*?var\s*\w+\s*\x3D\s*\x22[^\x22]*\x5Cu0000/smi"; metadata:policy max-detect-ips drop, service http; reference:cve,2012-0012; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-010; classtype:attempted-recon; sid:21300; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer style.position use-after-free memory corruption attempt"; flow:to_client,established; file_data; content:"style.position"; fast_pattern:only; content:"cloneNode"; nocase; pcre:"/var\s*(?P<v1>\w+).*?var\s*(?P<v2>\w+)\s*=\s*(?P=v1)\.cloneNode.*?\.focus\s*\x28\s*(?P=v2)\s*\x29.*?style\.position\s*=\s*[\x27\x22\s]/ims"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0011; reference:cve,2012-0155; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-010; classtype:attempted-dos; sid:21292; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer orphan DOM objects memory corruption attempt"; flow:to_client,established; file_data; content:"createElement"; nocase; content:"appendChild"; distance:0; nocase; content:"attributes"; distance:0; nocase; pcre:"/var\s*(?P<firstDOM>\w+?)\s*\x3D\s*document\x2EcreateElement.*?(?P<secondDOM>\w+?)\s*\x3D\s*document\x2EcreateElement\x28\x27(?P<reference>\w+?)\x27\x29.*?(?P=firstDOM)\x2EappendChild\x28(?P=secondDOM)\x29.*?(?P=secondDOM)\x2E(?P=reference)\s*?\x3D\s*?(?P=firstDOM)\x2Eattributes/smi"; metadata:service http; reference:cve,2009-3674; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-072; classtype:attempted-user; sid:21272; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer object clone deletion memory corruption"; flow:to_client,established; file_data; content:"fromCharCode|28|parseInt|28|"; fast_pattern:only; content:"|22|.replace|28 2F 5B|A-Z|5D 2F|g,|22 22 29|]"; metadata:policy max-detect-ips drop, service http; reference:cve,2009-0075; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-002; classtype:attempted-user; sid:21086; rev:11;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer contenteditable corruption attempt malicious string"; flow:to_client,established; file_data; content:"TTu0d0fu0d0eKKJJu0d0du0d0dLL1043416UU"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-1255; classtype:attempted-user; sid:20822; rev:11;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer contenteditable corruption attempt"; flow:to_client,established; file_data; content:"#default#time2"; fast_pattern:only; content:"schemas-microsoft-com:time"; nocase; content:"contenteditable"; nocase; content:"|3A|switch"; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-1255; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-user; sid:20811; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer contenteditable corruption attempt"; flow:to_client,established; file_data; content:"#default#time2"; fast_pattern:only; content:"schemas-microsoft-com:time"; nocase; content:"contenteditable"; nocase; content:"|3A|animate"; nocase; pcre:"/^(Color|Motion)/Ri"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-1255; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-user; sid:20810; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer contenteditable corruption attempt"; flow:to_client,established; file_data; content:"#default#time2"; fast_pattern:only; content:"schemas-microsoft-com:time"; nocase; content:"contenteditable"; nocase; content:"|3A|animate"; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-1255; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-user; sid:20809; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer contenteditable corruption attempt"; flow:to_client,established; file_data; content:"#default#time2"; fast_pattern:only; content:"schemas-microsoft-com:time"; nocase; content:"contenteditable"; nocase; content:"|3A|set"; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-1255; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-user; sid:20808; rev:10;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer contenteditable corruption attempt"; flow:to_server,established; file_data; content:"#default#time2"; fast_pattern:only; content:"schemas-microsoft-com:time"; nocase; content:"contenteditable"; nocase; content:"|3A|switch"; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2011-1255; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-user; sid:20807; rev:10;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer contenteditable corruption attempt"; flow:to_server,established; file_data; content:"#default#time2"; fast_pattern:only; content:"schemas-microsoft-com:time"; nocase; content:"contenteditable"; nocase; content:"|3A|animate"; nocase; pcre:"/^(Color|Motion)/Ri"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2011-1255; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-user; sid:20806; rev:10;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer contenteditable corruption attempt"; flow:to_server,established; file_data; content:"#default#time2"; fast_pattern:only; content:"schemas-microsoft-com:time"; nocase; content:"contenteditable"; nocase; content:"|3A|animate"; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2011-1255; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-user; sid:20805; rev:10;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer contenteditable corruption attempt"; flow:to_server,established; file_data; content:"#default#time2"; fast_pattern:only; content:"schemas-microsoft-com:time"; nocase; content:"contenteditable"; nocase; content:"|3A|set"; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2011-1255; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-user; sid:20804; rev:10;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer layout-grid-char value exploit attempt"; flow:to_server,established; file_data; content:"heapspray|28 29|"; content:"document.body.innerHTML"; nocase; content:"1000pc"; distance:0; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2011-1260; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-user; sid:20790; rev:11;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer layout-grid-char value exploit attempt"; flow:to_server,established; file_data; content:"heap_obj"; content:"document.body.innerHTML += String.fromCharCode"; nocase; content:"1000pc"; distance:0; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2011-1260; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-user; sid:20789; rev:11;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer layout-grid-char value exploit attempt"; flow:to_client,established; file_data; content:"heap_obj"; content:"document.body.innerHTML += String.fromCharCode"; nocase; content:"1000pc"; distance:0; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-1260; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-user; sid:20788; rev:12;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer layout-grid-char value exploit attempt"; flow:to_server,established; file_data; content:"document.body.innerHTML"; nocase; pcre:"/(0x2d|055|45),\s*(0x31|061|49),\s*(0x30|060|48),\s*(0x30|060|48),\s*(0x30|060|48),\s*(0x63|0143|99),\s*(0x6D|0155|109)/"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2011-1260; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-user; sid:20787; rev:11;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer layout-grid-char value exploit attempt"; flow:to_server,established; file_data; content:"layout-grid-char|3A|"; nocase; byte_test:10,>,9999,0,relative,string; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2011-1260; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-admin; sid:20786; rev:10;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer contenteditable corruption attempt"; flow:to_server,established; file_data; content:"#default#time2"; fast_pattern:only; content:"schemas-microsoft-com:time"; nocase; content:"contenteditable"; nocase; content:"|3A|transitionFilter"; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2011-1255; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-user; sid:20766; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer XSRF timing attack against XSS filter"; flow:to_client,established; file_data; content:"onload"; nocase; content:"timeCount"; nocase; content:"tcInterval"; nocase; content:"setInterval"; nocase; pcre:"/iframe.*?id\s*\x3d\s*(?P<q1>\w*)\s*src\s*\x3d\s*.*?(?P=q1)\x2elocation\s*\x3d\s*(?P<q2>\x22|\x27|)\s*(http|https)\x3a\x2f\x2f.*?(?P=q2)/smi"; metadata:service http; reference:cve,2011-1992; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-089; classtype:attempted-recon; sid:20699; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer onscroll DOS attempt"; flow:to_client,established; file_data; content:"function"; nocase; content:"createElement"; distance:0; nocase; content:"onscroll"; distance:0; fast_pattern; nocase; pcre:"/\s*function\s*(?P<badfunction>\w+)\s*\x28\s*\x29.+onscroll\s*=\s*[\x22\x27]+(?P=badfunction).*[\x22\x27]/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,49947; reference:cve,2011-1993; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-081; classtype:attempted-user; sid:20634; rev:13;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer HTML DOM invalid DHTML textnode creation attempt"; flow:to_client,established; file_data; content:"window.open"; fast_pattern:only; content:"createTextNode"; pcre:"/(\w+)\s*=\s*\window\.open\(\)\s*\;.*?\1\.\w+\.(insertBefore|insertAfter|appendChild)\(\w+\.createTextNode\(((\x22\x22|\x27\x27)|([A-z]\w*))\)/s"; metadata:service http; reference:bugtraq,13120; reference:cve,2005-0553; reference:nessus,10861; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-020; classtype:attempted-user; sid:20279; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer HTML DOM invalid DHTML textnode creation attempt"; flow:to_client,established; file_data; content:"window.open().document.appendChild(a)|3B|"; content:"document.removeChild(a)"; within:50; metadata:service http; reference:bugtraq,13120; reference:cve,2005-0553; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-020; classtype:attempted-user; sid:20278; rev:7;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer HTML DOM invalid DHTML comment creation attempt"; flow:to_client,established; file_data; content:"window.open"; fast_pattern:only; content:"createComment"; pcre:"/(\w+)\s*=\s*\w+\.createComment\(((\x22\x22|\x27\x27)|([A-z]\w*))\)\s*\;.*?\w+\.(insertBefore|insertAfter|appendChild)\(\1\)\;|window\.open\(\)\.\w\.(insertBefore|insertAfter|appendChild)\(\w+\.createComment\(((\x22\x22|\x27\x27)|([A-z]\w*))\)/s"; metadata:service http; reference:bugtraq,13120; reference:cve,2005-0553; reference:nessus,10861; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-020; classtype:attempted-user; sid:20277; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer jscript9 parsing corruption attempt"; flow:to_client,established; file_data; content:"X-UA-Compatible|22|content=|22|IE=EmulateIE7|22|"; fast_pattern:only; content:"https://getfirebug.com/firebug-lite.js#saveCookies=true"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-1998; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-081; classtype:attempted-user; sid:20273; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Marquee stylesheet object removal"; flow:to_client,established; file_data; content:"marquee|2E|removeNode"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,49966; reference:cve,2011-2001; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-081; classtype:attempted-user; sid:20268; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer circular reference exploit attempt"; flow:to_client,established; file_data; content:"document|2E|body"; nocase; content:"applyElement"; fast_pattern; nocase; content:"clearAttributes"; nocase; pcre:"/var\s+(\w+)\s*=\s*document\x2Ebody.+applyElement\x28\s*\1/si"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,49965; reference:cve,2011-2000; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-081; classtype:attempted-user; sid:20267; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 Javascript negative option index attack attempt"; flow:to_client,established; file_data; content:"<script"; nocase; content:".options.add"; distance:0; nocase; pcre:"/options\.add\x28.*?,\s*?(\-0x[a-f0-9]+?\s*?|-[0-9]{6,15}\s*?)\x29/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,49964; reference:cve,2011-1999; reference:url,osvdb.org/show/osvdb/76211; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-081; classtype:attempted-user; sid:20266; rev:17;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer null attribute DoS attempt"; flow:to_client,established; file_data; content:"setTimeout("; fast_pattern:only; content:"<script"; nocase; content:"function "; distance:0; nocase; content:".attributes|3B|"; distance:0; nocase; content:"setTimeout("; distance:0; nocase; pcre:"/function\s+?(?P<function>\w+)\s*?\([^{]*?.*?\w+\s*?=\s*?null\x3b.*?setTimeout\([^,)\x3b]*?(?P=function)\(?/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,49962; reference:cve,2011-1997; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-081; classtype:attempted-user; sid:20265; rev:14;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer form selection reset attempt"; flow:to_client,established; file_data; content:"document.getElementById"; fast_pattern:only; content:"form"; nocase; content:"document.createElement("; distance:0; nocase; content:".inner"; distance:0; nocase; content:".reset("; distance:0; nocase; pcre:"/document.getElementById.+?(\w+\.add\(\s*document.createElement|document.createElement\(.+?\w\.add\().+?\w\.inner(HTML|Text)\s*?=[^\x3b]+?\x3b.*?\w+\.reset\(/smi"; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,49961; reference:cve,2011-1996; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-081; classtype:attempted-user; sid:20264; rev:16;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer htmlfile null attribute access attempt"; flow:to_client,established; file_data; content:"25336920-03F9-11CF-8FD0-00AA00686F13"; fast_pattern:only; content:".attributes["; nocase; pcre:"/<object[^>]+id\s*?=\s*?[\x22\x27]?([A-Z\d]+)[\x22\x27]?[^>]+classid\s*?=\s*?[\x22\x27]?clsid\x3A25336920-03F9-11CF-8FD0-00AA00686F13[\x22\x27]?.*?\1\.attributes.*?for\s*\x28[^\x29]+\1\.attributes\x5B/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,49960; reference:cve,2011-1995; reference:url,osvdb.org/show/osvdb/76207; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-081; classtype:attempted-user; sid:20263; rev:14;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer onscroll DOS attempt"; flow:to_client,established; file_data; content:"function"; nocase; content:"onscroll"; distance:0; nocase; content:"createElement"; nocase; pcre:"/function\s+(?P<q2>\w).*onscroll\s*=\s*(?P<q1>\w).*function\s+(?P=q1).*createElement\s*\x28\s*(?P<q3>\x22|\x27|)\s*table\s*(?P=q3)\s*\x29.*onload\s*=\s*(?P=q2)/smi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,49947; reference:cve,2011-1993; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-081; classtype:attempted-user; sid:20262; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer invalid object access memory corruption attempt"; flow:to_client,established; file_data; content:".length|3B|i++"; nocase; content:"+= String.fromCharCode("; within:100; nocase; content:".charCodeAt(i)"; within:100; pcre:"/iframe\s+src\s*\x3D\s*(\x22|\x27)[^\1]+\x2Egif\1\s+onload\s*\x3D\s*(\x22|\x27)[^\2]+\x28event\x29\2/smi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2010-0249; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-002; classtype:attempted-user; sid:19937; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer VML use after free attempt"; flow:to_client,established; file_data; content:"urn:schemas-microsoft-com:vml"; fast_pattern:only; pcre:"/<v\s*\x3a\s*(image|imagedata|fill|stroke)\s+id\s*=\s*\x22([^\x22]*)\x22[^\x3E]*style\s*=\s*\x22[^\x22]*\x23default\x23VML[^\x22]*\x22.*document\x2EgetElementById\s*\x28\s*\x22\2\x22\s*\x29\x2Esrc\s+\x3D/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,48173; reference:cve,2011-1266; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-052; classtype:attempted-user; sid:19910; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer daxctle.ocx spline method buffer overflow attempt"; flow:to_client,established; file_data; content:"|28 28|0x200c-4|29 2F|2|29|"; fast_pattern; content:"|28|14|2F|2|29|"; within:150; metadata:policy max-detect-ips drop, service http; reference:cve,2006-4446; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-067; classtype:attempted-user; sid:19885; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSS style memory corruption attempt"; flow:to_client,established; file_data; content:"table"; content:!"."; within:1; content:!"-"; within:1; content:!"selec"; within:5; distance:-10; content:"position"; within:70; nocase; content:"absolute"; within:20; nocase; content:"clip"; within:80; distance:-30; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2010-3962; reference:url,technet.microsoft.com/en-us/security/advisory/2458511; classtype:attempted-user; sid:19873; rev:13;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer MDAC remote code execution attempt"; flow:to_client,established; file_data; content:"eval|28 22|r|3D|o|22|"; nocase; content:"ect|28|n|2C 27 27 29|"; distance:0; nocase; pcre:"/bj\x22[\x0D\x0A\s\t]*\x2b[\x0D\x0A\s\t]*\x22ect\x28n\x2C\x27\x27\x29/smi"; metadata:policy max-detect-ips drop, service http; reference:cve,2006-0003; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-014; classtype:attempted-user; sid:19872; rev:7;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer VML buffer overflow attempt"; flow:to_client,established; file_data; content:".length"; content:"<"; within:225; content:"="; within:150; content:"0x400000"; pcre:"/[a-z]+\.substring\x28\s+0\s+\x2c\s+0x100000\s+-\s+[a-z]+\.length\s+\x29/smi"; metadata:policy max-detect-ips drop, service http; reference:cve,2006-4868; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-055; classtype:attempted-user; sid:19871; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer empty table tag memory corruption attempt"; flow:to_client,established; file_data; content:"document.getElementsByName(|22|innertable|22|)[0]"; nocase; content:"appendChild(document.createElement(|27|TR|27|))"; distance:0; nocase; metadata:policy max-detect-ips drop, service http; reference:cve,2009-1918; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-034; classtype:attempted-user; sid:19814; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer covered object memory corruption attempt"; flow:to_client,established; file_data; content:"style="; nocase; content:"padding-left|3A|-1000px"; distance:0; nocase; content:"text-indent|3A|-1000px"; distance:0; nocase; pcre:"/<[A-Z]+\s+[^>]*?padding-left\x3A\x2D1000px\x3B[^>]*text-indent\x3A\x2D1000px/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2011-1256; reference:cve,2012-1260; reference:url,technet.microsoft.com/en-us/security/bulletin/ms11-050; classtype:attempted-user; sid:19809; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer covered object memory corruption attempt"; flow:to_client,established; file_data; content:".body.innerHTML +="; nocase; content:"function |28 29| |7B|"; within:50; nocase; isdataat:200,relative; content:!"|7D|"; within:200; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2011-1256; reference:url,technet.microsoft.com/en-us/security/bulletin/ms11-050; classtype:attempted-user; sid:19808; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer stylesheet dynamic access memory corruption attempt"; flow:to_client,established; file_data; content:"addBehavior|28|"; nocase; content:".onreadystatechange"; distance:0; nocase; content:".innerHTML"; distance:0; nocase; pcre:"/([A-Z\d_]+)\.addBehavior\x28.*?\.onreadystatechange\s*=\s*function[^\x7B]+\x7B[^\x7D]*\1\.innerHTML/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2011-1964; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-057; classtype:attempted-user; sid:19672; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer XSLT memory corruption attempt"; flow:to_client,established; file_data; content:"xmlns"; nocase; content:"|3A|xsl"; within:8; nocase; content:"http|2D|equiv|3D|"; nocase; content:"refresh"; within:10; nocase; content:"onunload"; fast_pattern:only; pcre:"/http\x2dequiv\x3d\s*?[\x22\x27]\s*?refresh\s*?[\x22\x27]\s*?content\s*?\x3d\s*?[\x22\x27]\s*?((1\s*?)|(0\s*?)|(\.\d\s*?)|(1\.\d\s*?))[\x22\x27]/smi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,49037; reference:cve,2011-1963; reference:url,osvdb.org/show/osvdb/74499; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-057; classtype:attempted-user; sid:19671; rev:15;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"BROWSER-IE Microsoft Internet Explorer telnet.exe file load exploit attempt"; flow:to_server,established; content:"|2F|telnet.exe"; nocase; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2011-1961; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-057; classtype:attempted-user; sid:19670; rev:11;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"BROWSER-IE Microsoft Internet Explorer telnet.exe file load exploit attempt"; flow:to_server,established; content:"t|00|e|00|l|00|n|00|e|00|t|00|.|00|e|00|x|00|e|00 00 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, service netbios-ssn; reference:cve,2011-1961; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-057; classtype:attempted-user; sid:19668; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer cross-domain scripting attack"; flow:to_client,established; file_data; content:"document.domain"; nocase; content:"this.document.domain"; within:100; nocase; content:"window.open|28| |27|redirect.aspx|27| |29|"; within:200; nocase; metadata:service http; reference:cve,2011-1960; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-057; classtype:attempted-user; sid:19667; rev:7;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer multi-window access memory corruption attempt"; flow:to_client,established; file_data; content:"open|28 22 23|newwnd"; nocase; content:".document.open|28 29|"; distance:0; nocase; pcre:"/([A-Z\d_]+)\s*=\s*open\x28.*?\1\.document\.open\x28\x29/smi"; metadata:service http; reference:cve,2011-1257; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-057; classtype:attempted-user; sid:19666; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CStyleSheetRule array memory corruption attempt"; flow:to_client,established; file_data; content:"document.styleSheets"; fast_pattern; nocase; content:".addRule|28|"; within:200; nocase; content:"removeRule"; within:200; nocase; content:"removeRule"; within:200; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,43705; reference:cve,2010-3328; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-071; classtype:attempted-user; sid:19436; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Cross-Domain information disclosure attempt"; flow:to_client,established; file_data; content:"alert|28|myLink.styleSheet.cssText|29|"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:bugtraq,43709; reference:cve,2010-3330; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-071; classtype:attempted-user; sid:19411; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer and SharePoint toStaticHTML information disclosure attempt"; flow:to_client,established; file_data; content:"|09 64 6F 63 75 6D 65 6E 74 2E 77 72 69 74 65 28 74 6F 53 74 61 74 69 63 48 54 4D 4C 28 61 63 74 69 76 65 43 6F 64 65 29 29 3B 0D 0A|"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:cve,2010-3243; classtype:attempted-recon; sid:19322; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer layout-grid-char value exploit attempt"; flow:to_client,established; file_data; content:"document.body.innerHTML"; nocase; pcre:"/(0x2d|055|45),\s*(0x31|061|49),\s*(0x30|060|48),\s*(0x30|060|48),\s*(0x30|060|48),\s*(0x63|0143|99),\s*(0x6D|0155|109)/"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-1260; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-user; sid:19266; rev:14;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer layout-grid-char value exploit attempt"; flow:to_client,established; file_data; content:"heapspray|28 29|"; content:"document.body.innerHTML"; nocase; content:"1000pc"; distance:0; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-1260; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-user; sid:19265; rev:15;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSS expression defined to empty selection attempt"; flow:to_client,established; file_data; content:"expression"; nocase; content:"document.selection.empty"; within:50; pcre:"/expression\s*\x28\s*document\x2eselection\x2eempty\s*\x28\s*\x29\s*\x29/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,48210; reference:cve,2011-1261; reference:url,osvdb.org/show/osvdb/72951; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-user; sid:19246; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer redirect to cdl protocol attempt"; flow:to_client,established; content:"302 Redirect"; nocase; content:"Location|3A 20|cdl|3A 2F 2F|"; distance:0; nocase; http_header; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2011-1262; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-admin; sid:19245; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer layout-grid-char value exploit attempt"; flow:to_client,established; file_data; content:"layout-grid-char|3A|"; nocase; byte_test:10,>,9999,0,relative,string; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-1260; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-admin; sid:19243; rev:15;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Windows Vector Markup Language imagedata page deconstruction attempt"; flow:to_client,established; file_data; content:"schemas-microsoft-com|3A|vml"; nocase; content:"getElementById|28 22|tshape|22 29 2E|imagedata|2E|src|20 3D 20 22|a|22|"; nocase; metadata:policy max-detect-ips drop, service http; reference:bugtraq,48173; reference:cve,2011-1264; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-052; classtype:attempted-admin; sid:19242; rev:13;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Windows Vector Markup Language imagedata page deconstruction attempt"; flow:to_client,established; file_data; content:"schemas-microsoft-com|3A|vml"; nocase; content:"getElementById|28 22|tshape|22 29 2E|fill|2E|src|20 3D 20 22|a|22|"; nocase; metadata:policy max-detect-ips drop, service http; reference:bugtraq,48173; reference:cve,2011-1264; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-052; classtype:attempted-admin; sid:19241; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 6/7/8 reload stylesheet attempt"; flow:to_client,established; file_data; content:"<link"; content:".href"; nocase; content:".rel"; distance:0; nocase; content:"stylesheet"; distance:0; fast_pattern; nocase; content:".href"; distance:0; nocase; content:"location.reload"; distance:0; nocase; pcre:"/(?P<q1>[a-zA-Z0-9]*)\x2ehref\s*\x3d.*(?P=q1)\x2erel\s*\x3d.*(?P=q1)\x2ehref\s*\x3d/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-1250; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-user; sid:19240; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 toStaticHTML XSS attempt"; flow:to_client,established; file_data; content:"toStaticHTML("; fast_pattern; nocase; content:"expression("; within:100; nocase; pcre:"/toStaticHTML\x28.*?[\x26\x22].=expression\x28/smi"; metadata:service http; reference:cve,2011-1252; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-user; sid:19239; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 self remove from markup vulnerability"; flow:to_client,established; file_data; content:"getElementById"; nocase; content:"parentNode.RemoveChild"; distance:0; fast_pattern; nocase; content:"location.reload()"; nocase; pcre:"/(?P<q1>\w*)\s*\x3d\s*document\x2egetElementById\x28(?P<q2>[\x22\x26])(?P<q3>\w*+)(?P=q2).*(?P=q1)\x2eparentNode\x2eremoveChild.*span\s+id\s*\x3d\s*(?P<q4>[\x22\x26])(?P=q3)(?P=q4)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-1251; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-user; sid:19238; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer contenteditable corruption attempt"; flow:to_client,established; file_data; content:"#default#time2"; fast_pattern:only; content:"schemas-microsoft-com:time"; nocase; content:"contenteditable"; nocase; content:"|3A|transitionFilter"; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-1255; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-user; sid:19237; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer drag event memory corruption attempt"; flow:to_client,established; file_data; content:"dataTransfer.effectAllowed"; nocase; content:"dataTransfer.setData|28 22|URL|22|"; within:100; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,48204; reference:cve,2011-1254; reference:url,osvdb.org/show/osvdb/72946; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-admin; sid:19236; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer copy/paste memory corruption attempt"; flow:to_client,established; file_data; content:"obj.outerHTML = 0x41414141"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-1256; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-user; sid:19235; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer MsgBox arbitrary code execution attempt"; flow:to_client,established; file_data; content:"MsgBox"; content:"|22 5C 5C|"; fast_pattern; content:".hlp|22|"; within:50; pcre:"/(^|\s)(?P<var>[^\s]+)\s*=\s*\x22\x5c\x5c[^\x22]*\x2ehlp\x22.*MsgBox\s+(\x22[^\x22]*\x22|[^,]*)\s*,\s*[0-9]*\s*,\s*(\x22[^\x22]*\x22|[^,]*)\s*,\s*(?P=var)/smi"; metadata:policy max-detect-ips drop, service http; reference:cve,2010-0483; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-022; classtype:attempted-user; sid:19204; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer MsgBox arbitrary code execution attempt"; flow:to_client,established; file_data; content:"MsgBox"; content:"|22 5C 5C|"; within:300; fast_pattern; content:".hlp|22|"; within:50; pcre:"/MsgBox\s+(\x22[^\x22]*\x22|[^,]*)\s*,\s*[0-9]*\s*,\s*(\x22[^\x22]*\x22|[^,]*)\s*,\s*\x22\x5c\x5c[^\x22]*\x2ehlp\x22/smi"; metadata:policy max-detect-ips drop, service http; reference:cve,2010-0483; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-022; classtype:attempted-user; sid:19203; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer iframe uninitialized memory corruption attempt"; flow:to_client,established; file_data; content:"setTimeout|28 27|removeiframe|28 29 27 2C|0|29|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,42257; reference:cve,2010-2556; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-053; classtype:attempted-user; sid:19181; rev:12;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"BROWSER-IE Microsoft Internet Explorer 8 ieshims.dll dll-load exploit attempt"; flow:to_server,established; content:"i|00|e|00|s|00|h|00|i|00|m|00|s|00|.|00|d|00|l|00|l|00|"; fast_pattern:only; metadata:policy max-detect-ips drop, service netbios-ssn; reference:bugtraq,46159; reference:cve,2011-0038; reference:url,technet.microsoft.com/en-us/security/bulletin/ms11-003; classtype:attempted-user; sid:19172; rev:11;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"BROWSER-IE Microsoft Internet Explorer 8 ieshims.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|ieshims.dll"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http; reference:bugtraq,46159; reference:cve,2011-0038; reference:url,technet.microsoft.com/en-us/security/bulletin/ms11-003; classtype:attempted-user; sid:19171; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer malformed table tag memory corruption attempt"; flow:to_client,established; file_data; content:"rowspan"; fast_pattern:only; content:"<script>"; nocase; pcre:"/<t(d|r|h|head|foot)[^>]+id\s*=\s*(?P<q1>\x22|\x27|)([^\x22\x27]+)(?P=q1).*?\3\.rowspan.*?<\/script>.*?<\/table>/smi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2010-2560; classtype:attempted-user; sid:19150; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer malformed table tag memory corruption attempt"; flow:to_client,established; file_data; content:"colspan"; fast_pattern:only; content:"<script>"; nocase; pcre:"/<t(d|r|h|head|foot)[^>]+id\s*=\s*(?P<q1>\x22|\x27|)([^\x22\x27]+)(?P=q1).*?\3\.colspan.*?<\/script>.*?<\/table>/smi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2010-2560; classtype:attempted-user; sid:19149; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer outerHTML against incomplete element heap corruption attempt"; flow:to_client,established; file_data; content:".outerHTML"; fast_pattern; content:"document|2E|createStyleSheet"; within:75; nocase; pcre:"/\s(id|name)\s*?=\s*?[\x22\x27](?P<id1>\w+)[\x22\x27].*?<script[^<]*?(?P=id1)\x2eouterHTML(\x2b{2}|\s*?=\s*?[\x22\x27])/si"; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-0490; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-018; classtype:attempted-user; sid:19147; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSS style memory corruption attempt"; flow:to_client,established; file_data; content:"<style type="; nocase; content:"text/css"; within:50; nocase; content:"position|3A|absolute"; within:50; nocase; content:"clip|3A 20|rect(1px)"; within:50; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2010-3962; reference:url,technet.microsoft.com/en-us/security/advisory/2458511; classtype:attempted-user; sid:19084; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer getElementById object corruption"; flow:to_client, established; file_data; content:"function post_info(info_array)"; content:"info_array.length|3B| i ++)"; distance:0; pcre:"/^\s*\x7B[^\x7D]*document\.createElement\('input'\)[^\x7D]*form\.appendChild\(plugin\)\s*\x7D/smiR"; content:"document.body.removeChild(form)|3B|"; metadata:service http; reference:bugtraq,30614; reference:cve,2008-2254; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-045; classtype:attempted-user; sid:19079; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTableLayout memory corruption attempt"; flow:to_client,established; file_data; content:"document.getElement"; nocase; content:".onpropertychange"; within:75; fast_pattern; nocase; content:"window."; within:75; nocase; content:"<table"; distance:0; nocase; content:"<col"; within:75; nocase; pcre:"/var\s+(?P<del_func>\w+)\s*=\s*function\s*\x28\s*\x29\s*\x7b[^\x7d]+?\x2e(inner|outer)HTML\s*=\s*[\x22\x27]\s*[\x22\x27].*?\x2eonpropertychange\s*=\s*window\x2e(?P=del_func)/smi"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,37891; reference:cve,2010-0244; reference:url,osvdb.org/show/osvdb/61910; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-002; classtype:attempted-user; sid:18951; rev:11;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer object management memory corruption attempt"; flow:to_client,established; file_data; content:".onpropertychange"; nocase; content:".childNode"; within:50; nocase; content:".onpropertychange"; distance:0; nocase; content:"null"; within:50; nocase; pcre:"/(?P<q1>[A-Z\d_]+)\.onpropertychange\s*=\s*(?P=q1)\.childNode.*?(?P=q1)\.onpropertychange\s*=\s*null.*?(?P=q1)\.onpropertychange/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,46821; reference:cve,2011-1345; reference:url,osvdb.org/show/osvdb/71725; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-018; classtype:attempted-user; sid:18671; rev:15;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer object management memory corruption attempt"; flow:to_client,established; file_data; content:".onpropertychange"; nocase; content:".attributes"; within:50; nocase; content:".onpropertychange"; distance:0; nocase; content:"null"; within:50; nocase; pcre:"/(?P<q1>[A-Z\d_]+)\.onpropertychange\s*=\s*(?P=q1)\.attributes.*?(?P=q1)\.onpropertychange\s*=\s*null.*?(?P=q1)\.onpropertychange/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,46821; reference:cve,2011-1345; reference:url,osvdb.org/show/osvdb/71725; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-018; classtype:attempted-user; sid:18670; rev:15;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer event handling remote code execution attempt"; flow:to_client,established; file_data; content:"window.event.srcElement"; nocase; content:".innerHTML"; within:20; nocase; content:"onmouseleave"; within:30; fast_pattern; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2010-0267; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-018; classtype:attempted-user; sid:18539; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer HTML DOM invalid DHTML exploit attempt"; flow:to_client,established; content:"document.writeln|28 28|block.length|2B|memory|5B|0|5D 2E|length|2A|300|29 29 3B|"; content:"child_creator.click|28 29 3B|"; within:100; metadata:service http; reference:bugtraq,13120; reference:cve,2005-0553; reference:nessus,10861; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-020; classtype:attempted-user; sid:18523; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer HTML DOM invalid DHTML element creation attempt"; flow:to_client,established; content:"child_creator|20 3D 20|document|2E|createElement|28 22 3C|A target|3D 27|_blank|27|"; content:"document.body.insertBefore|28|child_creator|29 3B|"; within:200; metadata:service http; reference:bugtraq,13120; reference:cve,2005-0553; reference:nessus,10861; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-020; classtype:attempted-user; sid:18522; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer HTML DOM invalid DHTML element creation attempt"; flow:to_client,established; content:"child_element|20 3D 20|child|2E|document|2E|createElement|28 22 22 29 3B|"; content:"child_element|2E|appendChild|28|parent_element|29 3B|"; distance:0; metadata:service http; reference:bugtraq,13120; reference:cve,2005-0553; reference:nessus,10861; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-020; classtype:attempted-user; sid:18521; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer HTML DOM invalid DHTML exploit attempt"; flow:to_client,established; content:"try { window.open().document.appendChild(document)|3B| } catch(e) {}"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,13120; reference:cve,2005-0553; reference:nessus,10861; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-020; classtype:attempted-user; sid:18520; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer HTML DOM invalid DHTML element creation attempt"; flow:to_client,established; content:"filler|20 2B 3D 20|unescape|28 22 25|u0000|25|u0000"; content:"obj|2E|insertBefore|28|document|2E|createElement|28|filler|29 29 3B|"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:bugtraq,13120; reference:cve,2005-0553; reference:nessus,10861; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-020; classtype:attempted-user; sid:18519; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer HTML DOM invalid DHTML comment creation attempt"; flow:to_client,established; content:"|61 00 72 00 65 00 6E 00 74 00 5F 00 65 00 6C 00 65 00 6D 00 65 00 6E 00 74 00 2E 00 61 00 70 00 70 00 65 00 6E 00 64 00 43 00 68 00 69 00 6C 00 64 00 28 00 64 00 6F 00 63 00 75 00 6D 00 65 00 6E 00 74 00 2E 00 63 00 72 00 65 00 61 00 74 00 65 00 43 00 6F 00 6D 00 6D 00 65 00 6E 00 74 00 28 00 73 00 4D 00 53 00 48 00 54 00 4D 00 4C 00 5F 00 68 00 65 00 61 00 70 00 5F 00 73 00 70 00 72 00 61 00 79 00 29 00 29 00 3B 00|"; fast_pattern:only; metadata:service http; reference:bugtraq,13120; reference:cve,2005-0553; reference:nessus,10861; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-020; classtype:attempted-user; sid:18518; rev:7;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"BROWSER-IE Microsoft Internet Explorer long URL buffer overflow attempt"; flow:to_server,established; urilen:>200; content:"|04 04 04|"; http_uri; metadata:service http; reference:bugtraq,19667; reference:cve,2006-3869; classtype:attempted-user; sid:18517; rev:5;)
# alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"BROWSER-IE Microsoft Internet Explorer History.go method double free corruption attempt"; flow:to_client,established; file_data; content:"for|28|"; content:"<50|3B|"; within:20; distance:5; content:"history|2E|go|28|"; within:100; fast_pattern; pcre:"/for\(\s*var\s*\w+\x3D0\x3B\s*\w+\<50\x3B\s*\w+\x2B\x2B\s*\)\s*\{\s*history\.go\((?P<v2>\w+)[^}]{0,100}(?P=v2)(\[\w+\])?\s*\x2B\x3D\s*\w+\x3B/smi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,34423; reference:cve,2009-0552; classtype:attempted-user; sid:18482; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer document.insertBefore memory corruption attempt"; flow:to_client,established; file_data; content:"document.insertBefore(document"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2011-0036; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-003; classtype:attempted-admin; sid:18404; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Data Source Object memory corruption attempt"; flow:to_client,established; file_data; content:"document.getElementById"; content:"onCellChange"; fast_pattern:only; pcre:"/function\s+([^\s]+)\x28.*?document\x2egetElementById\x28\x22([^\x22]+)\x22\x29\x2einnerHTML=\x22\x22.*?id\s*=\s*\x22\2\x22.*?onCellChange\s*=\s*\x22\1\x28\x29\x3b\x22/smiO"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,46157; reference:cve,2011-0035; reference:url,osvdb.org/show/osvdb/70831; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-003; classtype:attempted-user; sid:18403; rev:16;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Base64 encoded script overflow attempt"; flow:to_client,established; file_data; content:"//|2A|*Start Encode**#@~^"; fast_pattern; nocase; content:!"=="; within:2; distance:6; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2010-0031; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-009; classtype:attempted-admin; sid:18401; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer createTextRange code execution attempt"; flow:to_client,established; file_data; content:"|3C|input type|3D 22|checkbox|22 20|id|3D 27|c|27 3E|"; content:"r|3D|document|2E|getElementById|28 22|c|22 29 3B|"; distance:0; content:"a|3D|r|2E|createTextRange|28 29 3B|"; distance:0; metadata:service http; reference:bugtraq,17196; reference:cve,2006-1359; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-013; classtype:attempted-user; sid:18313; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer frameset memory corruption attempt"; flow:to_client,established; file_data; content:"self.resizeTo|28|2003, 1228|29 3B|"; metadata:service http; reference:bugtraq,18277; reference:cve,2006-3637; classtype:attempted-user; sid:18307; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer span tag memory corruption attempt"; flow:to_client,established; file_data; content:"|26|lt|3B 2F|span|26|gt|3B 0A 26|lt|3B|pre|26|gt|3B|"; content:"|26|lt|3B|colgroup|26|gt|3B 0A 26|lt|3B|small|26|gt|3B 0A 26|lt|3B 2F|small|26|gt|3B 0A 26|lt|3B 2F|colgroup|26|gt|3B|"; distance:0; content:"|26|lt|3B 2F|object|26|gt|3B 0A 26|lt|3B 2F|bdo|0A 26|lt|3B 2F|th|0A 26|lt|3B 2F|object"; distance:0; metadata:service http; reference:cve,2006-1188; classtype:attempted-user; sid:18306; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer span tag memory corruption attempt"; flow:to_client,established; file_data; content:"|26|lt|3B|pre|26|gt|3B 26|lt|3B|td|26|gt|3B|"; content:"|26|lt|3B|menu|26|gt|3B 0A 26|lt|3B|legend|26|gt|3B|"; within:27; distance:1; metadata:service http; reference:cve,2006-1188; classtype:attempted-user; sid:18305; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer span tag memory corruption attempt"; flow:to_client,established; file_data; content:"white|2D|space|3A|normal|3B|"; nocase; pcre:"/pre\s*\x7b\s*white\x2dspace\x3a\s*normal\s*\x3b\s*\x7d/i"; content:"span|20 2F|"; distance:0; nocase; content:"span|20 2F|"; within:14; nocase; pcre:"/(\x26lt\x3b|\x3c)pre(\x26gt\x3b|\x3e)\s*(\x26lt\x3b|\x3c)span\s\x2f(\x26gt\x3b|\x3e)(\x26lt\x3b|\x3c)span\s\x2f(\x26gt\x3b|\x3e)\s*(\x26lt\x3b|\x3c)\x2fpre(\x26gt\x3b|\x3e)/i"; metadata:service http; reference:cve,2006-1188; classtype:attempted-user; sid:18304; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer script action handler overflow attempt"; flow:to_client,established; file_data; content:"for|28|s|3D 27 3C|a|20|onclick|3D 27 2C|i|3D|0|3B|"; content:"document|2E|write|28|s|2B 27 3E 27 29|"; distance:0; content:"s|2B 3D|s|3B|"; distance:0; metadata:service http; reference:bugtraq,17131; reference:cve,2006-1245; classtype:attempted-user; sid:18303; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer FTP command injection attempt"; flow:to_client,established; file_data; content:"ftp|3A 2F 2F|"; fast_pattern:only; pcre:"/ftp\x3A\x2F\x2F[^\s]+?\x250[ad]/i"; metadata:service http; reference:bugtraq,11826; reference:cve,2004-1166; classtype:attempted-user; sid:18300; rev:7;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer implicit drag and drop file installation attempt"; flow:to_client,established; file_data; content:"folder"; nocase; content:"|22|shell|3A|"; distance:0; nocase; pcre:"/folder\s*=\s*\x22shell\x3a/i"; metadata:service http; reference:bugtraq,10973; reference:cve,2004-0839; classtype:attempted-user; sid:18299; rev:7;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer drag-and-drop vulnerability"; flow:to_client,established; file_data; content:"CreateObject|28 22|ADODB.Connection|22 29|"; nocase; content:"dbq=http|3A 2F 2F|"; distance:0; fast_pattern; nocase; metadata:service http; reference:bugtraq,11466; reference:cve,2005-0053; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-008; classtype:attempted-user; sid:18282; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer oversize recordset object cache size exploit attempt"; flow:to_client,established; file_data; content:"recordset"; content:".CacheSize"; within:100; pcre:"/^\s*=\s/R"; byte_test:10,>,0x3ffffffe,0,relative,string; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2010-1117; reference:cve,2010-1118; reference:cve,2010-1259; reference:cve,2010-1262; reference:cve,2011-0027; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-035; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-002; classtype:attempted-user; sid:18280; rev:14;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSS importer use-after-free attempt"; flow:to_client,established; file_data; content:"@|00|i|00|m|00|p|00|o|00|r|00|t|00| |00|"; content:"@|00|i|00|m|00|p|00|o|00|r|00|t|00| |00|"; distance:0; content:"@|00|i|00|m|00|p|00|o|00|r|00|t|00| |00|"; distance:0; pcre:"/\x40\x00i\x00m\x00p\x00o\x00r\x00t\x00 \x00(u\x00r\x00l\x00\x28\x00)?\x22\x00([^\x22]+)\x22\x00(\x29\x00)?\x3B\x00[^\x40]*\x40\x00i\x00m\x00p\x00o\x00r\x00t\x00 \x00(u\x00r\x00l\x00\x28\x00)?\x22\x00\2\x22\x00(\x29\x00)?\x3B\x00[^\x40]*\x40\x00i\x00m\x00p\x00o\x00r\x00t\x00 \x00(u\x00r\x00l\x00\x28\x00)?\x22\x00\2\x22/smi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,45246; reference:cve,2010-3971; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-003; classtype:attempted-user; sid:18240; rev:14;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer malformed table remote code execution attempt"; flow:to_client,established; file_data; content:"position"; content:"absolute"; distance:0; content:"clip:"; pcre:"/table\s*\x7B[^\x7d]*position\x3a\s*absolute[^\x7d]*clip/smi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2010-3962; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-090; classtype:attempted-user; sid:18221; rev:14;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer time element memory corruption attempt"; flow:to_client,established; file_data; content:"timeParent.timeAll.item|28|0|29|"; fast_pattern; nocase; content:"appendChild"; within:200; nocase; content:"removeChild"; within:200; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,45261; reference:cve,2010-3346; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-090; classtype:attempted-user; sid:18218; rev:15;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer select element memory corruption attempt"; flow:to_client,established; file_data; content:"http-equiv="; nocase; content:"X-UA-Compatible"; distance:0; nocase; content:"content="; nocase; content:"IE=8"; distance:0; nocase; content:"createElement"; distance:0; nocase; content:"select"; distance:0; nocase; pcre:"/createElement\s*\x28\s*(?P<a>[\x22\x27])\s*select\s*(?P=a)\s*\x29/i"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,45260; reference:cve,2010-3345; classtype:attempted-user; sid:18217; rev:14;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 6 #default#anim attempt"; flow:to_client,established; file_data; content:"behavior:url('#default#anim')"; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2010-3343; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-090; classtype:attempted-user; sid:18216; rev:14;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSS importer use-after-free attempt"; flow:to_client,established; file_data; content:"@import "; content:"@import "; distance:0; content:"@import "; distance:0; pcre:"/\x40import (url\x28)?\x22([^\x22]+)\x22\x29?\x3B[^\x40]*\x40import (url\x28)?\x22\2\x22\x29?\x3B[^\x40]*\x40import (url\x28)?\x22\2\x22/smi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,45246; reference:cve,2010-3971; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-003; classtype:attempted-user; sid:18196; rev:17;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer cross domain information disclosure attempt"; flow:to_client,established; file_data; content:"|72 65 74 72 20 3D 20 6F 2E 6F 62 6A 65 63 74 2E 64 6F 63 75 6D 65 6E 74 45 6C 65 6D 65 6E 74 2E 69 6E 6E 65 72 48 54 4D 4C|"; content:"|73 65 74 54 69 6D 65 6F 75 74 28 27 72 65 74 72 69 65 76 65 28 29 27 2C 31 29|"; distance:0; metadata:service http; reference:bugtraq,18682; reference:cve,2006-3280; classtype:attempted-user; sid:18194; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer cross domain information disclosure attempt"; flow:to_client,established; file_data; content:"|6F 6E 6C 6F 61 64 3D 22 73 65 74 54 69 6D 65 6F 75 74 28 27 61 6C 65 72 74 28 6F 2E 6F 62 6A 65 63 74 2E 64 6F 63 75 6D 65 6E 74 45 6C 65 6D 65 6E 74 2E 6F 75 74 65 72 48 54 4D 4C 29 27 2C 31 30 30 30 29|"; fast_pattern:only; metadata:service http; reference:bugtraq,18682; reference:cve,2006-3280; classtype:attempted-user; sid:18193; rev:7;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CSS memory corruption attempt"; flow:to_server,established; file_data; content:"<style>"; nocase; content:"@"; distance:0; content:"|2F 2A|"; distance:0; content:!"|2A 2F|"; within:300; metadata:service smtp; reference:bugtraq,10816; reference:cve,2004-0842; classtype:attempted-user; sid:18175; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSS memory corruption attempt"; flow:to_client,established; file_data; content:"<style>"; nocase; content:"@"; distance:0; content:"|2F 2A|"; distance:0; content:!"|2A 2F|"; within:300; metadata:service http; reference:bugtraq,10816; reference:cve,2004-0842; classtype:attempted-user; sid:18174; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 CSS XSRF exploit attempt"; flow:to_client,established; file_data; content:"alert|28|el.currentStyle.fontFamily|29|"; fast_pattern:only; metadata:service http; reference:cve,2010-3325; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-071; classtype:attempted-user; sid:17774; rev:7;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer cross-domain information disclosure attempt"; flow:to_client,established; file_data; content:"var|20|s|20 3D 20|linkEle|2E|styleSheet|2E|cssText"; nocase; metadata:policy max-detect-ips drop, service http; reference:cve,2010-3330; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-071; classtype:attempted-user; sid:17771; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 CSS invalid mapping exploit attempt"; flow:to_client,established; file_data; content:"var x = document.styleSheets|5B 30 5D 3B 0A|"; content:"var s = x.rules.item|28 30 29|.style|3B 0A|"; distance:0; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2010-3328; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-071; classtype:attempted-user; sid:17769; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 object event handler use after free exploit attempt"; flow:to_client,established; file_data; content:"6BF52A52-394A-11d3-B153-00C04F79FAA6"; fast_pattern:only; content:"playStateChange(state)"; nocase; pcre:"/(<\w+\s+id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1).*?(\w+\.getElementById\((?P<m2>\x22|\x27|)(?P=id1)(?P=m2)\)|(?P<elem>\w+)\s*=\s*document\.getElementById\((?P<m3>\x22|\x27|)(?P<id2>.+?)(?P=m3)\).*?(?P=elem)\.(inner|outer)HTML\s*(\+?=)\s*)|\w+\.getElementById\((?P<m5>\x22|\x27|)(?P<id3>.+?)(?P=m5)\).*?<\w+\s+id\s*=\s*(?P<m6>\x22|\x27|)(?P=id3)(?P=m6))/smi"; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-3326; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-071; classtype:attempted-user; sid:17768; rev:14;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 tostaticHTML CSS import vulnerability"; flow:to_client,established; file_data; content:"toStaticHTML"; nocase; content:"@import"; distance:0; nocase; pcre:"/toStaticHTML[^\x7b].*\x7d\s*\x40import/smi"; metadata:policy max-detect-ips drop, service http; reference:cve,2010-3324; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-071; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-072; classtype:attempted-user; sid:17767; rev:15;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 XSS in toStaticHTML API attempt"; flow:to_client,established; file_data; content:"toStaticHTML"; content:"style"; distance:0; pcre:"/toStaticHTML\x28\x22\x3cstyle\x3e\x2a.*\x5bx=(\x27|&39)\x3b/si"; metadata:policy max-detect-ips drop, service http; reference:cve,2010-3243; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-071; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-072; classtype:attempted-user; sid:17766; rev:15;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer compressed HDMX font processing integer overflow attempt"; flow:to_client,established; flowbits:isset,file.eot; file_data; content:"|35 1E 8C F3 EA 69 54 52 D3 04 21 97 B9 56 49 31 28 EA D2 95 1D 8C 6C 5B|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-1883; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-076; classtype:attempted-admin; sid:17747; rev:15;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer EMBED element memory corruption attempt"; flow:to_client,established; file_data; content:"<embed type=|27 22| + asMimeTypes.shift"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:bugtraq,34424; reference:cve,2009-0553; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-014; classtype:attempted-user; sid:17729; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer address bar spoofing attempt"; flow:to_client,established; file_data; content:"win = window.open|28 27|"; nocase; content:".swf|27|"; within:50; nocase; content:"win = window.open|28 27|http|3A 2F 2F|"; within:100; nocase; metadata:policy max-detect-ips drop, service http; reference:bugtraq,17404; reference:cve,2006-1626; classtype:misc-activity; sid:17726; rev:14;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer static text range overflow attempt"; flow:to_client,established; file_data; content:"createTextRange"; content:".text = |27|AAAAAAAAAAAAA"; distance:0; metadata:policy max-detect-ips drop, service http; reference:cve,2008-2255; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-045; classtype:attempted-user; sid:17720; rev:14;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer EMBED element memory corruption attempt"; flow:to_client,established; file_data; content:"function|20|open|5F|win|28 29|"; content:"document|2E|body|2E|innerHTML|20 3D|"; distance:0; content:"|22 3C|embed|20|type|3D 27|audio|2F|midi|27 3E|"; distance:0; content:"setInterval|28 27|open|5F|win|28 29 27 2C 20|1|29 3B|"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,34424; reference:cve,2009-0553; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-014; classtype:attempted-user; sid:17709; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer popup title bar spoofing attempt"; flow:to_client,established; file_data; content:"window.open|28|"; nocase; content:"authentication.trusted.com"; distance:0; nocase; metadata:policy max-detect-ips drop, service http; reference:bugtraq,12602; reference:cve,2005-0500; classtype:misc-activity; sid:17703; rev:13;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer ExecWB security zone bypass attempt"; flow:to_client,established; file_data; content:"ExecWB"; nocase; pcre:"/ExecWB\s*\x28\s*[^\x2c\x29]*(7|IDM_PRINTPREVIEW)[^\x29]+http\x3a\x2f\x2f/smi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,30612; reference:cve,2008-2259; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-045; classtype:attempted-user; sid:17692; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer userdata behavior memory corruption attempt"; flow:to_client,established; file_data; content:"|7B|behavior"; nocase; content:"url|28 23|default|23|userData|29|"; distance:0; nocase; content:"setAttribute"; pcre:"/(?P<class>[A-Z\d_]+)\s*\x7Bbehavior\s*\x3a\s*url\x28\x23default\x23userData\x29.*?(?P<obj>[A-Z\d_]+)\x2EsetAttribute\x28[^,]+,\s*[A-Z]\x29.*?\x3cMARQUEE\s*id\x3d\x22(?P=obj)\x22\s*class\x3d\x22(?P=class)/smi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2010-0806; reference:url,support.microsoft.com/kb/980182; classtype:attempted-user; sid:17689; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer userdata behavior memory corruption attempt"; flow:to_client,established; file_data; content:"|3C|script|3E|"; nocase; content:"|2E|style|2E|behavior"; nocase; content:"|23|default|23|userData"; distance:0; nocase; content:"setAttribute|28|"; pcre:"/(?P<obj>[A-Z\d_]+)\x2Estyle\x2Ebehavior\s*\x3D\s*\x22url\x28\x27\x23default\x23userData\x27\x29\x22.*?(?P=obj)\x2EsetAttribute\x28[^,]+,\s*[A-Z]/smi"; content:"|3C 2F|script|3E|"; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,38615; reference:cve,2010-0806; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-018; classtype:attempted-user; sid:17688; rev:13;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer invalid pointer memory corruption attempt"; flow:to_client,established; file_data; content:"|2E|test|20 7B|behavior|3A 20|url|28 23|default|23|userData|29|"; nocase; content:"|39 39 5C 78 39 35 5C 78 39 62 5C 78 63 63 5C 78|"; distance:0; content:"|39 64 5C 78 63 39 5C 78 38 38 5C 78 64 38 5C 78 39 65 5C 78 39 64 5C 78 39 35 5C 78 39 64 5C 78|"; distance:0; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2010-0806; reference:url,technet.microsoft.com/en-us/security/bulletin/ms10-018; classtype:attempted-user; sid:17687; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer invalid pointer memory corruption attempt"; flow:to_client,established; file_data; content:"|2E|test|20 7B|behavior|3A 20|url|28 23|default|23|userData|29|"; nocase; content:"|61 66 5C 78 61 63 5C 78 62 64 5C 78 65 64 5C 78|"; distance:0; content:"|62 64 5C 78 65 64 5C 78 61 65 5C 78 66 39 5C 78 61 62 5C 78 61 63 5C 78 62 64 5C 78 65 64 5C 78|"; distance:0; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2010-0806; reference:url,technet.microsoft.com/en-us/security/bulletin/ms10-018; classtype:attempted-user; sid:17686; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer invalid pointer memory corruption attempt"; flow:to_client,established; file_data; content:"setAttribute"; content:"document.location"; distance:0; content:"about|3A 5C|u0c0c|5C|u0c0c|5C|u0c0c|5C|u0c0cblank|22|"; within:40; content:"<marquee"; distance:0; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2010-0806; reference:url,technet.microsoft.com/en-us/security/bulletin/ms10-018; classtype:attempted-user; sid:17685; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSS strings parsing memory corruption attempt"; flow:to_client,established; file_data; content:"text-decoration"; nocase; pcre:"/\x2E[A-Z\d_]+\s*\x7b\s*text-decoration[^\x3A]*?\x7d/smi"; metadata:policy max-detect-ips drop, service http; reference:cve,2007-0943; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-045; classtype:attempted-user; sid:17645; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer object clone deletion memory corruption attempt"; flow:to_client,established; file_data; content:"var nopsled"; nocase; content:"cloneNode|28 29|"; distance:0; nocase; metadata:service http; reference:cve,2009-0075; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-002; classtype:attempted-user; sid:17644; rev:7;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer object reference memory corruption attempt"; flow:to_client,established; file_data; content:"obj|2E|setExpression|28 22|width"; fast_pattern; nocase; content:"|22 2C 22|document|2E|body|2E|offsetWidth|22 29|"; within:30; metadata:policy max-detect-ips drop, service http; reference:cve,2007-3902; reference:url,www.securityfocus.com/bid/26506; classtype:attempted-user; sid:17622; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer possible javascript onunload event memory corruption"; flow:to_client,established; file_data; content:"document.write("; content:"body|20|onunload=|22|exploit"; distance:0; nocase; metadata:policy max-detect-ips drop, service http; reference:bugtraq,22678; reference:cve,2007-1094; classtype:attempted-user; sid:17585; rev:14;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer span tag memory corruption attempt"; flow:to_client, established; file_data; content:"<pre>|0A 09 09|<span style=|22|white-space|3A|normal|3B 22 2F|><span>"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:bugtraq,17468; reference:cve,2006-1188; classtype:attempted-user; sid:17580; rev:13;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer event handler memory corruption attempt"; flow:to_client,established; file_data; content:"activate = function ()"; fast_pattern:only; pcre:"/on(before|de)activate\s*\x3d\s*function\s*\x28\x29\s*\x7b\s*call(back|malFunc)\x28\x29/i"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,35224; reference:cve,2009-1530; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-019; classtype:attempted-user; sid:17566; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer DOM object cache management memory corruption attempt"; flow:to_client,established; file_data; content:"getElementsByTagName"; nocase; content:"removeNode|28|true|29|"; distance:0; fast_pattern; nocase; pcre:"/\x2EgetElementsByTagName\x28[^\x29]+?\x2EremoveNode\x28true\x29/smi"; metadata:service http; reference:bugtraq,26817; reference:cve,2007-5344; classtype:attempted-user; sid:17554; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Error Handling Code Execution"; flow:to_client,established; file_data; content:"for"; nocase; content:"i=0|3B| i<20|3B| i++"; within:30; content:"document.location.href=fileURL"; within:50; metadata:service http; reference:bugtraq,25916; reference:cve,2007-3892; classtype:attempted-admin; sid:17549; rev:7;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Script Action Handler buffer overflow attempt"; flow:to_client,established; file_data; content:"<"; content:"onmousedown"; within:24; nocase; pcre:"/[^>]\w*\s*(on(mouse(over|up|down)|load|click)=([^\n\s>]|\(|\))*\s*){21}/Rmi"; metadata:service http; reference:bugtraq,17131; reference:cve,2006-1245; classtype:attempted-user; sid:17516; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Script Action Handler buffer overflow attempt"; flow:to_client,established; file_data; content:"<"; content:"onload"; within:19; nocase; pcre:"/[^>]\w*\s*(on(mouse(over|up|down)|load|click)=([^\n\s>]|\(|\))*\s*){21}/Rmi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,17131; reference:cve,2006-1245; classtype:attempted-user; sid:17515; rev:13;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Script Action Handler buffer overflow attempt"; flow:to_client,established; file_data; content:"<"; content:"onmouseup"; within:22; nocase; pcre:"/[^>]\w*\s*(on(mouse(over|up|down)|load|click)=([^\n\s>]|\(|\))*\s*){21}/Rmi"; metadata:service http; reference:bugtraq,17131; reference:cve,2006-1245; classtype:attempted-user; sid:17514; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Script Action Handler buffer overflow attempt"; flow:to_client,established; file_data; content:"<"; content:"onclick"; within:20; nocase; pcre:"/[^>]\w*\s*(on(mouse(over|up|down)|load|click)=([^\n\s>]|\(|\))*\s*){21}/Rmi"; metadata:service http; reference:bugtraq,17131; reference:cve,2006-1245; classtype:attempted-user; sid:17513; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Script Action Handler buffer overflow attempt"; flow:to_client,established; file_data; content:"<"; content:"onmouseover"; within:24; nocase; pcre:"/[^>]\w*\s*(on(mouse(over|up|down)|load|click)=([^\n\s>)]|\(|\))*\s*){21}/Rmi"; metadata:service http; reference:bugtraq,17131; reference:cve,2006-1245; classtype:attempted-user; sid:17512; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Long URL Buffer Overflow attempt"; flow:to_client,established; content:"Location|3A|"; nocase; http_header; isdataat:600,relative; pcre:"/Location\x3A\s+[^\r\n]{600}/Hi"; metadata:service http; reference:bugtraq,19667; reference:cve,2006-3869; classtype:attempted-user; sid:17494; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Script Engine Stack Exhaustion Denial of Service attempt"; flow:to_client,established; file_data; content:"<script"; nocase; content:"javascript"; distance:0; nocase; content:"location="; distance:0; nocase; pcre:"/javascript.+?function\s+(\w+)\s*\(\w*\)\s*\{.+?location=[^}]+\1\(.+?\}/smi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,16687; reference:cve,2006-0753; classtype:attempted-dos; sid:17487; rev:14;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer File Download Dialog Box Manipulation"; flow:to_client,established; content:"spoffset()|20|{|0A 20 20 20 20 20 20|"; nocase; content:"var|20|mv|20|=|20|window|2E|navi"; within:20; nocase; content:"var|20|sp2"; within:7; distance:29; nocase; metadata:policy max-detect-ips drop, service http; reference:bugtraq,15823; reference:cve,2005-2829; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-054; classtype:attempted-user; sid:17463; rev:13;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer marquee object handling memory corruption attempt"; flow:to_client,established; file_data; content:"MARQUEE"; nocase; content:"onstart"; distance:0; nocase; pcre:"/\x3c\s*Marquee[^\x3e]*onstart\s*\x3D\s*\x22\s*document\x2e(write|writeln|open)/smi"; metadata:policy max-detect-ips drop, service http; reference:cve,2009-0554; reference:url,technet.microsoft.com/en-us/security/bulletin/ms09-014; classtype:attempted-user; sid:17462; rev:13;)
# alert tcp $HOME_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"BROWSER-IE Microsoft Internet Explorer HTTPS proxy information disclosure vulnerability"; flow:to_server,established; content:"|2F|accounts|2F|ServiceLogin|3F|service|3D|mail|26|passive|3D|true|26|rm|3D|false|26|continue|3D|http"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http; reference:cve,2005-2830; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-054; classtype:misc-attack; sid:17448; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"BROWSER-IE Microsoft Internet Explorer FTP client directory traversal attempt"; flow:to_server,established; content:"RETR|20 2F 2E 2E 2F 2E 2E 2F 2E 2E 2F 74 65 73 74 2F 70 6F 63 2E 61 61 61|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp; reference:cve,2004-1376; classtype:misc-activity; sid:17446; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CDF cross-domain scripting attempt"; flow:to_client,established; file_data; content:"|3C|channel|20 0D 0A 20 20|href|3D 22|file|3A 2F 2F|"; nocase; metadata:policy max-detect-ips drop, service http; reference:bugtraq,12427; reference:cve,2005-0056; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-014; classtype:attempted-user; sid:17411; rev:13;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer nested tag memory corruption attempt"; flow:to_client,established; file_data; content:"adong7"; nocase; content:"adong7"; distance:0; nocase; content:"datasrc"; distance:0; nocase; content:"datafld"; nocase; metadata:policy max-detect-ips drop, service http; reference:bugtraq,32721; reference:cve,2008-4844; reference:url,technet.microsoft.com/en-us/security/bulletin/ms08-078; classtype:attempted-user; sid:17402; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer nested tag memory corruption attempt - unescaped"; flow:to_client,established; file_data; content:"%53%52%43%3d%5c%5c%26%23"; nocase; metadata:policy max-detect-ips drop, service http; reference:bugtraq,32721; reference:cve,2008-4844; reference:url,technet.microsoft.com/en-us/security/bulletin/ms08-078; classtype:attempted-user; sid:17401; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer setRequestHeader overflow attempt"; flow:to_client,established; file_data; content:"XMLHttpRequest"; nocase; content:"setRequestHeader"; distance:0; nocase; pcre:"/setRequestHeader\x28[^\x29]*(Host|Referer|Content-Length).*?String\.fromCharCode\x28/smi"; byte_test:3,>,160,0,relative,string; metadata:service http; reference:bugtraq,28379; reference:cve,2008-1544; classtype:attempted-user; sid:17385; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer setRequestHeader overflow attempt"; flow:to_client,established; file_data; content:"XMLHttpRequest"; nocase; content:"setRequestHeader"; distance:0; nocase; pcre:"/setRequestHeader\x28[^\x29]*(Host|Referer|Content-Length)[\x22\x27][^\x2c]*[\xA0-\xFF]/smi"; metadata:service http; reference:bugtraq,28379; reference:cve,2008-1544; classtype:attempted-user; sid:17384; rev:5;)
# alert tcp $EXTERNAL_NET 21 -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer FTP Response Parsing Memory Corruption"; flow:to_client,established; isdataat:1023; pcre:"/\d{3}\s+[^\n]{1019}/smi"; metadata:service ftp; reference:bugtraq,22489; reference:cve,2007-0217; classtype:web-application-attack; sid:17367; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSS import cross-domain restriction bypass attempt"; flow:to_client,established; file_data; content:"|3C|style"; nocase; content:"@import url|28 22|http|3A 2F 2F|search|2E|msn|2E|com|2F|results|2E|aspx|3F|q|3D 25|7D|25|7B|22 29|"; distance:0; nocase; metadata:policy max-detect-ips drop, service http; reference:bugtraq,15660; reference:cve,2005-4089; classtype:attempted-user; sid:17312; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSS import cross-domain restriction bypass attempt"; flow:to_client,established; file_data; content:"|3C|style"; nocase; content:"@import url|28 22|http|3A 2F 2F|news|2E|google|2E|com|2F|news|3F|hl|3D|en|26|ned|3D|us|26|q|3D 25|7D|25|7B|22 29|"; distance:0; nocase; metadata:service http; reference:bugtraq,15660; reference:cve,2005-4089; classtype:attempted-user; sid:17311; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer clone object memory corruption attempt"; flow:to_client,established; file_data; content:"document|2E|createElement"; nocase; content:"|2E|cloneNode()"; within:100; fast_pattern; content:"CollectGarbage()"; within:100; content:"|2E|cloneNode()"; within:100; metadata:policy max-detect-ips drop, service http; reference:bugtraq,26816; reference:cve,2007-3903; classtype:attempted-user; sid:17303; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer createTextRange code execution attempt"; flow:to_client,established; file_data; content:".createTextRange|28 29 09 0A 0D 09 20 0A 20 0A 20 0D|"; fast_pattern:only; metadata:service http; reference:bugtraq,17196; reference:cve,2006-1359; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-013; classtype:attempted-user; sid:17263; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer createTextRange code execution attempt"; flow:to_client,established; file_data; content:".createTextRange|28 29 3B|"; fast_pattern:only; content:"<input type|3D 22|radio|22|"; nocase; pcre:"/\x3Cinput\s+type\x3D\x22radio\x22\s+id\x3D(?P<q1>(\x22|\x27|))(?P<t>\S+)(?P=q1).*?document\x2EgetElementById\x28(?P<q2>(\x22|\x27|))(?P=t)(?P=q2)\x29\x2EcreateTextRange/isO"; metadata:service http; reference:bugtraq,17196; reference:cve,2006-1359; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-013; classtype:attempted-user; sid:17262; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer createTextRange code execution attempt"; flow:to_client,established; file_data; content:".createTextRange|28 29 3B|"; fast_pattern:only; content:"<input type|3D 22|checkbox|22|"; nocase; pcre:"/\x3Cinput\s+type\x3D\x22checkbox\x22\s+id\x3D(?P<q1>(\x22|\x27|))(?P<t>\S+)(?P=q1).*?document\x2EgetElementById\x28(?P<q2>(\x22|\x27|))(?P=t)(?P=q2)\x29\x2EcreateTextRange/isO"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,17196; reference:cve,2006-1359; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-013; classtype:attempted-user; sid:17261; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 6 race condition exploit attempt"; flow:to_client,established; file_data; content:"|3C|meta http-equiv|3D 22|refresh|22| content|3D 22|01|22 2F 3E|"; content:"|3C|iframe src|3D 22|iframepoc.html|22 3E 3C 2F|iframe|3E|"; distance:0; metadata:policy security-ips drop, service http; reference:cve,2010-2558; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-053; classtype:attempted-user; sid:17136; rev:7;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer invalid object access attempt"; flow:to_client,established; file_data; content:"<thead>"; nocase; content:"<th id|3D|"; within:50; nocase; content:".colSpan=|22|500|22 3B|"; within:100; nocase; content:"</table>"; within:50; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2010-2560; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-053; classtype:attempted-user; sid:17132; rev:17;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 parent style rendering arbitrary code execution"; flow:to_client,established; file_data; content:"parentNode.style."; content:".focus"; within:100; pcre:"/(^|[^\w])(?P<obj>\w+)\.parentNode\.style\.[^\s]+\s*[^!]=.*?(?P=obj)\.focus/smi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2010-2559; reference:url,technet.microsoft.com/en-us/security/bulletin/ms10-053; classtype:attempted-user; sid:17131; rev:20;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer boundElements arbitrary code execution"; flow:to_client,established; file_data; content:"event.boundElements"; fast_pattern:only; content:"window.close"; pcre:"/on(load|click)\s*=\s*\x22?window\.close\s*\x28/si"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,42288; reference:cve,2010-2557; reference:url,technet.microsoft.com/en-us/security/bulletin/ms10-053; classtype:attempted-user; sid:17130; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer use-after-free memory corruption attempt"; flow:to_client,established; file_data; content:"<script>"; nocase; content:"function"; distance:0; nocase; content:"()"; within:30; content:"location."; fast_pattern:only; pcre:"/function\s+?\w+\s*?\x28[^\x7b]+?\x7b[^\x7d]*?location\.(protocol|href)\s*?=\s*?[\x22\x27]\s*?(mailto|http|file).*?[\x22\x27]/smi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,42257; reference:cve,2010-2556; reference:url,osvdb.org/show/osvdb/66999; reference:url,technet.microsoft.com/en-us/security/bulletin/ms10-053; classtype:attempted-dos; sid:17129; rev:22;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer createTextRange code execution attempt"; flow:to_client,established; file_data; content:"innerHTML"; content:".createTextRange|28 29|"; fast_pattern:only; pcre:"/input.*?type.*?[\x22\x27]\s*?(radio|image|checkbox)\s*?[\x22\x27].*?\x2EcreateTextRange\s*?\x28\x29/smi"; metadata:service http; reference:bugtraq,17196; reference:cve,2006-1359; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-013; classtype:attempted-user; sid:16690; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer style sheet array memory corruption attempt"; flow:to_client,established; file_data; content:"document.styleSheets|5B|"; fast_pattern; nocase; content:"|5D|.imports"; within:10; nocase; content:".appendChild|28|"; within:40; nocase; content:".removeChild|28|"; within:40; nocase; content:"outerHTML"; within:40; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,40410; reference:cve,2010-1117; reference:cve,2010-1118; reference:cve,2010-1259; reference:cve,2010-1262; reference:cve,2011-0027; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-035; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-002; classtype:attempted-user; sid:16659; rev:16;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer security zone restriction bypass attempt"; flow:to_client,established; file_data; content:"|2F|test|2F|setScript|2E|htm|5C 3F 5C 3C|script language|3D 5C 27|vbscript|5C 27| src|3D 5C 27|http|3A 2F 2F 3C|server|3E 2F|test|2F|test|2E|vbs|5C 27 5C 3E|"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:cve,2010-0255; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-035; classtype:attempted-user; sid:16637; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer nested SPAN tag memory corruption attempt"; flow:to_client,established; file_data; content:"%3c%53%50%41%4e%20%44%41%54%41%53%52%43%3d%23%49%20%44%41%54%41%46%4c%44%3d%43%20%44%41%54%41%46%4f%52%4d%41%54%41%53%3d%48%54%4d%4c%3e"; fast_pattern:only; content:"%3c%53%50%41%4e%20%44%41%54%41%53%52%43%3d%23%49%20%44%41%54%41%46%4c%44%3d%43%20%44%41%54%41%46%4f%52%4d%41%54%41%53%3d%54%45%58%54%3e"; nocase; metadata:policy max-detect-ips drop, service http; reference:bugtraq,32721; reference:cve,2008-4844; classtype:attempted-user; sid:16605; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Oracle Java Web Start arbitrary command execution attempt - Internet Explorer"; flow:to_client,established; file_data; content:"8AD9C840-044E-11D1-B3E9-00805F499D93"; fast_pattern:only; content:"-XXaltjvm"; content:"launchjnlp"; nocase; metadata:policy security-ips drop, service http; reference:bugtraq,39346; reference:cve,2010-0886; reference:cve,2010-1423; classtype:attempted-user; sid:16584; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer malformed span/div html document heap corruption attempt"; flow:to_client,established; file_data; content:"position|3A|absolute"; nocase; content:"position|3A|relative"; nocase; content:"<div>"; nocase; content:"<span>"; nocase; pcre:"/(<div><\/span>|<span><\/div>)/smi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2010-0807; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-018; classtype:attempted-user; sid:16512; rev:15;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 non-IE8 compatibility mode htmltime remote code execution attempt"; flow:to_client,established; file_data; content:"meta http-equiv=|22|X-UA-Compatible|22| content=|22|IE=7|22|"; nocase; content:"TIMEACTION"; nocase; pcre:"/BEGIN=[^>]+DUR=[^>]+TIMEACTION/i"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2010-0492; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-018; classtype:attempted-user; sid:16508; rev:14;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer onreadystatechange memory corruption attempt"; flow:to_client,established; file_data; content:"onreadystatechange"; nocase; pcre:"/(?P<obj>[A-Z\d_]+)\.innerHTML\s*=\s*(\x22[^\x22]*<[A-Z]+\s+[^>]*onreadystatechange\s*=|\x27[^\x27]*<[A-Z]+\s+[^>]*onreadystatechange\s*=).*?(?P=obj)\.innerHTML\s*=\s*(\x22\x22|\x27\x27)/smi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2010-0491; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-018; classtype:attempted-user; sid:16507; rev:14;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer innerHTML against incomplete element heap corruption attempt"; flow:to_client,established; file_data; content:".innerHTML"; fast_pattern:only; content:"<script"; nocase; pcre:"/<(?P<elem>\w+)\s[^>]*?(id|name)=\s*?(?P<q1>\x22|\x27|)\s*?(?P<id1>\w+)\s*?(?P=q1)[^>]*?(?<!\x2f)>(?!.*?<\x2f(?P=elem)>).*?<script(?=.*?(?P=id1)\.innerHTML(\x2b{2}|\s*?=\s*?(\x22|\x27){2}))/smi"; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,39031; reference:cve,2010-0490; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-018; classtype:attempted-user; sid:16506; rev:19;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer event handling remote code execution attempt"; flow:to_client,established; file_data; content:"|22|mouseleave|22|"; fast_pattern; nocase; content:"window.event.type"; within:30; nocase; pcre:"/\x22mouseleave\x22\s*\x3D\x3D\s*window\x2Eevent\x2Etype\x29[^\x7D]*\x2EparentNode\x2EinnerHTML\s*\x3D\s*\x22/smi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2010-0267; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-018; classtype:attempted-user; sid:16503; rev:14;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer userdata behavior memory corruption attempt"; flow:to_client,established; file_data; content:"|3C|script"; nocase; content:"addBehavior|28|"; nocase; content:"|23|default|23|userData"; within:30; nocase; content:"setAttribute|28|"; distance:0; nocase; pcre:"/(?P<obj>[A-Z\d_]+)\.addBehavior\x28(?P<q1>\x22|\x27|)[^\x29]*\x23default\x23userData(?P=q1)\x29.*?(?P=obj)\.setAttribute\x28[^,]+,\s*[A-Z]/smi"; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,38615; reference:cve,2010-0806; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-018; classtype:attempted-user; sid:16482; rev:15;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer .hlp samba share download attempt"; flow:to_client,established; file_data; content:"vbscript"; nocase; content:".hlp"; nocase; content:"|5C|"; pcre:"/\\\\[^\x20\x0a\x0d]*\.hlp/smi"; metadata:policy max-detect-ips drop, service http; reference:cve,2010-0483; classtype:attempted-user; sid:16452; rev:13;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 7/8 execute local file in Internet zone redirect attempt"; flow:to_client,established; content:"|0A|Location|3A|"; nocase; http_header; content:"file|3A|//127.0.0.1"; distance:0; fast_pattern; http_header; pcre:"/^Location\x3a[^\n]*file\x3a\x2f\x2f127\x2e0\x2e0\x2e1/Hmi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2010-0255; reference:cve,2010-0555; reference:url,technet.microsoft.com/en-us/security/advisory/980088; classtype:attempted-user; sid:16423; rev:13;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer HTML+TIME animatemotion property memory corruption attempt"; flow:to_client,established; file_data; content:"ANIMATEMOTION"; nocase; pcre:"/<[A-Z_]+\s*\x3A\s*ANIMATEMOTION[^>]+?id=(?P<q>\x22|\x27|)(?P<n>[A-Z][A-Z\d\x2D\x2E\x3A\x5F]*)(?P=q).*?(?P=n)\./Osmi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,27666; reference:cve,2008-0077; reference:url,technet.microsoft.com/en-us/security/bulletin/ms08-010; classtype:attempted-user; sid:16382; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted object cells reference memory corruption vulnerability"; flow:to_client,established; file_data; content:"outerText"; nocase; content:"cells.item"; distance:0; nocase; pcre:"/([A-Z0-9_]+)\.outerText.*?\1\.cells\.item/smi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2010-0248; classtype:attempted-user; sid:16378; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer DOM mergeAttributes memory corruption attempt"; flow:to_client,established; file_data; content:".mergeAttributes|28|"; fast_pattern:only; pcre:"/(\w+)\x2emergeAttributes\x28\1\x29\x3b/"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,37893; reference:cve,2010-0247; reference:cve,2011-0094; reference:url,osvdb.org/show/osvdb/61913; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-002; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-018; classtype:misc-activity; sid:16377; rev:15;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTableLayout memory corruption attempt"; flow:to_client,established; file_data; content:"document.getElement"; nocase; content:".onpropertychange"; within:75; fast_pattern; nocase; content:"function"; within:75; nocase; content:"<table"; distance:0; nocase; content:"<col"; within:75; nocase; pcre:"/\x2eonpropertychange\s*=\s*function\s*\x28\s*\x29\s*\x7b[^\x7d]+?\x2e(inner|outer)HTML(\s*=\s*[\x22\x27]\s*[\x22\x27]|\x2b\x2b)/smi"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,37891; reference:cve,2010-0244; reference:url,osvdb.org/show/osvdb/61910; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-002; classtype:attempted-user; sid:16376; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted object access memory corruption attempt - public exploit"; flow:to_client,established; file_data; content:"100 112 99 118 109 102 110 117 46 100 114 102 97 117 101 70 118 102 110 117 79 99 106 102 99 117 40 102 118 117 41 60 32 101 111 100 117 110 101 111 116 47 103 102 116 70 108 102 109 102 110 117 66 122 73 101 40 35 115 113 49 35 41 47 105 111 110 102 114 73 84 78 76 62 34 35 59 120 105 111 100 112 119 47 115 102 116 74 110 117 101 115 118 98 108"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2010-0249; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-002; classtype:attempted-user; sid:16369; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer invalid object access memory corruption attempt"; flow:to_client,established; file_data; content:"createEventObject"; content:"innerHTML"; distance:0; pcre:"/createEventObject[^\x7D]+innerHTML\s*\x3D\s*\S+[^\x7D]+(setTimeout|setInterval)/"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2010-0249; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-002; classtype:attempted-user; sid:16367; rev:15;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer object clone deletion memory corruption attempt - obfuscated"; flow:to_client,established; dsize:<2056; file_data; content:"CollectGarbage"; fast_pattern:only; content:"createElement"; nocase; content:"cloneNode"; within:128; nocase; content:"clearAttributes"; within:128; nocase; metadata:policy max-detect-ips drop, service http; reference:cve,2009-0075; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-002; classtype:attempted-user; sid:16339; rev:13;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer orphan DOM objects memory corruption attempt"; flow:to_client,established; file_data; content:"createElement"; nocase; content:"appendChild"; within:50; nocase; content:"innerHTML"; within:100; nocase; pcre:"/(?P<first>\S+)\x2EappendChild\x28\s*(?P<second>\S+)\s*\x29.*(?P=second)\x2E\S+\s*\x3D\s*(?P=first)\x2E\S+/is"; pcre:"/(\S+)\x2EappendChild[^\x7D]+\1\x2EinnerHTML\s*\x3D\s*\x27{2}/i"; metadata:service http; reference:cve,2009-3674; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-072; classtype:attempted-user; sid:16330; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 DOM memory corruption attempt"; flow:to_client,established; file_data; content:"http-equiv=|22|X-UA-Compatible|22|"; fast_pattern:only; content:"content|3D 22|IE|3D|8|22|"; nocase; pcre:"/var\s*(?P<element>\w*?)\s*\x3D\s*document\x2EgetElementById.*?(?P=element)\x2EparentNode\x2EremoveChild\x28(?P=element)\x29/smi"; metadata:policy security-ips drop, service http; reference:cve,2009-3671; reference:cve,2010-0245; reference:cve,2010-0246; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-072; classtype:attempted-user; sid:16326; rev:9;)
# alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"BROWSER-IE Apple Safari-Internet Explorer SearchPath blended threat attempt"; flow:to_client,established; flowbits:isset,safari.dll; file_data; content:"MZ|90 00|"; byte_jump:4,56,relative,little; content:"PE|00 00|"; within:4; distance:-64; metadata:policy max-detect-ips drop, service http; reference:bugtraq,29445; reference:cve,2008-2540; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-015; classtype:attempted-user; sid:16319; rev:14;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer mouse move during refresh memory corruption attempt"; flow:to_client,established; file_data; content:"protected void Page_Load|28|object sender, EventArgs e|29|"; content:"StreamReader sr = File.OpenText|28|Server.MapPath|28 22|default.html|22 29 29|"; metadata:service http; reference:cve,2009-3673; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-072; classtype:attempted-user; sid:16317; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 6/7 single line outerHTML invalid reference arbitrary code execution attempt"; flow:to_client,established; file_data; content:"document.getElementsByTagName|28|'STYLE'|29|[0].outerHTML"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,37085; reference:cve,2009-3672; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-072; classtype:attempted-user; sid:16311; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 6/7 outerHTML invalid reference arbitrary code execution attempt"; flow:to_client,established; file_data; content:"getElement"; nocase; content:"outerHTML"; nocase; content:"overflow"; fast_pattern; nocase; pcre:"/([^\s]+)\s*=\s*document\.getElement\w+\s*\x28\s*([\x22\x27])STYLE\2.*\1\.outerHTML/si"; pcre:"/\x7b[^\x7d]*(overflow[^\x7d]*margin\s*\x3a\s*0\s*\x3b|margin\s*\x3a\s*0\s*\x3b[^\x7d]*overflow)/si"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,37085; reference:cve,2009-3672; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-072; classtype:attempted-user; sid:16310; rev:17;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer HTML DOM invalid DHTML textnode creation attempt"; flow:to_client,established; file_data; content:"document.location.href"; fast_pattern:only; content:".createTextNode("; pcre:"/(?P<obj1>\w+)\s*?=\s*?\w+\.createTextNode\((\x22{2}|\x27{2}|[A-z]\w*)\)\s*?\; .*?\w+\.(insertBefore|insertAfter|appendChild)\((?P=obj1)\)\; |\w+\.(insertBefore|insertAfter|appendChild)\(\w+\.createTextNode\((\x22{2}|\x27{2}|[A-z]\w*)\)/s"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,13120; reference:cve,2005-0553; reference:nessus,10861; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-020; classtype:attempted-user; sid:16301; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer HTML DOM invalid DHTML comment creation attempt"; flow:to_client,established; file_data; content:"document.location.href"; fast_pattern:only; content:".createComment("; pcre:"/(?P<obj1>\w+)\s*?=\s*?\w+\.createComment\((\x22{2}|\x27{2}|[A-z]\w*)\)\s*?\; .*?\w+\.(insertBefore|insertAfter|appendChild)\((?P=obj1)\)\; |\w+\.(insertBefore|insertAfter|appendChild)\(\w+\.createComment\((\x22{2}|\x27{2}|[A-z]\w*)\)/s"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,13120; reference:cve,2005-0553; reference:nessus,10861; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-020; classtype:attempted-user; sid:16300; rev:13;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer dynamic style update memory corruption attempt"; flow:to_client,established; file_data; content:"strict.dtd"; nocase; content:"<code"; nocase; content:"<textarea"; within:50; fast_pattern; nocase; content:"</textarea"; within:100; nocase; content:".getElementByID"; distance:0; nocase; content:".className"; within:50; nocase; pcre:"/<code\s[^>]*?id\s*?=\s*?[\x22\x27]?(?P<id>\w+)[\x22\x27]?[^>]*?>[\r\n\s]+<textarea.*?\.(?P<class>\w+)[\r\n\s]*?\{[\r\n\s]*?zoom\x3a\s*?\d+px\x3b.*?document\.getElementById\s*?\(\s*?[\x22\x27]?(?P=id).*?\.className\s*?=\s*?[\x22\x27]?(?P=class)/si"; metadata:policy max-detect-ips drop, service http; reference:cve,2009-0076; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-002; classtype:attempted-user; sid:16169; rev:15;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer indexing service malformed parameters"; flow:to_client,established; file_data; content:"SetQueryFromURL"; nocase; content:"%%"; within:100; pcre:"/SetQueryFromURL\((?P<q1>\x22|\x27|)[^\)]*\x25{2,}[^\)]*(?P=q1)\)/smi"; metadata:service http; reference:cve,2009-2507; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-057; classtype:attempted-user; sid:16155; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer table layout unitialized or deleted object access attempt"; flow:to_client,established; file_data; content:"<span style=|22|position|3A| absolute|3B|writing-mode|3A| bt-rl|22|>"; nocase; content:"<table style=|22|float|3A|left|3B 22|>"; within:60; nocase; content:"</table>"; within:20; nocase; content:"</span>"; within:40; nocase; metadata:service http; reference:cve,2009-2531; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-054; classtype:misc-activity; sid:16152; rev:7;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer unitialized or deleted object access attempt"; flow:to_client,established; file_data; content:"createEventObject"; fast_pattern:only; pcre:"/(\w+)\s*\x3D\s*\w+\x2EcreateEventObject.*\1\x2E(Type|PropertyName|Qualifier|SrcUrn).*\x2EcreateEventObject\s*\x28\s*\1\s*\x29/smi"; metadata:service http; reference:cve,2009-2530; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-054; classtype:misc-activity; sid:16151; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer data stream header remote code execution attempt"; flow:to_client,established; content:"Content-Encoding|3A|deflate"; nocase; content:"|5C|Content-Range|3A 0D 0A 0D 0A 0D 0A 09| |09 09| |09| |09 09 09 09 09| |09 09| |09| |09 09| |09 09| |09 09 09| |09| |09| |09| |09| |09 09 09| |09 09| |09| |09 09 09| |09| |09| |09| |09 09 09 09 09 09| |09 09| |09|"; fast_pattern:only; metadata:service http; reference:cve,2009-1547; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-054; classtype:attempted-user; sid:16149; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer DOM object cache management memory corruption attempt"; flow:to_client,established; file_data; content:"removeNode"; fast_pattern:only; pcre:"/(\w+)\x2EremoveNode\s*\x28true\x29.*\1\x2EremoveNode\s*\x28\x29.*\1\x2E[^r]+/smi"; metadata:policy max-detect-ips drop, service http; reference:cve,2007-5344; classtype:attempted-user; sid:16067; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer location.replace memory corruption attempt"; flow:to_client,established; file_data; content:"execScript|28|'function f|28 29|{location.replace|28 22|about|3A|blank|22 29 3B|}|3B|setTimeout|28 22|f|28 29 22|,5|29 3B|"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:bugtraq,26427; reference:cve,2007-5347; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-069; classtype:attempted-user; sid:16065; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer onBeforeUnload address bar spoofing attempt"; flow:to_client,established; file_data; content:"opener.document.body.onbeforeunload=|22 22|"; nocase; content:"<body onBeforeUnload='spoofed=1'"; distance:0; nocase; metadata:policy max-detect-ips drop, service http; reference:bugtraq,24911; reference:cve,2007-3826; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-057; classtype:misc-activity; sid:16064; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer isindex buffer overflow attempt"; flow:to_client,established; file_data; content:"<style>"; nocase; content:"<isindex>"; distance:0; fast_pattern; nocase; content:"<style>"; distance:0; nocase; metadata:policy max-detect-ips drop, service http; reference:bugtraq,27668; reference:cve,2008-0076; reference:url,technet.microsoft.com/en-us/security/bulletin/ms08-010; classtype:attempted-user; sid:16063; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer cross domain information disclosure attempt"; flow:to_client,established; file_data; content:"document.getElementById|28|'testdiv'|29|.innerHTML='<object data=|22|/~"; content:"/poc.php|22| type=text/html id=|22|"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,18682; reference:cve,2006-3280; classtype:attempted-user; sid:16045; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer html tag memory corruption attempt"; flow:to_client,established; file_data; content:"|09 09|pre {|0A 09 09 09|white-space|3A|normal|3B 0A|"; fast_pattern:only; metadata:service http; reference:bugtraq,17468; reference:cve,2006-1188; classtype:attempted-dos; sid:16043; rev:7;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer createTextRange code execution attempt"; flow:to_client,established; file_data; content:".createTextRange|28 29 3B|"; fast_pattern:only; content:"<input type|3D 22|image|22|"; nocase; pcre:"/\x3Cinput\s+type\x3D\x22image\x22\s+id\x3D(?P<q1>(\x22|\x27|))(?P<t>\S+)(?P=q1).*?document\x2EgetElementById\x28(?P<q2>(\x22|\x27|))(?P=t)(?P=q2)\x29\x2EcreateTextRange/isO"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,17196; reference:cve,2006-1359; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-013; classtype:attempted-user; sid:16035; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer compressed content attempt"; flow:to_client,established; content:"Location|3A|"; nocase; http_header; content:"/ABCDEFGHIJ"; within:20; nocase; http_header; metadata:policy max-detect-ips drop, service http; reference:bugtraq,19987; reference:cve,2006-3873; classtype:attempted-user; sid:16033; rev:14;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer HTML Decoding memory corruption attempt"; flow:to_client,established; content:"charset=UTF-8"; nocase; file_data; content:"|F8|AAA|F8|AA|C8|"; within:8; metadata:policy max-detect-ips drop, service http; reference:bugtraq,18309; reference:cve,2006-2382; classtype:attempted-user; sid:16032; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer nested object tag memory corruption attempt"; flow:to_client,established; file_data; content:"<STYLE></STYLE>|0A|<OBJECT"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:bugtraq,17658; reference:cve,2006-1992; classtype:attempted-user; sid:16031; rev:13;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSS property method handling memory corruption attempt"; flow:to_client,established; file_data; content:"oa.cols=0x41414141|3B|"; content:"ob.mergeAttributes|28|oa,1|29 3B|"; distance:0; metadata:policy max-detect-ips drop, service http; reference:bugtraq,23769; reference:cve,2007-0945; classtype:attempted-user; sid:16011; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Javascript Page update race condition attempt"; flow:to_client,established; file_data; content:"win = open|28 22|poc_dummy.html|22|,|22|victim|22 29 3B|"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:bugtraq,24283; reference:cve,2007-3091; classtype:misc-activity; sid:16010; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer colgroup tag uninitialized memory exploit attempt"; flow:to_client,established; file_data; content:"<COLGROUP id=|22|colgroupid|22| span=2>"; content:"colgroupid.test = 'something'|3B|"; distance:0; metadata:policy max-detect-ips drop, service http; reference:bugtraq,23771; reference:cve,2007-0944; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-027; classtype:attempted-user; sid:16007; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer URL canonicalization address bar spoofing attempt"; flow:to_client,established; file_data; content:"%01@"; pcre:"/http\x3A\x2f\x2f[^\r\n]+\x2501\x40/smi"; metadata:service http; reference:cve,2003-1025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms04-004; classtype:misc-activity; sid:15933; rev:7;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer getElementById object corruption attempt"; flow:to_client,established; file_data; content:"document.getElementById(|27|ctrl1|27|).innerHTML=|22 22 3B|"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:bugtraq,30614; reference:cve,2008-2254; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-045; classtype:attempted-user; sid:15910; rev:18;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer popup window object tag code execution attempt"; flow:to_client,established; file_data; content:"window.createPopup|28 29|"; content:"oPopup.document.body.innerHTML"; distance:0; content:"<object data=ouch.php>"; distance:0; metadata:service http; reference:cve,2003-0838; classtype:attempted-user; sid:15880; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer empty table tag memory corruption attempt"; flow:to_client,established; file_data; content:"document.getElementsByTagName(|22|SPAN|22|)[0]"; nocase; content:"document.createElement(|27|TR|27|)"; distance:0; nocase; content:"appendChild(tr)"; distance:0; nocase; metadata:policy max-detect-ips drop, service http; reference:cve,2009-1918; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-034; classtype:attempted-user; sid:15733; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSS handling memory corruption attempt"; flow:to_client,established; file_data; content:"<style"; nocase; content:"document.styleSheets[0].rules[0].style"; distance:0; nocase; content:"document.styleSheets[0].cssText"; distance:0; nocase; content:".font"; distance:0; nocase; metadata:policy max-detect-ips drop, service http; reference:cve,2009-1919; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-034; classtype:attempted-user; sid:15732; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer javascript deleted reference arbitrary code execution attempt"; flow:to_client,established; file_data; content:".outerHTML"; content:"CollectGarbage"; distance:0; content:".innerHTML ="; distance:0; pcre:"/(\S*)\x2EouterHTML\s*\x3D.*CollectGarbage\s?\x28\x29.*\1\x2EinnerHTML/smi"; metadata:policy max-detect-ips drop, service http; reference:cve,2009-1917; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-034; classtype:attempted-user; sid:15731; rev:16;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer DOM memory corruption attempt"; flow:to_client,established; file_data; content:"<script"; nocase; content:"null"; distance:0; nocase; content:"CollectGarbage|28 29|"; distance:0; fast_pattern; nocase; pcre:"/\x3d\s*null\s*\x3b[^\x7d]{0,50}\x3d\s*null\s*\x3b[^\x7d]{0,50}CollectGarbage\x28\x29/smi"; metadata:policy max-detect-ips drop, service http; reference:cve,2009-1532; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-019; classtype:attempted-admin; sid:15540; rev:15;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer onreadystatechange memory corruption attempt"; flow:to_client,established; file_data; content:"doc.replaceChild|28|doc,doc|29|"; nocase; content:"doc.removeChild|28|doc,doc|29|"; distance:0; nocase; content:"onreadystatechange"; distance:0; nocase; metadata:service http; reference:cve,2009-1531; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-019; classtype:misc-attack; sid:15538; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer setCapture heap corruption exploit attempt"; flow:to_client,established; file_data; content:"setCapture"; pcre:"/document\x2eall\x28.*?\x29\x2esetCapture\x28/s"; metadata:service http; reference:cve,2009-1529; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-019; classtype:attempted-user; sid:15535; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer XML HttpRequest race condition exploit attempt"; flow:to_client,established; file_data; content:"ActiveXObject"; content:"Microsoft.XMLHTTP"; within:30; content:"setInterval"; within:100; pcre:"/function\s+([a-z0-9_]+)\s*\x28.*?ActiveXObject\s*\x28\s*\x22Microsoft\.XMLHTTP\x22\s*\x29.*?setInterval\s*\x28\s*\x22\1/smi"; metadata:service http; reference:cve,2009-1528; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-019; classtype:attempted-user; sid:15534; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Unexpected method call remote code execution attempt"; flow:to_client,established; file_data; content:"clearAttributes"; nocase; pcre:"/(\w+)\.insertCell.*\1\.deleteCell.*\1\.clearAttributes/smi"; metadata:service http; reference:cve,2009-1141; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-019; classtype:attempted-user; sid:15531; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer cross-domain navigation cookie stealing attempt"; flow:to_client,established; file_data; content:"setInterval|28|'xDomainAccess|28 29|',1|29 3B|"; nocase; content:"setInterval|28 22|try { myWindow.location.href = victimLnk|3B|}"; nocase; metadata:service http; reference:cve,2007-3091; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-019; classtype:misc-attack; sid:15529; rev:8;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"BROWSER-IE Apple Safari-Internet Explorer SearchPath blended threat dll request"; flow:to_server,established; content:".dll"; nocase; http_uri; content:"Safari"; http_header; pcre:"/^User\x2dAgent\x3a\s*[^\n]*Safari[^\n]*\r\n/smi"; flowbits:set,safari.dll; flowbits:noalert; metadata:policy max-detect-ips drop, service http; reference:cve,2008-2540; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-015; classtype:attempted-user; sid:15468; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer ActiveX load/unload race condition attempt"; flow:to_client,established; file_data; content:"window.open"; nocase; content:"document.body.innerHTML"; distance:1; content:"<embed"; distance:1; nocase; content:"setInterval"; distance:1; pcre:"/setInterval\s*\x28.+?\x2c\s*[0-9]{1,2}\s*\x29/s"; metadata:service http; reference:cve,2009-0553; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-014; classtype:attempted-user; sid:15460; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted/unitialized object memory corruption attempt"; flow:to_client,established; file_data; content:"<script"; nocase; content:"var arr1=new Array"; distance:1; content:"history.go|28|arr1[1]|29|"; distance:1; content:"arr1[i] += temp"; distance:1; content:"</script"; distance:1; nocase; metadata:service http; reference:cve,2009-0552; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-014; classtype:attempted-user; sid:15459; rev:7;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer navigating between pages race condition attempt"; flow:to_client,established; file_data; content:"function set_timers|28 29|"; content:"setInterval|28|'flip_page|28 29|'"; within:40; metadata:service http; reference:cve,2009-0551; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-014; classtype:attempted-user; sid:15458; rev:7;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer dynamic style update memory corruption attempt"; flow:to_client,established; file_data; content:"strict.dtd"; nocase; content:"<li"; nocase; content:"<textarea"; within:50; fast_pattern; nocase; content:"</textarea"; within:100; nocase; content:".getElementByID"; distance:0; nocase; content:".className"; within:50; nocase; pcre:"/<li\s[^>]*?id\s*?=\s*?[\x22\x27]?(?P<id>\w+)[\x22\x27]?[^>]*?>[\r\n\s]+<textarea.*?\.(?P<class>\w+)[\r\n\s]*?\{[\r\n\s]*?zoom\x3a\s*?\d+px\x3b.*?document\.getElementById\s*?\(\s*?[\x22\x27]?(?P=id).*?\.className\s*?=\s*?[\x22\x27]?(?P=class)/si"; metadata:policy max-detect-ips drop, service http; reference:cve,2009-0076; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-002; classtype:attempted-user; sid:15305; rev:17;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer object clone deletion memory corruption attempt"; flow:to_client,established; file_data; content:"cloneNode"; nocase; content:"clearAttributes"; within:128; nocase; pcre:"/var\s*(?P<cl>\w+)\s*=\s*(?P<o>\w+)\.cloneNode.*?(?P=o)\.clearAttributes.*?(?P=o)\s*=\s*null\s*\x3B.*?(?P=cl)\.click\s*\x3B/Osmi"; metadata:policy max-detect-ips drop, service http; reference:cve,2009-0075; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-002; classtype:attempted-user; sid:15304; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer malformed iframe buffer overflow attempt"; flow:to_client,established; file_data; content:"<IFRAME"; nocase; content:"SRC="; within:20; distance:1; nocase; isdataat:248,relative; content:"NAME="; nocase; pcre:"/<iframe[^>]*?src[^>]*?name=[\x22\x27][^\x22\x27]{500}/smi"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,11515; reference:cve,2004-1050; classtype:attempted-user; sid:15147; rev:19;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer nested tag memory corruption attempt"; flow:to_client,established; file_data; content:"datasrc"; nocase; content:"datafld"; nocase; pcre:"/<(?P<t1>button|div|input[^>]+?type\s*=\s*(\x22|\x27)button(\x22|\x27)|label|legend|marquee|param|span)\s+[^>]*(datasrc\s*=\s*(?P<q1>\x22|\x27|)(?P<d1>\S+)(?P=q1)\s+[^>]*datafld\s*=\s*(?P<q2>\x22|\x27|)(?P<d2>\S+)(?P=q2)|datafld\s*=\s*(?P<q3>\x22|\x27|)(?P<d3>\S+)(?P=q3)\s+[^>]*datasrc\s*=\s*(?P<q4>\x22|\x27|)(?P<d4>\S+)(?P=q4))[^>]*>(?!.*?<\/\s*(?P=t1)\s*>.*?<(?P=t1)).*?<(?P=t1)\s+[^>]*(datasrc\s*=\s*(?P<q5>\x22|\x27|)((?P=d1)|(?P=d3))(?P=q5)\s+datafld\s*=\s*(?P<q6>\x22|\x27|)((?P=d2)|(?P=d4))(?P=q6)|(datafld\s*=\s*(?P<q7>\x22|\x27|)(?P=d1)(?P=q7)\s+datasrc\s*=\s*(?P<q8>\x22|\x27|)(?P=d2)(?P=q8)))/Osi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,32721; reference:cve,2008-4844; reference:url,technet.microsoft.com/en-us/security/bulletin/ms08-078; classtype:attempted-user; sid:15126; rev:16;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer embed src buffer overflow attempt"; flow:to_client,established; file_data; content:"embed src"; nocase; isdataat:1000,relative; pcre:"/embed src=\s*(\x27[^\x27]{1000}|\x22[^\x22]{1000}|[^\s\x22\x27]{1000})/smi"; metadata:policy max-detect-ips drop, service http; reference:cve,2008-4261; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-073; classtype:attempted-user; sid:15114; rev:16;)
# alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer MSXML DLL memory corruption attempt"; flow:to_client,established; content:"application/xml"; pcre:"/(<[^>]+>)\1{19}/"; reference:cve,2007-0099; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-069; classtype:attempted-dos; sid:15012; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer cross domain componentFromPoint memory corruption attempt"; flow:to_client,established; file_data; content:"|2E|componentFromPoint|28|"; nocase; pcre:"/(\S+)\s+\x3d[^\x3b]*\x2e(createElement|getElementById)\x28.*\1\x2ecomponentFromPoint\x28/si"; metadata:policy max-detect-ips drop, service http; reference:cve,2008-3475; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-058; classtype:attempted-user; sid:14657; rev:14;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer XSS mouseevent PII disclosure attempt"; flow:to_client,established; file_data; content:"setcapture|28 29|"; fast_pattern:only; content:"onclick="; nocase; content:"event"; nocase; content:"srcelement."; distance:0; nocase; pcre:"/(?P<divname>\w+)\x2esetcapture\x28\x29.*?<div[^\x3e]*?(?P=divname)[^\x3e]*?onclick\x3d/smi"; metadata:service http; reference:cve,2008-3473; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-053; classtype:web-application-activity; sid:14656; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer cross domain setExpression exploit attempt"; flow:to_client,established; file_data; content:"setexpression"; nocase; content:"clearattributes"; distance:0; fast_pattern; nocase; pcre:"/(\w+)\x2Esetexpression\s*\x28\x29.+\1\x2Eclearattributes\s*\x28\x29/smi"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2008-3476; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-058; classtype:attempted-user; sid:14645; rev:18;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer cross domain unfocusable HTML element"; flow:to_client,established; file_data; content:"tabindex"; fast_pattern:only; content:"getElementById("; content:"unfocusable"; within:15; pcre:"/\x28\s*(([\x22\x27])unfocusable\2\s*\x29|[^\x22\x27]*?\S+\s*?\x29)/ims"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2008-3472; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-058; classtype:attempted-user; sid:14644; rev:18;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer location and location.href cross domain security bypass vulnerability"; flow:to_client,established; file_data; content:"window.open"; nocase; content:".location"; nocase; pcre:"/\.location(\.href)?\s*=\s*new\s+String\s*\x28\s*\x22\s*javascript\x3A/si"; metadata:policy max-detect-ips drop, service http; reference:cve,2008-2947; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-058; classtype:attempted-user; sid:14643; rev:14;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer http status response memory corruption vulnerability"; flow:to_client,established; content:"HTTP/1"; depth:6; nocase; content:"449"; within:10; fast_pattern; pcre:"/^http\/1\x2e[01][ \t]+449/i"; metadata:policy max-detect-ips drop, service http; reference:cve,2008-2256; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-045; classtype:attempted-user; sid:13980; rev:16;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer XHTML element memory corruption attempt"; flow:to_client,established; file_data; content:"createElement"; nocase; pcre:"/(\w+)\s*\x3D\s*document\x2EcreateElement.*(\w+)\s*\x3D\s*document\x2EcreateElement.*\1\x2EappendChild\x28\2\x29.*appendChild\x28\1\x29/smi"; metadata:service http; reference:cve,2008-2257; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-045; classtype:attempted-user; sid:13974; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer span frontier parsing memory corruption"; flow:to_client,established; file_data; content:"span"; nocase; pcre:"/span\s+ID\s*\x3d\s*(\w+).*\1\s*\x2e\s*\w+\x3d/smi"; metadata:service http; reference:cve,2008-2254; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-045; classtype:attempted-user; sid:13964; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer argument validation in print preview handling exploitation attempt"; flow:to_client,established; file_data; content:"|2E|ExecWB"; fast_pattern:only; pcre:"/\x2eExecWB\s*\x28(IDM_PRINTPREVIEW|7)\x2c\s+(0|2)\x2C\s+\x22http/smi"; metadata:service http; reference:bugtraq,30612; reference:cve,2008-2259; reference:url,osvdb.org/show/osvdb/47414; reference:url,technet.microsoft.com/en-us/security/bulletin/ms08-045; classtype:attempted-user; sid:13963; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer MHTML zone control bypass attempt"; flow:to_client,established; file_data; content:"mhtml|3A|"; nocase; content:"Content-Transfer-Encoding"; nocase; content:"base64"; within:10; nocase; pcre:"/(PHNjcmlw|c2NyaXB0|Y3JpcHQ+|Y3JpcHQ\x252B)/Rsi"; metadata:service http; reference:cve,2008-1448; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-048; classtype:attempted-user; sid:13962; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer table layout access violation vulnerability"; flow:to_client,established; file_data; content:"|2E|getClientRects|28 29|"; nocase; content:"|2E|clearAttributes|28 29|"; within:50; nocase; metadata:service http; reference:cve,2008-2258; reference:url,technet.microsoft.com/en-us/security/bulletin/ms08-045; classtype:misc-attack; sid:13961; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer static text range overflow attempt"; flow:to_client,established; file_data; content:"createTextRange"; content:"while|28 31 29|"; within:200; content:"text ="; within:200; metadata:service http; reference:cve,2008-2255; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-045; classtype:attempted-user; sid:13960; rev:13;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer isComponentInstalled attack attempt"; flow:to_client,established; file_data; content:"isComponentInstalled|28|boom"; fast_pattern:only; metadata:service http; reference:bugtraq,16870; reference:cve,2006-1016; classtype:attempted-user; sid:13912; rev:7;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer request header overwrite"; flow:to_client,established; file_data; content:"XMLHttpRequest|28|"; nocase; content:"setRequestHeader|28 22|"; distance:0; nocase; pcre:"/setRequestHeader\x28\x22(host|referer|content\x2dlength)\x22\s*\x2B/i"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,28379; reference:cve,2008-1544; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-031; classtype:misc-activity; sid:13834; rev:17;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer data stream memory corruption attempt"; flow:to_client,established; file_data; content:"%PDFAAAAAAAA"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,28552; reference:cve,2008-1085; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-024; classtype:attempted-user; sid:13677; rev:19;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer DXLUTBuilder ActiveX function call unicode access"; flow:to_client,established; file_data; content:"D|00|X|00|T|00|r|00|a|00|n|00|s|00|f|00|o|00|r|00|m|00|.|00|M|00|i|00|c|00|r|00|o|00|s|00|o|00|f|00|t|00|.|00|D|00|X|00|L|00|U|00|T|00|B|00|u|00|i|00|l|00|d|00|e|00|r|00|"; nocase; pcre:"/(?P<c>\w+)(\s\x00)*=(\s\x00)*(?P<q3>\x22|\x27|)D\x00X\x00T\x00r\x00a\x00n\x00s\x00f\x00o\x00r\x00m\x00.\x00M\x00i\x00c\x00r\x00o\x00s\x00o\x00f\x00t\x00.\x00D\x00X\x00L\x00U\x00T\x00B\x00u\x00i\x00l\x00d\x00e\x00r\x00(?P=q3)(\s|>)(\s\x00)*\x3b\x00.*(?P<v>(\w\x00)+)(\s\x00)*1\(\x00(\s\x00)*(?P=c)(\s\x00)*\)\x00|(?P<n>\w+)(\s\x00)*1\(\x00(\s\x00)*(?P<q4>\x22|\x27|)D\x00X\x00T\x00r\x00a\x00n\x00s\x00f\x00o\x00r\x00m\x00.\x00M\x00i\x00c\x00r\x00o\x00s\x00o\x00f\x00t\x00.\x00D\x00X\x00L\x00U\x00T\x00B\x00u\x00i\x00l\x00d\x00e\x00r\x00(?P=q4)(\s|>)(\s\x00)*\)\x00/smi"; metadata:service http; reference:cve,2008-0078; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-010; classtype:attempted-user; sid:13456; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer DXLUTBuilder ActiveX function call access"; flow:to_client,established; file_data; content:"DXTransform.Microsoft.DXLUTBuilder"; pcre:"/(?P<c>\w+)\s*=\s*(\x22DXTransform\.Microsoft\.DXLUTBuilder(\.\d)?\x22|\x27DXTransform\.Microsoft\.DXLUTBuilder(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22DXTransform\.Microsoft\.DXLUTBuilder(\.\d)?\x22|\x27DXTransform\.Microsoft\.DXLUTBuilder(\.\d)?\x27)\s*\)/smi"; metadata:policy max-detect-ips drop, service http; reference:cve,2008-0078; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-010; classtype:attempted-user; sid:13455; rev:15;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer DXLUTBuilder ActiveX clsid unicode access"; flow:to_client,established; file_data; content:"1|00|e|00|5|00|4|00|3|00|3|00|3|00|b|00|-|00|2|00|a|00|0|00|0|00|-|00|1|00|1|00|d|00|1|00|-|00|8|00|1|00|9|00|8|00|-|00|0|00|0|00|0|00|0|00|f|00|8|00|7|00|5|00|5|00|7|00|d|00|b|00|"; nocase; pcre:"/1([^>]\x00)*1(?P<q2>\x22\x00|\x27\x00|)1({\x00)?1(}\x00)?(?P=q2)(?=\s\x00|>\x00)/si"; metadata:service http; reference:cve,2008-0078; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-010; classtype:attempted-user; sid:13454; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer DXLUTBuilder ActiveX clsid access"; flow:to_client,established; file_data; content:"1e54333b-2a00-11d1-8198-0000f87557db"; nocase; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*1e54333b-2a00-11d1-8198-0000f87557db\s*}?\s*(?P=q1)(\s|>)/si"; metadata:service http; reference:cve,2008-0078; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-010; classtype:attempted-user; sid:13453; rev:11;)
# alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"BROWSER-IE Microsoft Windows ShellExecute and Internet Explorer 7 url handling code execution attempt"; flow:to_client,established; content:"BEGIN|3A|VCARD"; fast_pattern:only; pcre:"/^URL\x3b\w+\x3amailto\x3a[^\n]*%[^\n]*\.(cmd|bat)/smi"; metadata:service http; reference:bugtraq,25945; reference:cve,2007-3896; reference:url,technet.microsoft.com/en-us/security/advisory/943521; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-057; classtype:attempted-user; sid:12664; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer VML source file memory corruption attempt"; flow:to_client,established; file_data; content:"vmlframe"; nocase; content:"urn:schemas-microsoft-com:vml"; fast_pattern:only; pcre:"/<(?P<t>[\w\x2D\x2E]+)\x3A[^>]+>.*?<(?P=t)\x3Avmlframe\s+[^>]*src\s*=\s*(?P<q>\x22|\x27)[\w\x25\x2D\x2E\x2F\x3A]+\x2E\w{2,4}(?P=q)/smi"; metadata:service http; reference:bugtraq,25310; reference:cve,2007-1749; reference:url,osvdb.org/show/osvdb/36390; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-050; classtype:attempted-user; sid:12282; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer VML source file memory corruption attempt"; flow:to_client,established; file_data; content:"stroke"; nocase; content:"urn:schemas-microsoft-com:vml"; fast_pattern:only; pcre:"/<(?P<t>[\w\x2D\x2E]+)\x3A[^>]+>.*?<(?P=t)\x3Astroke\s+[^>]*src\s*=\s*(?P<q>\x22|\x27)[\w\x25\x2D\x2E\x2F\x3A]+\x2E\w{2,4}(?P=q)/smi"; metadata:service http; reference:bugtraq,25310; reference:cve,2007-1749; reference:url,osvdb.org/show/osvdb/36390; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-050; classtype:attempted-user; sid:12281; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer VML source file memory corruption attempt"; flow:to_client,established; file_data; content:"rect"; nocase; content:"imagedata"; within:100; nocase; content:"urn:schemas-microsoft-com:vml"; fast_pattern:only; pcre:"/<(?P<t>[\w\x2D\x2E]+)\x3A[^>]+>.*?<(?P=t)\x3Aimagedata\s+[^>]*src\s*=\s*(?P<q>\x22|\x27)[\w\x25\x2D\x2E\x2F\x3A]+\x2E\w{2,4}(?P=q)/smi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,25310; reference:cve,2007-1749; reference:url,osvdb.org/show/osvdb/36390; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-050; classtype:attempted-user; sid:12280; rev:16;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSS memory corruption exploit"; flow:to_client,established; content:"Content-Type|3A|"; nocase; http_header; content:"text/css"; within:20; nocase; http_header; pcre:!"/^Content-encoding\x3A\s*(gzip|compress)/Him"; pcre:"/\x7D\s*\/[^\/\x2A]/H"; metadata:service http; reference:cve,2007-0943; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-045; classtype:attempted-user; sid:12277; rev:18;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer navcancl.htm url spoofing attempt"; flow:to_client,established; file_data; content:"about|3A|cancel|23|"; nocase; metadata:service http; reference:bugtraq,22966; reference:cve,2007-1499; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-033; classtype:misc-attack; sid:12014; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSS tag memory corruption attempt"; flow:to_client,established; file_data; content:"style"; nocase; content:"csstext"; distance:0; nocase; pcre:"/\x3c[^\x3e]*style\s*=[^\x3e]*?csstext\x3a/smi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,24423; reference:cve,2007-1750; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-033; classtype:attempted-user; sid:11966; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer navcancl.htm url spoofing attempt"; flow:to_client,established; file_data; content:"ieframe.dll/navcancl.htm|23|"; nocase; metadata:policy max-detect-ips drop, service http; reference:bugtraq,22966; reference:cve,2007-1499; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-033; classtype:misc-attack; sid:11834; rev:21;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer colgroup tag uninitialized memory exploit attempt"; flow:to_client,established; file_data; content:"<colgroup "; fast_pattern:only; pcre:"/<colgroup\s+[^>]*id\s*=\s*(?P<q1>\x22|\x27|)(?P<q2>\w+)(?P=q1)[^>]*>.*\s+(?P=q2)(\.delete)|(\.test)/smi"; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,23771; reference:cve,2007-0944; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-027; classtype:attempted-user; sid:11257; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer isComponentInstalled function buffer overflow"; flow:to_client,established; file_data; content:"isComponentInstalled"; nocase; isdataat:256,relative; pcre:"/isComponentInstalled\s*\([^,\)]{256}/smi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,16870; reference:cve,2006-1016; classtype:attempted-user; sid:7020; rev:14;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer mhtml uri shortcut buffer overflow attempt"; flow:to_client,established; file_data; content:"URL"; nocase; content:"mhtml|3A|//"; distance:0; nocase; pcre:"/^\s*URL\s*=\s*mhtml\x3A\x2F\x2F[A-Z\x2D]{2,31}\x3A[^\r\n]{1253}/smi"; metadata:service http; reference:bugtraq,18198; reference:cve,2006-2766; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-043; classtype:attempted-user; sid:6510; rev:14;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer mhtml uri href buffer overflow attempt"; flow:to_client,established; file_data; content:"mhtml|3A|//"; nocase; pcre:"/href\s*=\s*(\x22mhtml\x3A\x2F\x2F[A-Z\x2D]{2,31}\x3A[^\x22]{1253}|\x27mhtml\x3A\x2F\x2F[A-Z\x2D]{2,31}\x3A[^\x27]{1253}|mhtml\x3A\x2F\x2F[A-Z\x2D]{2,31}\x3A[^\x09\r\n\x20]{1253})/smi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,18198; reference:cve,2006-2766; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-043; classtype:attempted-user; sid:6509; rev:16;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer javascript onload prompt obfuscation overflow attempt"; flow:to_client,established; file_data; content:"prompt"; nocase; content:"fillmem"; distance:0; nocase; content:"body"; nocase; content:"onLoad"; distance:0; nocase; content:"setTimeout"; distance:0; nocase; pcre:"/prompt\(fillmem[^\)]*\).*?<body\s+[^>]*onLoad\s*=\s*[\x22\x27]?setTimeout\(/smi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,13799; reference:cve,2005-1790; reference:url,computerterrorism.com/research/ie/ct21-11-2005; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-054; classtype:attempted-user; sid:4917; rev:15;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer javascript onload document.write obfuscation overflow attempt"; flow:to_client,established; file_data; content:"document.write"; nocase; pcre:"/document\.write\(([^\x22\x27\x29\x3B]*([\x22\x27]))((?(?=\2)\2(?1)))\x3C(?3)b(?3)o(?3)d(?3)y(?3)\s*(?3)o(?3)n(?3)l(?3)o(?3)a(?3)d(?3)\s*(?3)=(?3)\s*(?3)w(?3)i(?3)n(?3)d(?3)o(?3)w(?3)\x28(?3)\x29/smi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,13799; reference:cve,2005-1790; reference:url,computerterrorism.com/research/ie/ct21-11-2005; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-054; classtype:attempted-user; sid:4916; rev:14;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer javascript onload overflow attempt"; flow:to_client,established; file_data; content:"body"; nocase; content:"on"; within:20; nocase; content:"window"; within:20; nocase; pcre:"/<body\s+[^>]*on(Load|Blur)\s*=\s*[\x22\x27]?window\(\)/smi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,13799; reference:cve,2005-1790; reference:url,computerterrorism.com/research/ie/ct21-11-2005; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-054; classtype:attempted-user; sid:4647; rev:17;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer JPEG rendering buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|FA FF DA 00 0C 03|"; content:!"R|00|G|00|B|00|"; within:6; pcre:!"/\xFA\xFF\xDA\x00\x0C\x03((\x00.\x01.\x02)|(\x01.\x02.\x03)|(\x01.\x04.\x05))/"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,14282; reference:bugtraq,14284; reference:cve,2005-1988; reference:cve,2005-2308; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-038; classtype:attempted-user; sid:4135; rev:23;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer blnmgr clsid access attempt"; flow:to_client,established; file_data; content:"clsid:3F8A6C33-E0FD-11D0-8A8C-00A0C90C2BC5"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-038; classtype:attempted-user; sid:4134; rev:14;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer devenum clsid access attempt"; flow:to_client,established; file_data; content:"clsid:083863F1-70DE-11d0-BD40-00A0C911CE86"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-038; classtype:attempted-user; sid:4133; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer msdds clsid access attempt"; flow:to_client,established; file_data; content:"clsid:EC444CB6-3E7E-4865-B1C3-0DE72EF39B3F"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,14594; reference:cve,2005-1990; reference:cve,2005-2127; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-038; reference:url,www.frsirt.com/english/advisories/2005/1450; classtype:attempted-user; sid:4132; rev:16;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer javaprxy.dll COM access"; flow:to_client,established; file_data; content:"03D9F3F2-B0E3-11D2-B081-006008039BF0"; nocase; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*03D9F3F2-B0E3-11D2-B081-006008039BF0/si"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,14087; reference:cve,2005-2087; reference:url,osvdb.org/show/osvdb/17680; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-037; classtype:attempted-user; sid:3814; rev:18;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer tRNS overflow attempt"; flow:to_client,established; flowbits:isset,file.png; file_data; content:"|89|PNG|0D 0A 1A 0A|"; content:"IHDR"; within:4; distance:4; content:"tRNS"; distance:0; byte_test:4,>,256,-8,relative,big; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,13941; reference:cve,2005-1211; reference:nessus,18490; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-025; classtype:attempted-user; sid:3689; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Content Advisor memory corruption attempt"; flow:to_client,established; flowbits:isset,file.rat; file_data; content:"name"; nocase; content:"rating-service"; fast_pattern:only; pcre:"/rating\x2Dservice.{0,300}\x28\s*name\s*\x22[^\x22]{261}/smi"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,13117; reference:cve,2005-0555; reference:url,osvdb.org/show/osvdb/15466; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-020; classtype:attempted-user; sid:3686; rev:23;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer bitmap BitmapOffset multipacket integer overflow attempt"; flow:to_client,established; flowbits:isset,file.bmp; file_data; content:"BM"; pcre:"/^BM/sm"; byte_test:4,>,2147480000,8,relative,little; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,9663; reference:cve,2004-0566; reference:url,technet.microsoft.com/en-us/security/bulletin/ms04-025; classtype:attempted-user; sid:3685; rev:14;)
# alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer spoofed MIME-Type auto-execution attempt"; flow:to_client,established; content:"Content-Type|3A|"; nocase; http_header; content:"audio/"; fast_pattern; nocase; http_header; pcre:"/Content-Type\x3A\s+audio\/(x-wav|mpeg|x-midi)/iH"; content:"filename="; nocase; http_header; pcre:"/filename=[\x22\x27]?.{1,221}\.(vbs|exe|scr|pif|bat)/Hi"; metadata:service http; reference:bugtraq,2524; reference:cve,2001-0154; reference:url,technet.microsoft.com/en-us/security/bulletin/MS01-020; classtype:attempted-admin; sid:3683; rev:13;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer HTML DOM null DHTML element insertion attempt"; flow:to_client,established; file_data; content:"NULL"; pcre:"/(insertBefore|insertAfter|appendChild)\(\s*NULL\s*\)/sm"; metadata:service http; reference:bugtraq,13120; reference:cve,2005-0553; reference:nessus,10861; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-020; classtype:attempted-user; sid:3553; rev:16;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer HTML http/https scheme hostname overflow attempt"; flow:to_client,established; file_data; content:"http"; nocase; content:"://"; within:4; pcre:"/(href|src|\.location|\.navigation)\s*?=\s*?[\x22\x27]?\s*?https?\x3a\x2f{2}[^@&?\s\x22\x27\x2f\x3a]{255}/i"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,33894; reference:cve,2005-0554; reference:cve,2009-0187; classtype:attempted-user; sid:3550; rev:17;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer Content-Encoding overflow attempt"; flow:to_server,established; content:"Content-Encoding"; nocase; content:"|3A|"; distance:0; pcre:"/^\s*Content-Encoding\s*\x3A\s*[^\r\n]{300}/mi"; metadata:ruleset community, service smtp; reference:bugtraq,7419; reference:cve,2003-0113; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-015; classtype:attempted-admin; sid:3462; rev:14;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 5/6 object type overflow attempt"; flow:to_client,established; file_data; content:"<OBJECT"; nocase; pcre:"/<OBJECT\s+[^>]*type\s*=[\x22\x27]\x2f{32}/smi"; metadata:ruleset community, service http; reference:cve,2003-0344; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-020; classtype:attempted-user; sid:3149; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer ANI file parsing buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.ani; file_data; content:"RIFF"; depth:4; content:"ACON"; within:4; distance:4; content:"anih"; distance:0; nocase; byte_test:4,>,36,0,relative,little; metadata:policy max-detect-ips drop, ruleset community, service ftp-data, service http, service imap, service pop3; reference:cve,2004-1049; reference:cve,2007-0038; reference:cve,2007-1765; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-002; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-017; classtype:attempted-user; sid:3079; rev:25;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer bitmap BitmapOffset integer overflow attempt"; flow:to_client,established; flowbits:isset,file.bmp; file_data; content:"BM"; byte_test:4,>,2147480000,8,relative,little; metadata:ruleset community, service ftp-data, service http, service imap, service pop3; reference:bugtraq,9663; reference:cve,2004-0566; reference:url,technet.microsoft.com/en-us/security/bulletin/ms04-025; classtype:attempted-user; sid:2671; rev:18;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 CTreeNodeobject use-after-free attempt"; flow:to_client,established; file_data; content:"ele1.addEventListener( |27|DOMNodeRemoved|27|, eHandler, false )"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3119; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047; classtype:attempted-user; sid:26988; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer double-free memory corruption attempt"; flow:to_server,established; file_data; content:"<rect id="; nocase; content:"clip-path=|22 22|/>"; within:25; nocase; content:".removeAttributeNS(|22 22|,|22|clip-path|22 29 3B|"; within:100; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3118; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047; classtype:attempted-user; sid:27101; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer double-free memory corruption attempt"; flow:to_client,established; file_data; content:"<rect id="; nocase; content:"clip-path=|22 22|/>"; within:25; nocase; content:".removeAttributeNS(|22 22|,|22|clip-path|22 29 3B|"; within:100; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3118; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047; classtype:attempted-user; sid:27100; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer file type spoofing attempt"; flow:to_client,established; file_data; content:".html."; fast_pattern; nocase; content:"document.execCommand"; nocase; content:"SaveAs"; within:8; nocase; pcre:"/document\x2eexecCommand\s*\x28\s*\x22SaveAs\x22\s*,[^,]*,\s*[\x22\x27][^\x22\x27]*\x2e(bat|exe|js)/smi"; metadata:service http; reference:bugtraq,11686; reference:cve,2004-1331; classtype:bad-unknown; sid:27063; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 8 deleted object access via timer memory corruption attempt"; flow:to_server,established; file_data; content:".innerHTML"; nocase; content:"document.body.appendChild|28|"; distance:0; content:"CollectGarbage()"; distance:0; nocase; content:"setTimeout|28|"; distance:0; nocase; content:"onload='setTimeout"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-1311; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037; classtype:attempted-user; sid:27062; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 deleted object access via timer memory corruption attempt"; flow:to_client,established; file_data; content:".innerHTML"; nocase; content:"document.body.appendChild|28|"; distance:0; content:"CollectGarbage()"; distance:0; nocase; content:"setTimeout|28|"; distance:0; nocase; content:"onload='setTimeout"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-1311; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037; classtype:attempted-user; sid:27061; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer table column-count integer overflow attempt"; flow:to_server,established; file_data; content:"<table"; nocase; content:"<td"; distance:0; content:".getElementsByTagName("; content:"column-count"; distance:0; pcre:"/var\s*(?P<var>\w+)\s*=\s*\w+\.getElementsByTagName\(\s*[\x22\x27]td[\x22\x27]\s*\)\.item(\(\s*0\s*\)|\.first)\s*\x3b.*?(?P=var)\.style\.(column-count\s*=|setAttribute\s*\(\s*[\x22\x27]column-count[\x22\x27]\s*,)\s*[\x22\x27]?(0x)?[a-f\d]{8}/msi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3146; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055; classtype:attempted-user; sid:27157; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer table column-count integer overflow attempt"; flow:to_client,established; file_data; content:"<table"; nocase; content:"<td"; distance:0; content:".getElementsByTagName("; content:"column-count"; distance:0; pcre:"/var\s*(?P<var>\w+)\s*=\s*\w+\.getElementsByTagName\(\s*[\x22\x27]td[\x22\x27]\s*\)\.item(\(\s*0\s*\)|\.first)\s*\x3b.*?(?P=var)\.style\.(column-count\s*=|setAttribute\s*\(\s*[\x22\x27]column-count[\x22\x27]\s*,)\s*[\x22\x27]?(0x)?[a-f\d]{8}/msi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3146; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055; classtype:attempted-user; sid:27156; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer pElement member use after free attempt"; flow:to_client,established; file_data; content:".removeChild(document.getElementsByTagName("; nocase; content:"bdo"; within:10; nocase; content:"CollectGarbage()"; within:200; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-3145; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055; classtype:attempted-user; sid:27154; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"; flow:to_server,established; file_data; content:"myObj[0].offset"; fast_pattern:only; content:"document.getElementsByName("; nocase; content:"document.execCommand(|22|Justify"; within:200; nocase; content:"document.execCommand("; within:100; nocase; content:"SelectAll"; within:9; distance:1; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3163; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055; classtype:attempted-user; sid:27153; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"; flow:to_server,established; file_data; content:"myObj[0].offset"; fast_pattern:only; content:"document.execCommand("; nocase; content:"SelectAll"; within:9; distance:1; nocase; content:"document.getElementsByName("; within:100; nocase; content:"document.execCommand(|22|Justify"; within:200; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3163; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055; classtype:attempted-user; sid:27152; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"; flow:to_client,established; file_data; content:"myObj[0].offset"; fast_pattern:only; content:"document.getElementsByName("; nocase; content:"document.execCommand(|22|Justify"; within:200; nocase; content:"document.execCommand("; within:100; nocase; content:"SelectAll"; within:9; distance:1; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3163; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055; classtype:attempted-user; sid:27151; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"; flow:to_client,established; file_data; content:"myObj[0].offset"; fast_pattern:only; content:"document.execCommand("; nocase; content:"SelectAll"; within:9; distance:1; nocase; content:"document.getElementsByName("; within:100; nocase; content:"document.execCommand(|22|Justify"; within:200; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3163; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055; classtype:attempted-user; sid:27150; rev:6;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer beforeeditfocus use after free exploit attempt "; flow:to_server,established; file_data; content:"function"; nocase; content:"document.write"; within:25; nocase; content:"onbeforeeditfocus="; within:100; nocase; content:"<input"; within:25; nocase; content:"</input>"; within:30; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3147; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-055; classtype:attempted-user; sid:27149; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer beforeeditfocus use after free exploit attempt"; flow:to_client,established; file_data; content:"function"; nocase; content:"document.write"; within:25; nocase; content:"onbeforeeditfocus="; within:100; nocase; content:"<input"; within:25; nocase; content:"</input>"; within:30; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3147; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-055; classtype:attempted-user; sid:27148; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 IE5 compatibility mode use after free attempt"; flow:established,to_client; file_data; content:"meta http-equiv=|22|X-UA-Compatible|22| content=|22|IE=5|22|"; fast_pattern:only; content:"event.srcElement.parentNode.removeChild|28|"; content:"document.body.appendChild|28|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-3144; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-055; classtype:attempted-admin; sid:27147; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode use after free memory corruption attempt"; flow:to_server,established; file_data; content:"document.body.innerHTML"; nocase; content:"document.styleSheets[0].cssText"; within:250; nocase; content:"document.body.innerHTML"; within:250; nocase; content:"onload="; within:250; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3164; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055; classtype:attempted-user; sid:27138; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode use after free memory corruption attempt"; flow:to_client,established; file_data; content:"document.body.innerHTML"; nocase; content:"document.styleSheets[0].cssText"; within:250; nocase; content:"document.body.innerHTML"; within:250; nocase; content:"onload="; within:250; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3164; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055; classtype:attempted-user; sid:27137; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 10 CTreePos use after free attempt"; flow:to_client,established; file_data; content:".createTHead"; content:".insertAdjacentHTML"; fast_pattern:only; content:".scrollIntoView"; content:".insertRow"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-3152; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055; classtype:attempted-user; sid:27135; rev:2;)
alert tcp any any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer display node use after free attempt"; flow:to_server,established; file_data; content:"getElementsByTagName|28|"; content:"input"; within:8; content:".height"; distance:0; content:".focus|28 29|"; distance:0; content:"document.body.noWrap"; distance:0; content:".disabled"; distance:0; pcre:"/(?P<var>\w+)\s*=\s*[\w.]+\.getElementsByTagName\(\s*[\x22\x27]input[\x22\x27]\s*\)(\[\s*0\s*]|\.first)\s*\x3b.{0,256}(?P=var)\.height\s*=\s*0\s*\x3b.{0,512}(?P=var)\.disabled\s*=\s*true/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3115; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-055; classtype:attempted-user; sid:27134; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer display node use after free attempt"; flow:to_client,established; file_data; content:"getElementsByTagName|28|"; content:"input"; within:8; content:".height"; distance:0; content:".focus|28 29|"; distance:0; content:"document.body.noWrap"; distance:0; content:".disabled"; distance:0; pcre:"/(?P<var>\w+)\s*=\s*[\w.]+\.getElementsByTagName\(\s*[\x22\x27]input[\x22\x27]\s*\)(\[\s*0\s*]|\.first)\s*\x3b.{0,256}(?P=var)\.height\s*=\s*0\s*\x3b.{0,512}(?P=var)\.disabled\s*=\s*true/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3115; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-055; classtype:attempted-user; sid:27133; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer PreviousTreePos use after free attempt"; flow:to_client,established; file_data; content:".onpropertychange"; content:".swapNode|28|"; within:64; pcre:"/\.onpropertychange\s*=\s*function[^{]*?\{[^}]*?\w+\.swapNode\x28/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3153; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055; classtype:attempted-user; sid:27132; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 CTreePos use after free attempt"; flow:to_client,established; file_data; content:"appendChild(document.createElement('q'))|3B|document.body.appendChild(document.createElement('q'))|3B|document.body.appendChild(document.createElement('progress'))|3B|document.getElementsByTagName"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-3151; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055; classtype:attempted-user; sid:27131; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 9 use after free attempt"; flow:to_server,established; file_data; content:"onbeforecopy=|27|document.write(|22 22|)|27|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3148; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055; classtype:attempted-user; sid:27130; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 use after free attempt"; flow:to_client,established; file_data; content:"onbeforecopy=|27|document.write(|22 22|)|27|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3148; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055; classtype:attempted-user; sid:27129; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 10 CTreePos use-after-free attempt"; flow:to_server,established; file_data; content:"addEventListener"; nocase; content:"DOMNodeRemoved"; within:50; nocase; content:"document.write"; within:30; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3143; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055; classtype:attempted-user; sid:27128; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 10 CTreePos use-after-free attempt"; flow:to_client,established; file_data; content:"addEventListener"; nocase; content:"DOMNodeRemoved"; within:50; nocase; content:"document.write"; within:30; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3143; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055; classtype:attempted-user; sid:27127; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer setCapture use after free attempt"; flow:to_client,established; file_data; content:".getElementById("; nocase; content:".setCapture("; within:50; fast_pattern; nocase; content:".getElementById("; within:50; nocase; content:".setCapture("; within:50; nocase; content:".getElementById("; within:50; nocase; content:".setCapture("; within:50; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-3150; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055; classtype:attempted-user; sid:27126; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"; flow:to_server,established; file_data; content:"document.createElement("; nocase; content:"document.body.appendChild("; within:100; nocase; content:"applyElement("; within:100; fast_pattern; nocase; content:"innerHTML"; within:100; nocase; pcre:"/var\s*?(?P<badelement>\w+)\s*?=\s*?document\.createElement.*?document\.body\.appendChild[\x28]\s*?(?P=badelement)\s*?[\x29].*?applyElement[\x28]\s*?(?P=badelement)\s*?[\x29].*?innerHTML\s*?=\s*?[\x22\x27]\s*?[\x22\x27]/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3163; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055; classtype:attempted-user; sid:27172; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"; flow:to_client,established; file_data; content:"document.createElement("; nocase; content:"document.body.appendChild("; within:100; nocase; content:"applyElement("; within:100; fast_pattern; nocase; content:"innerHTML"; within:100; nocase; pcre:"/var\s*?(?P<badelement>\w+)\s*?=\s*?document\.createElement.*?document\.body\.appendChild[\x28]\s*?(?P=badelement)\s*?[\x29].*?applyElement[\x28]\s*?(?P=badelement)\s*?[\x29].*?innerHTML\s*?=\s*?[\x22\x27]\s*?[\x22\x27]/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3163; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055; classtype:attempted-user; sid:27171; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer innerHTML against incomplete element heap corruption attempt"; flow:to_server,established; file_data; content:".innerHTML"; fast_pattern:only; content:"<script"; nocase; pcre:"/<(?P<elem>\w+)\s[^>]*?(id|name)=\s*?(?P<q1>\x22|\x27|)\s*?(?P<id1>\w+)\s*?(?P=q1)[^>]*?(?<!\x2f)>(?!.*?<\x2f(?P=elem)>).*?<script(?=.*?(?P=id1)\.innerHTML(\x2b{2}|\s*?=\s*?(\x22|\x27){2}))/smi"; metadata:policy security-ips drop, service smtp; reference:bugtraq,39031; reference:cve,2010-0490; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-018; classtype:attempted-user; sid:27222; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer virtual function table corruption attempt"; flow:to_server,established; file_data; content:"<MARQUEE"; fast_pattern:only; content:".removeNode"; nocase; content:"document.execCommand"; nocase; content:"selectAll"; within:15; nocase; pcre:"/select\s*?id\s*?=[\x22\x27](?P<badelem>\w+).*?<\s*?marquee\s*?id\s*?=\s*?[\x22\x27](?P<badelem2>\w+).*?<\s*?span\s*?id\s*?=[\x22\x27](?P<badelem3>\w+)[\x22\x27].*?[\x22\x27](?P=badelem)[\x22\x27]\x29\s*?\.focus\x28\x29.*?(?P=badelem3)\.innerHTML.*?[\x22\x27](?P=badelem2)[\x22\x27]\x29\s*?\.removeNode\x28\s*?true\x29.*?document\.execCommand\x28[\x22\x27]selectAll/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,54951; reference:cve,2012-2522; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-052; classtype:attempted-user; sid:27221; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer virtual function table corruption attempt"; flow:to_client,established; file_data; content:"<MARQUEE"; fast_pattern:only; content:".removeNode"; content:"document.execCommand"; content:"selectAll"; within:15; pcre:"/select\s*?id\s*?=[\x22\x27](?P<badelem>\w+).*?<\s*?marquee\s*?id\s*?=\s*?[\x22\x27](?P<badelem2>\w+).*?<\s*?span\s*?id\s*?=[\x22\x27](?P<badelem3>\w+)[\x22\x27].*?[\x22\x27](?P=badelem)[\x22\x27]\x29\s*?\.focus\x28\x29.*?(?P=badelem3)\.innerHTML.*?[\x22\x27](?P=badelem2)[\x22\x27]\x29\s*?\.removeNode\x28\s*?true\x29.*?document\.execCommand\x28[\x22\x27]selectAll/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,54951; reference:cve,2012-2522; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-052; classtype:attempted-user; sid:27220; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 and 10 information disclosure attempt"; flow:to_client,established; file_data; content:"new Array("; content:"JSON.stringify(new Array("; content:!")"; within:6; metadata:service http; reference:url,hi.baidu.com/yuange1975/item/0a468218d147f4cd39cb30d0; classtype:attempted-user; sid:27531; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer merged stylesheet array use after free attempt"; flow:to_client,established; file_data; content:"createStyleSheet"; content:".sheet"; content:".removeRule"; within:50; fast_pattern; pcre:"/function\s+(?P<n>\w+)\s*\([^\)]*?\)\s*\{[^\}]*?\x2e\s*(getElement[s]*ByTagName[^\}]*?sheet\s*\x2e\s*removeRule\s*\(\s*\w\s*\)|sheet\s*\x2e\s*removeRule\s*\(\s*\w\s*\)[^\}]*?\x2e\s*getElement[s]*ByTagName)[^\}]*?(?P=n)\s*\(/si"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3191; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-059; classtype:attempted-user; sid:27620; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 6 usp10.dll Bengali font stack overrun attempt"; flow:to_server,established; file_data; content:"charset=UTF-8"; content:"|8C E2 80 8C E2 80 8C E2 80 8C E2 80 8C E2 80 8C E2 80 8C E2|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3181; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-060; classtype:attempted-dos; sid:27619; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 6 usp10.dll Bengali font stack overrun attempt"; flow:to_client,established; file_data; content:"charset=UTF-8"; content:"|8C E2 80 8C E2 80 8C E2 80 8C E2 80 8C E2 80 8C E2 80 8C E2|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3181; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-060; classtype:attempted-dos; sid:27618; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer MoveToMarkupPointer call with CControlTracker OnExitTree use-after-free attempt"; flow:to_server,established; file_data; content:".innerText="; nocase; content:"body.contentEditable"; fast_pattern:only; content:"false"; nocase; content:"execCommand"; within:200; nocase; content:"InsertImage"; within:11; distance:2; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3184; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-059; classtype:attempted-user; sid:27616; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer MoveToMarkupPointer call with CControlTracker OnExitTree use-after-free attempt"; flow:to_client,established; file_data; content:".innerText="; nocase; content:"body.contentEditable"; fast_pattern:only; content:"false"; nocase; content:"execCommand"; within:200; nocase; content:"InsertImage"; within:11; distance:2; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3184; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-059; classtype:attempted-user; sid:27615; rev:6;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CElement use-after-free attempt"; flow:to_server,established; file_data; content:"document.execCommand"; nocase; content:"SelectAll"; within:9; distance:2; nocase; content:"document.execCommand"; within:200; content:"RemoveFormat"; within:12; distance:2; nocase; content:"document.getElementsByTagName"; within:200; nocase; content:"tbody"; within:5; distance:2; nocase; content:".innerHTML ="; within:12; distance:5; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3193; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-059; classtype:attempted-user; sid:27614; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CElement use-after-free attempt"; flow:to_client,established; file_data; content:"document.execCommand"; nocase; content:"SelectAll"; within:9; distance:2; nocase; content:"document.execCommand"; within:200; content:"RemoveFormat"; within:12; distance:2; nocase; content:"document.getElementsByTagName"; within:200; nocase; content:"tbody"; within:5; distance:2; nocase; content:".innerHTML ="; within:12; distance:5; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3193; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-059; classtype:attempted-user; sid:27613; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CMarkupPointer with SVG use-after-free attempt"; flow:to_client,established; file_data; content:"document.createRange()"; fast_pattern:only; content:"setStart"; nocase; content:"insertNode"; within:40; nocase; content:"insertNode"; within:25; nocase; content:"setStart"; within:25; nocase; content:"document.write"; within:40; nocase; content:"<svg"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3194; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-059; classtype:attempted-user; sid:27612; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode object CSS text overflow attempt"; flow:to_client,established; file_data; content:"text-overflow|3A|ellipsis|3B|overflow-x|3A|hidden"; nocase; content:"onload=|22|"; within:100; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3189; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-059; classtype:attempted-dos; sid:27608; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer content generation use after free attempt"; flow:to_client,established; file_data; content:".setAttribute("; content:"<svg>"; nocase; content:" id="; within:30; nocase; content:" id="; within:30; nocase; content:"surroundContents("; fast_pattern:only; content:"surroundContents("; nocase; content:"document.getElementById("; within:24; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3187; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-059; classtype:attempted-user; sid:27607; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSelectionManager use after free attempt"; flow:to_client,established; file_data; content:"document.write|28|"; nocase; content:".className=|22|"; within:100; nocase; content:"document.execCommand|28 22|Undo|22 29|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3199; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-059; classtype:attempted-admin; sid:27606; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer TreeNode use after free attempt"; flow:to_client,established; file_data; content:"style.unicodeBidi"; fast_pattern:only; content:"document.body.innerHTML"; nocase; pcre:"/var\s*(?P<obj>\w+)\s*=\s*document\.createElement.*?(?P=obj)\.innerHTML\s*=\s*"\??"\s*\x3b.*?\w+\.appendChild\(\s*(?P=obj)\s*\).*?(?P=obj)\.style\.unicodeBidi/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3188; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-059; classtype:attempted-user; sid:27605; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 memory disclosure attempt"; flow:to_client,established; file_data; content:"event.data.replace("; fast_pattern; nocase; content:"/|5C|0/g"; within:10; content:".postMessage("; nocase; content:"|5C|0"; within:25; content:"X-UA-Compatible"; metadata:service http; reference:bugtraq,53844; reference:cve,2012-1873; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-037; classtype:attempted-recon; sid:27663; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 9 deleted object access memory corruption attempt"; flow:to_server,established; file_data; content:"onload="; nocase; content:"execCommand|28 22|Justify"; within:30; distance:1; nocase; content:"<script>"; within:45; nocase; content:"execCommand|28 22|SelectAll"; within:32; nocase; content:"</script>"; within:12; nocase; content:"<select>"; within:82; nocase; content:"<script>"; within:25; nocase; content:"execCommand|28 22|Justify"; within:50; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,57832; reference:cve,2013-0026; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009; classtype:attempted-user; sid:27717; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 deleted object access memory corruption attempt"; flow:to_client,established; file_data; content:"onload="; nocase; content:"execCommand|28 22|Justify"; within:30; distance:1; nocase; content:"<script>"; within:45; nocase; content:"execCommand|28 22|SelectAll"; within:32; nocase; content:"</script>"; within:12; nocase; content:"<select>"; within:82; nocase; content:"<script>"; within:25; nocase; content:"execCommand|28 22|Justify"; within:50; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,57832; reference:cve,2013-0026; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009; classtype:attempted-user; sid:27716; rev:1;)
alert tcp any any -> $HOME_NET 25 (msg:"BROWSER-IE Microsoft Internet Explorer iframe execCommand use after free attempt"; flow:to_server,established; file_data; content:"<object data="; content:"onload="; within:64; content:".contentDocument|3B|"; content:".execCommand|28|"; within:64; nocase; content:".execCommand|28|"; within:64; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3208; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-069; classtype:attempted-user; sid:27846; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer iframe execCommand use after free attempt"; flow:to_client,established; file_data; content:"<object data="; content:"onload="; within:64; content:".contentDocument|3B|"; content:".execCommand|28|"; within:64; nocase; content:".execCommand|28|"; within:64; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3208; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-069; classtype:attempted-user; sid:27845; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos object use-after-free attempt"; flow:to_server,established; file_data; content:"document.getElementsByTagName"; nocase; content:"|28 22|textarea|22 29|"; within:12; nocase; content:"innerHTML"; within:60; nocase; content:"<blockcode>"; within:15; nocase; content:"document.getElementsByTagName"; within:60; nocase; content:"|28 22|textarea|22 29|"; within:12; nocase; content:"<textarea><script>"; within:200; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3845; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-069; classtype:attempted-user; sid:27844; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos object use-after-free attempt"; flow:to_client,established; file_data; content:"document.getElementsByTagName"; nocase; content:"|28 22|textarea|22 29|"; within:12; nocase; content:"innerHTML"; within:60; nocase; content:"<blockcode>"; within:15; nocase; content:"document.getElementsByTagName"; within:60; nocase; content:"|28 22|textarea|22 29|"; within:12; nocase; content:"<textarea><script>"; within:200; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3845; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-069; classtype:attempted-user; sid:27843; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSegment object use after free attempt"; flow:to_client,established; file_data; content:"for=|22|document|22| event=|22|onreadystatechange|22|>g()"; fast_pattern:only; content:"fieldset style=|22|border:expression(f())"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3209; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-069; classtype:attempted-user; sid:27842; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 MutationEvent use after free attempt"; flow:to_client,established; file_data; content:"initMutationEvent("; content:"DOMNodeRemoved"; within:30; content:"initMutationEvent("; within:200; content:"DOMNodeRemoved"; within:30; pcre:"/initMutationEvent\x28\s*[\x22\x27]?DOMNodeRemoved[\x22\x27]?\s*,([^,]+,){2}\s*(?P<relatedNode>[^,]+)\s*,([^,]+,){2}\s*(?P<attrName>[^,]+)\s*,.*?initMutationEvent\x28\s*[\x22\x27]?DOMNodeRemoved[\x22\x27]?\s*,[^,]+,\s*(false|0)\s*,\s*(?P=relatedNode)\s*,([^,]+,){2}\s*(?P=attrName)\s*,\s*(modification|1)\s*\x29/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-3207; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-069; classtype:attempted-admin; sid:27841; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer range markup switch use after free attempt"; flow:to_server,established; file_data; content:"document.createRange("; fast_pattern; nocase; content:".selectNode("; within:50; nocase; content:".deleteContents("; within:50; nocase; content:".insertNode("; within:50; nocase; content:".reload("; within:50; nocase; content:"<object "; distance:0; nocase; pcre:"/var\s+?(?P<obj>[^\s=\x3b]+?)\s*?=\s*?document\.createRange\(.*?(?P=obj)\.selectNode\(\s*?(?P<sel>[^\s\)\x3b]+?)\s*?\).*?(?P=obj)\.deleteContents\(.*?(?P=obj)\.insertNode\(\s*?(?P=sel)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3206; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-069; classtype:attempted-user; sid:27840; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer range markup switch use after free attempt"; flow:to_client,established; file_data; content:"document.createRange("; fast_pattern; nocase; content:".selectNode("; within:50; nocase; content:".deleteContents("; within:50; nocase; content:".insertNode("; within:50; nocase; content:".reload("; within:50; nocase; content:"<object "; distance:0; nocase; pcre:"/var\s+?(?P<obj>[^\s=\x3b]+?)\s*?=\s*?document\.createRange\(.*?(?P=obj)\.selectNode\(\s*?(?P<sel>[^\s\)\x3b]+?)\s*?\).*?(?P=obj)\.deleteContents\(.*?(?P=obj)\.insertNode\(\s*?(?P=sel)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3206; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-069; classtype:attempted-user; sid:27839; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CDisplayPointer use after free attempt"; flow:to_server,established; file_data; content:"document.write|28|"; nocase; content:"catch (err)"; within:25; distance:5; nocase; content:"document.body.contentEditable"; within:75; distance:20; nocase; content:"document.execCommand|28|"; within:55; distance:25; nocase; content:"document.body.innerHTML +="; within:55; distance:200; nocase; content:"catch |28|err|29|"; within:25; distance:5; nocase; content:"|3C|body onbeforeeditfocus=eval|28|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3205; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-069; classtype:attempted-user; sid:27838; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CDisplayPointer use after free attempt"; flow:to_client,established; file_data; content:"document.write|28|"; nocase; content:"catch |28|err|29|"; within:25; distance:5; nocase; content:"document.body.contentEditable"; within:75; distance:20; nocase; content:"document.execCommand|28|"; within:55; distance:25; nocase; content:"document.body.innerHTML +="; within:55; distance:200; nocase; content:"catch |28|err|29|"; within:25; distance:5; nocase; content:"|3C|body onbeforeeditfocus=eval|28|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3205; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-069; classtype:attempted-user; sid:27837; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer AddOption use after free attempt"; flow:to_server,established; file_data; content:"document.getElementsByTagName|28 22|select|22 29 5B|0|5D 3B|"; nocase; content:"document.getElementsByTagName|28 22|select|22 29 5B|0|5D 3B|"; within:200; nocase; content:".options.remove|28 29 3B|"; within:100; nocase; content:".getElementsByTagName|28 22|option|22 29 5B|0|5D 3B|"; within:200; nocase; content:".add|28|"; within:100; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3204; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-069; classtype:attempted-user; sid:27836; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer AddOption use after free attempt"; flow:to_client,established; file_data; content:"document.getElementsByTagName|28 22|select|22 29 5B|0|5D 3B|"; nocase; content:"document.getElementsByTagName|28 22|select|22 29 5B|0|5D 3B|"; within:200; nocase; content:".options.remove|28 29 3B|"; within:100; nocase; content:".getElementsByTagName|28 22|option|22 29 5B|0|5D 3B|"; within:200; nocase; content:".add|28|"; within:100; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3204; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-069; classtype:attempted-user; sid:27835; rev:2;)
alert tcp any any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer javascript apply method type confusion attempt"; flow:to_server,established; file_data; content:".onfocus|3B|"; nocase; content:".apply|28|"; within:64; nocase; content:"0x"; within:5; content:"onload="; content:"onfocus="; within:32; pcre:"/<script((?!<\/script).)*?(var|function)\s*\w+\s*(=\s*function\s*\x28\s*\x29)?((?!<\/script).)*?(var\s*)?(?P<var>\w+)\s*=\s*\w+\.(onfocus|onload)\x3b((?!<\/script).)*?(?P=var)\.apply\x28\s*0x/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3203; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-069; classtype:attempted-user; sid:27834; rev:1;)
alert tcp any any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer javascript call method type confusion attempt"; flow:to_server,established; file_data; content:".onfocus|3B|"; nocase; content:".call|28|"; within:64; nocase; content:"0x"; within:5; content:"onload="; content:"onfocus="; within:32; pcre:"/<script((?!<\/script).)*?(var|function)\s*\w+\s*(=\s*function\s*\x28\s*\x29)?((?!<\/script).)*?(var\s*)?(?P<var>\w+)\s*=\s*\w+\.(onfocus|onload)\x3b((?!<\/script).)*?(?P=var)\.call\x28\s*0x/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3203; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-069; classtype:attempted-user; sid:27833; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer javascript apply method type confusion attempt"; flow:to_client,established; file_data; content:".onfocus|3B|"; nocase; content:".apply|28|"; within:64; nocase; content:"0x"; within:5; content:"onload="; content:"onfocus="; within:32; pcre:"/<script((?!<\/script).)*?(var|function)\s*\w+\s*(=\s*function\s*\x28\s*\x29)?((?!<\/script).)*?(var\s*)?(?P<var>\w+)\s*=\s*\w+\.(onfocus|onload)\x3b((?!<\/script).)*?(?P=var)\.apply\x28\s*0x/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3203; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-069; classtype:attempted-user; sid:27832; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer javascript call method type confusion attempt"; flow:to_client,established; file_data; content:".onfocus|3B|"; nocase; content:".call|28|"; within:64; nocase; content:"0x"; within:5; content:"onload="; content:"onfocus="; within:32; pcre:"/<script((?!<\/script).)*?(var|function)\s*\w+\s*(=\s*function\s*\x28\s*\x29)?((?!<\/script).)*?(var\s*)?(?P<var>\w+)\s*=\s*\w+\.(onfocus|onload)\x3b((?!<\/script).)*?(?P=var)\.call\x28\s*0x/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3203; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-069; classtype:attempted-user; sid:27831; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS any (msg:"BROWSER-IE Microsoft Internet Explorer hgroup element DOM reset use after free attempt"; flow:to_server,established; file_data; content:"getElementsByTagName(|22|hgroup|22|)"; content:"<table>"; nocase; content:"<hgroup>"; within:100; nocase; content:"<section>"; nocase; content:!"</section>"; within:400; nocase; content:"<address>"; nocase; content:!"</address>"; within:400; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3202; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-069; classtype:attempted-user; sid:27830; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer hgroup element DOM reset use after free attempt"; flow:to_client,established; file_data; content:"getElementsByTagName(|22|hgroup|22|)"; content:"<table>"; nocase; content:"<hgroup>"; within:100; nocase; content:"<section>"; nocase; content:!"</section>"; within:400; nocase; content:"<address>"; nocase; content:!"</address>"; within:400; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3202; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-069; classtype:attempted-user; sid:27829; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CPhraseElement use after free attempt"; flow:to_server,established; file_data; content:"mstime_malloc("; fast_pattern:only; content:"urn:schemas-microsoft-com:time"; nocase; content:":ANIMATECOLOR"; nocase; pcre:"/mstime_malloc\([^\)]+?objId:\s*?[\x22\x27](?P<smil_obj>[^\x22\x27]+)[\x22\x27].*?:ANIMATECOLOR[^>]+?id\s*?=\s*?[\x22\x27]?(?P=smil_obj)/smi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:bugtraq,60975; reference:cve,2013-3163; reference:url,osvdb.org/show/osvdb/94981; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-055; classtype:attempted-user; sid:27909; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CPhraseElement use after free attempt"; flow:to_client,established; file_data; content:"mstime_malloc("; fast_pattern:only; content:"urn:schemas-microsoft-com:time"; nocase; content:":ANIMATECOLOR"; nocase; pcre:"/mstime_malloc\([^\)]+?objId:\s*?[\x22\x27](?P<smil_obj>[^\x22\x27]+)[\x22\x27].*?:ANIMATECOLOR[^>]+?id\s*?=\s*?[\x22\x27]?(?P=smil_obj)/smi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,60975; reference:cve,2013-3163; reference:url,osvdb.org/show/osvdb/94981; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-055; classtype:attempted-user; sid:27908; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer onlosecapture memory corruption attempt"; flow:to_server,established; file_data; content:".applyElement"; content:".onlosecapture"; within:500; fast_pattern; content:".setCapture"; within:500; content:".setCapture"; within:500; pcre:"/\x2eapplyElement\s*\x28\s*(?P<var>\w+)\s*\x29.*?(?P=var)\x2eonlosecapture\s*=.*?(?P=var)\x2esetCapture\s*\x28.*?\x2esetCapture\s*\x28/smiO"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,62453; reference:cve,2013-3893; reference:url,osvdb.org/show/osvdb/97380; reference:url,technet.microsoft.com/en-us/security/advisory/2887505; classtype:attempted-user; sid:27944; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer onlosecapture memory corruption attempt"; flow:to_client,established; file_data; content:".applyElement"; content:".onlosecapture"; within:500; fast_pattern; content:".setCapture"; within:500; content:".setCapture"; within:500; pcre:"/\x2eapplyElement\s*\x28\s*(?P<var>\w+)\s*\x29.*?(?P=var)\x2eonlosecapture\s*=.*?(?P=var)\x2esetCapture\s*\x28.*?\x2esetCapture\s*\x28/smiO"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,62453; reference:cve,2013-3893; reference:url,osvdb.org/show/osvdb/97380; reference:url,technet.microsoft.com/en-us/security/advisory/2887505; classtype:attempted-user; sid:27943; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 null character in string information disclosure attempt"; flow:to_client,established; file_data; content:"http-equiv=|22|X-UA-Compatible|22|"; nocase; content:"string.fromCharcode|28|0|29|"; fast_pattern:only; pcre:"/var\s+\w+\s+\x3D\s*\x22+[^\x22]+\x22\s*\x2B.*?String\.fromCharCode\x280\x29.*?\x22/Bsmi"; metadata:policy max-detect-ips drop, service http; reference:cve,2012-0012; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-010; classtype:attempted-recon; sid:28112; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted object memory corruption attempt"; flow:to_client,established; file_data; content:"getElementsByTagName"; nocase; content:"nosmartquotes"; within:30; nocase; content:"onreadystatechange"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-3886; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-080; classtype:attempted-user; sid:28204; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer HtmlLayout SmartObject use after free attempt"; flow:to_client,established; file_data; content:"|3C|table"; nocase; content:"|3C|colgroup"; within:100; nocase; content:"|3C 2F|colgroup|3E|"; within:50; distance:1; nocase; content:"|3C|style"; distance:0; nocase; content:"colgroup|7B|"; distance:0; nocase; content:"display|3A|"; within:10; nocase; content:"none"; within:8; nocase; content:"|3C|script"; nocase; content:"document.execCommand|28|"; within:200; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2013-3873; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-080; classtype:attempted-user; sid:28163; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CElement use after free attempt"; flow:to_client,established; file_data; content:".execCommand('Delete', false)"; nocase; content:".execCommand"; within:200; nocase; content:"removeformat"; within:50; nocase; content:".execCommand"; within:400; distance:-200; nocase; content:"delete"; within:50; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3874; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-080; classtype:attempted-user; sid:28160; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CLayoutBlock use after free attempt"; flow:to_server,established; file_data; content:"document.write("; nocase; content:"<ruby>"; within:15; distance:1; fast_pattern; nocase; content:"document.getElementsByTagName("; within:150; nocase; content:".length"; within:25; distance:4; nocase; content:"document.getElementsByTagName("; within:55; distance:6; nocase; content:"|5D|.clientWidth|3B|"; within:35; distance:5; nocase; pcre:"/function\s*?(?P<ruby1>\w+).*?document\.write\x28\s*?[\x22\x27]\s*?\x3c\s*?ruby\s*?\x3e\s*?[\x22\x27].*?function\s*?(?P<enum>\w+).*?for\s*?\x28\s*?\w+\x3d\s*?0\s*?\x3b\s*?\w+\s*?\x3c\s*?document\.getElementsByTagName\x28\s*?[\x22\x27]\s*?(?P<badtag>\w+)\s*?[\x22\x27]\s*?\x29\.length\s*?\x3b\s*?\w+\x2b\x2b\s*?\x29.*?document\.getElementsByTagName\x28\s*?[\x22\x27](?P=badtag)\s*?[\x22\x27]\s*?\x29\s*?\x5b.*?\x5d\.clientWidth.*?\x3cruby\x3e.*?\x3cscript\x3e\s*?(?P=ruby1).*?\x3cscript\x3e\s*?(?P=enum).*?\x3cscript\x3e(?P=enum)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3875; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-080; classtype:attempted-user; sid:28159; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CLayoutBlock use after free attempt"; flow:to_client,established; file_data; content:"document.write("; nocase; content:"<ruby>"; within:15; distance:1; fast_pattern; nocase; content:"document.getElementsByTagName("; within:150; nocase; content:".length"; within:25; distance:4; nocase; content:"document.getElementsByTagName("; within:55; distance:6; nocase; content:"|5D|.clientWidth|3B|"; within:35; distance:5; nocase; pcre:"/function\s*?(?P<ruby1>\w+).*?document\.write\x28\s*?[\x22\x27]\s*?\x3c\s*?ruby\s*?\x3e\s*?[\x22\x27].*?function\s*?(?P<enum>\w+).*?for\s*?\x28\s*?\w+\x3d\s*?0\s*?\x3b\s*?\w+\s*?\x3c\s*?document\.getElementsByTagName\x28\s*?[\x22\x27]\s*?(?P<badtag>\w+)\s*?[\x22\x27]\s*?\x29\.length\s*?\x3b\s*?\w+\x2b\x2b\s*?\x29.*?document\.getElementsByTagName\x28\s*?[\x22\x27](?P=badtag)\s*?[\x22\x27]\s*?\x29\s*?\x5b.*?\x5d\.clientWidth.*?\x3cruby\x3e.*?\x3cscript\x3e\s*?(?P=ruby1).*?\x3cscript\x3e\s*?(?P=enum).*?\x3cscript\x3e(?P=enum)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3875; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-080; classtype:attempted-user; sid:28158; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer STextBlockPosition use after free attempt"; flow:to_client,established; file_data; content:"thead"; fast_pattern:only; content:"caption"; content:"getElement"; pcre:"/\.getElements?By(Id|TagName)\x28\s*[\x22\x27]caption[\x22\x27]\s*\x29.*?innerHTML\s*\x3d\s*[\x22\x27]\x3cthead/sm"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3885; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-080; classtype:attempted-user; sid:28151; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer swapNode memory corruption attempt"; flow:to_server,established; file_data; content:".onpropertychange"; nocase; content:"execCommand"; within:500; nocase; content:".onselect"; nocase; content:".swapNode"; within:500; fast_pattern; nocase; pcre:"/\x2eappendChild\s*\x28\s*(?P<var>\w+)\s*\x29.*?(?P=var)\x2eonselect[^\x7d]+\x2eswapNode.*?(?P=var)\x2eselect/smiO"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,62811; reference:cve,2013-3897; reference:url,osvdb.org/show/osvdb/98207; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-080; classtype:attempted-user; sid:28208; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer swapNode memory corruption attempt"; flow:to_client,established; file_data; content:".onpropertychange"; nocase; content:"execCommand"; within:500; nocase; content:".onselect"; nocase; content:".swapNode"; within:500; fast_pattern; nocase; pcre:"/\x2eappendChild\s*\x28\s*(?P<var>\w+)\s*\x29.*?(?P=var)\x2eonselect[^\x7d]+\x2eswapNode.*?(?P=var)\x2eselect/smiO"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,62811; reference:cve,2013-3897; reference:url,osvdb.org/show/osvdb/98207; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-080; classtype:attempted-user; sid:28207; rev:7;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer javascript call method type confusion attempt"; flow:to_server,established; file_data; content:".onfocus"; nocase; content:".call|28|"; within:64; nocase; content:"onclick="; content:"onfocus="; within:64; pcre:"/<script((?!<\/script).)*?(var|function)\s*\w+\s*(=\s*function\s*\x28\s*\x29)?((?!<\/script).)*?(var\s*)?(?P<var>\w+)(\s*=\s*\w+)?\.(onclick|onfocus|onload)\.(call|apply)\x28\s*(0x)?\d+/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3203; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-069; classtype:attempted-user; sid:28232; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer javascript call method type confusion attempt"; flow:to_client,established; file_data; content:".onfocus"; nocase; content:".call|28|"; within:64; nocase; content:"onclick="; content:"onfocus="; within:64; pcre:"/<script((?!<\/script).)*?(var|function)\s*\w+\s*(=\s*function\s*\x28\s*\x29)?((?!<\/script).)*?(var\s*)?(?P<var>\w+)(\s*=\s*\w+)?\.(onclick|onfocus|onload)\.(call|apply)\x28\s*(0x)?\d+/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3203; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-069; classtype:attempted-user; sid:28231; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted object cells reference memory corruption vulnerability"; flow:to_client,established; file_data; content:"cells.item"; nocase; content:"outerText"; distance:0; nocase; pcre:"/([A-Z0-9_]+)\.cells\.item.*?\1\.outerText/smi"; metadata:policy max-detect-ips drop, service http; reference:cve,2010-0248; classtype:attempted-user; sid:28287; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer htmlfile null attribute access attempt"; flow:to_server,established; file_data; content:"25336920-03F9-11CF-8FD0-00AA00686F13"; fast_pattern:only; content:".attributes["; nocase; pcre:"/<object[^>]+id\s*?=\s*?[\x22\x27]?([A-Z\d]+)[\x22\x27]?[^>]+classid\s*?=\s*?[\x22\x27]?clsid\x3A25336920-03F9-11CF-8FD0-00AA00686F13[\x22\x27]?.*?\1\.attributes.*?for\s*\x28[^\x29]+\1\.attributes\x5B/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,49960; reference:cve,2011-1995; reference:url,osvdb.org/show/osvdb/76207; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-081; classtype:attempted-user; sid:28271; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer option element use after free attempt"; flow:to_server,established; file_data; content:"imgarray|5B|i|5D|.title = fakeobj.substring|28|0, 0x38 / 2 - 1|29 3B|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2011-1995; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-081; classtype:attempted-user; sid:28270; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer option element use after free attempt"; flow:to_server,established; file_data; content:"bigarray|5B|k|5D 5B|i|5D|.title = fakeobj.substring|28|0, 0x38 / 2 - 1|29 3B|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2011-1995; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-081; classtype:attempted-user; sid:28269; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer option element use after free attempt"; flow:to_client,established; file_data; content:"imgarray|5B|i|5D|.title = fakeobj.substring|28|0, 0x38 / 2 - 1|29 3B|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2011-1995; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-081; classtype:attempted-user; sid:28268; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer option element use after free attempt"; flow:to_client,established; file_data; content:"bigarray|5B|k|5D 5B|i|5D|.title = fakeobj.substring|28|0, 0x38 / 2 - 1|29 3B|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2011-1995; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-081; classtype:attempted-user; sid:28267; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer object management memory corruption attempt"; flow:to_server,established; file_data; content:".onpropertychange"; nocase; content:".childNode"; within:50; nocase; content:".onpropertychange"; distance:0; nocase; content:"null"; within:50; nocase; pcre:"/(?P<q1>[A-Z\d_]+)\.onpropertychange\s*=\s*(?P=q1)\.childNode.*?(?P=q1)\.onpropertychange\s*=\s*null.*?(?P=q1)\.onpropertychange/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,46821; reference:cve,2011-1345; reference:url,osvdb.org/show/osvdb/71725; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-018; classtype:attempted-user; sid:28259; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer object management memory corruption attempt"; flow:to_server,established; file_data; content:".onpropertychange"; nocase; content:".attributes"; within:50; nocase; content:".onpropertychange"; distance:0; nocase; content:"null"; within:50; nocase; pcre:"/(?P<q1>[A-Z\d_]+)\.onpropertychange\s*=\s*(?P=q1)\.attributes.*?(?P=q1)\.onpropertychange\s*=\s*null.*?(?P=q1)\.onpropertychange/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,46821; reference:cve,2011-1345; reference:url,osvdb.org/show/osvdb/71725; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-018; classtype:attempted-user; sid:28258; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CSS expression defined to empty selection attempt"; flow:to_server,established; file_data; content:"expression"; nocase; content:"document.selection.empty"; within:50; pcre:"/expression\s*\x28\s*document\x2eselection\x2eempty\s*\x28\s*\x29\s*\x29/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,48210; reference:cve,2011-1261; reference:url,osvdb.org/show/osvdb/72951; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-user; sid:28306; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer iframe onreadystatechange handler use after free attempt"; flow:to_server,established; file_data; content:".getElement"; nocase; content:"iframe"; within:25; nocase; content:".onreadystatechange"; within:75; fast_pattern; nocase; pcre:"/\x2eonreadystatechange\s*=\s*(?P<del_func>\w+)\s*\x3b.*?function\s+(?P=del_func)\s*\x28[^\x7b]*?\x7b[^\x7d]*?\x2e(?:innerHTML\s*=|outerHTML\s*=|write)/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,52904; reference:cve,2012-0170; reference:url,osvdb.org/show/osvdb/81128; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-023; classtype:attempted-user; sid:28364; rev:6;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer iframe onreadystatechange handler use after free attempt"; flow:to_server,established; file_data; content:"<iframe"; nocase; content:"onreadystatechange"; within:75; fast_pattern; nocase; pcre:"/function\s+(?P<del_func>\w+)\s*\x28[^\x7b]*?\x7b[^\x7d]*?\x2e(?:innerHTML\s*=|outerHTML\s*=|write).*?<iframe[^>]+onreadystatechange\s*=\s*[\x22\x27]\s*(?P=del_func)/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,52904; reference:cve,2012-0170; reference:url,osvdb.org/show/osvdb/81128; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-023; classtype:attempted-user; sid:28363; rev:6;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer DOM manipulation memory corruption attempt"; flow:to_server,established; file_data; content:"|5D|.fireEvent|28|"; fast_pattern:only; content:"document.getElementsByTagName|28|"; nocase; content:"<div "; nocase; content:"<img "; within:200; nocase; content:"<div "; within:200; nocase; content:".innerHTML"; distance:0; nocase; pcre:"/<img[^>]+id\s*=\s*(?P<q1>\x22|\x27|)(?P<id>[^\x22\x27\x20]+)(?P=q1)[^>]*?>.*?<div[^>]+id\s*=\s*(\x22|\x27|)(?P=id)/smi"; pcre:"/<div[^>]+id\s*=\s*(\x22|\x27|)(?P<id>[^\x22\x27\x20\x3E]+)[^>]*>.*?(?P=id)\.innerHTML/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,53847; reference:cve,2012-1875; reference:url,osvdb.org/show/osvdb/82865; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-037; classtype:attempted-user; sid:28360; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer DOM manipulation memory corruption attempt"; flow:to_server,established; file_data; content:"|7B|eval|28 22|imgABC|22 29|.src|3D 22 22 3B 7D|"; fast_pattern:only; content:"<div "; nocase; content:"<img "; within:200; nocase; content:"<div "; within:200; nocase; content:".innerHTML"; distance:0; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,53847; reference:cve,2012-1875; reference:url,osvdb.org/show/osvdb/82865; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-037; classtype:attempted-user; sid:28359; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer DOM manipulation memory corruption attempt"; flow:to_client,established; file_data; content:"span_tags|5B|0|5D|.fireEvent|28 27|onBlur|27 29|"; fast_pattern:only; content:"|3C|span id|3D 22|duplicate|22| onBlur|3D 22|use|28 29 22 2F 3E|"; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,53847; reference:cve,2012-1875; reference:url,osvdb.org/show/osvdb/82865; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-037; classtype:attempted-user; sid:28358; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer DOM manipulation memory corruption attempt"; flow:to_server,established; file_data; content:"|3C|DIV id|3D|testfaild|3E|"; fast_pattern:only; content:"|3C|script|3E|document.write|28 28|function|28|"; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,53847; reference:cve,2012-1875; reference:url,osvdb.org/show/osvdb/82865; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-037; classtype:attempted-user; sid:28357; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer DOM manipulation memory corruption attempt"; flow:to_client,established; file_data; content:"|3C|DIV id|3D|testfaild|3E|"; fast_pattern:only; content:"|3C|script|3E|document.write|28 28|function|28|"; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,53847; reference:cve,2012-1875; reference:url,osvdb.org/show/osvdb/82865; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-037; classtype:attempted-user; sid:28356; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer DOM manipulation memory corruption attempt"; flow:to_server,established; file_data; content:"span_tags|5B|0|5D|.fireEvent|28 27|onBlur|27 29|"; fast_pattern:only; content:"|3C|span id|3D 22|duplicate|22| onBlur|3D 22|use|28 29 22 2F 3E|"; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,53847; reference:cve,2012-1875; reference:url,osvdb.org/show/osvdb/82865; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-037; classtype:attempted-user; sid:28355; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer DOM manipulation memory corruption attempt"; flow:to_client,established; file_data; content:"|7B|eval|28 22|imgABC|22 29|.src|3D 22 22 3B 7D|"; fast_pattern:only; content:"<div "; nocase; content:"<img "; within:200; nocase; content:"<div "; within:200; nocase; content:".innerHTML"; distance:0; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,53847; reference:cve,2012-1875; reference:url,osvdb.org/show/osvdb/82865; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-037; classtype:attempted-user; sid:28354; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTableLayout memory corruption attempt"; flow:to_server,established; file_data; content:"document.getElement"; nocase; content:".onpropertychange"; within:75; fast_pattern; nocase; content:"function"; within:75; nocase; content:"<table"; distance:0; nocase; content:"<col"; within:75; nocase; pcre:"/\x2eonpropertychange\s*=\s*function\s*\x28\s*\x29\s*\x7b[^\x7d]+?\x2e(inner|outer)HTML(\s*=\s*[\x22\x27]\s*[\x22\x27]|\x2b\x2b)/smi"; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,37891; reference:cve,2010-0244; reference:url,osvdb.org/show/osvdb/61910; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-002; classtype:attempted-user; sid:28353; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTableLayout memory corruption attempt"; flow:to_server,established; file_data; content:"document.getElement"; nocase; content:".onpropertychange"; within:75; fast_pattern; nocase; content:"window."; within:75; nocase; content:"<table"; distance:0; nocase; content:"<col"; within:75; nocase; pcre:"/var\s+(?P<del_func>\w+)\s*=\s*function\s*\x28\s*\x29\s*\x7b[^\x7d]+?\x2e(inner|outer)HTML\s*=\s*[\x22\x27]\s*[\x22\x27].*?\x2eonpropertychange\s*=\s*window\x2e(?P=del_func)/smi"; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,37891; reference:cve,2010-0244; reference:url,osvdb.org/show/osvdb/61910; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-002; classtype:attempted-user; sid:28352; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer style.position use-after-free memory corruption attempt"; flow:to_client,established; file_data; content:"focus()"; nocase; content:"style.position"; within:48; nocase; content:"v:textbox contenteditable=|22|true|22|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0011; reference:cve,2012-0155; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-010; classtype:attempted-dos; sid:28447; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer generic use after free attempt"; flow:to_server,established; file_data; content:"onload="; nocase; content:"onselectstart="; within:64; nocase; content:"execCommand("; content:"InsertInputReset"; within:20; content:"body.contentEditable"; content:"true"; within:10; content:"body.contentEditable"; distance:0; content:"false"; within:10; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3916; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-088; classtype:attempted-recon; sid:28524; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer generic use after free attempt"; flow:to_client,established; file_data; content:"onload="; nocase; content:"onselectstart="; within:64; nocase; content:"execCommand("; content:"InsertInputReset"; within:20; content:"body.contentEditable"; content:"true"; within:10; content:"body.contentEditable"; distance:0; content:"false"; within:10; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3916; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-088; classtype:attempted-user; sid:28523; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"BROWSER-IE Microsoft Internet Explorer print preview information disclosure attempt"; flow:to_server,established; content:"User-Agent|3A|"; nocase; http_header; content:"MSIE"; within:64; http_header; content:"<script"; http_uri; content:"src="; distance:0; http_uri; metadata:service http; reference:cve,2013-3908; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-088; classtype:attempted-recon; sid:28522; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer undo use after free attempt"; flow:to_client,established; file_data; content:"applyElement|28|"; content:"execCommand|28 22|InsertInputHidden|22 29 3B|"; content:"innerHTML|3D 22 22 3B|"; within:35; content:"CollectGarbage|28 29|"; within:30; content:"execCommand|28 22|Undo|22 29 3B|"; within:55; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3915; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-088; classtype:attempted-user; sid:28504; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer createRange user after free attempt"; flow:to_client,established; file_data; content:" document.body.innerHTML +="; content:" document.execCommand|28|"; within:100; content:".createRange|28|"; distance:0; metadata:policy balanced-ips alert, policy security-ips drop, service http; reference:cve,2013-3910; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-088; classtype:attempted-user; sid:28496; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer execCommand CTreePos memory corruption attempt"; flow:to_server,established; file_data; content:".execCommand"; nocase; content:"undo"; within:15; nocase; content:".execCommand"; within:100; nocase; content:"redo"; within:15; nocase; content:".execCommand"; within:100; nocase; content:"undo"; within:15; nocase; pcre:"/\x2eexecCommand\s*\x28\s*[\x22\x27]\s*undo\s*[\x22\x27].*?\x2eexecCommand\s*\x28\s*[\x22\x27]\s*redo\s*[\x22\x27].*?\x2eexecCommand\s*\x28\s*[\x22\x27]\s*undo\s*[\x22\x27]/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3914; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-088; classtype:attempted-user; sid:28495; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer execCommand CTreePos memory corruption attempt"; flow:to_client,established; file_data; content:".execCommand"; nocase; content:"undo"; within:15; nocase; content:".execCommand"; within:100; nocase; content:"redo"; within:15; nocase; content:".execCommand"; within:100; nocase; content:"undo"; within:15; nocase; pcre:"/\x2eexecCommand\s*\x28\s*[\x22\x27]\s*undo\s*[\x22\x27].*?\x2eexecCommand\s*\x28\s*[\x22\x27]\s*redo\s*[\x22\x27].*?\x2eexecCommand\s*\x28\s*[\x22\x27]\s*undo\s*[\x22\x27]/smi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3914; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-088; classtype:attempted-user; sid:28494; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer freed CTreePos object use-after-free attempt"; flow:to_client,established; file_data; content:"function selectRange(nodes"; nocase; content:"removeAllRanges()"; within:80; nocase; content:"selectRange(nodes"; distance:0; nocase; content:"document.selection.createRange().pasteHTML"; within:100; nocase; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service http; reference:cve,2013-3912; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-088; classtype:attempted-user; sid:28492; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CEditAdorner use after free attempt"; flow:to_client,established; file_data; content:".createElement|28|"; content:"canvas"; within:7; distance:1; content:".createControlRange|28 29|"; within:100; content:".select|28 29|"; within:100; content:".addBehavior"; within:100; content:"#default#VML"; within:17; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3911; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-088; classtype:attempted-user; sid:28491; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted object memory corruption attempt"; flow:to_client,established; file_data; content:"outerHTML"; nocase; content:"document.execCommand"; within:100; nocase; content:"designMode=|22|off|22|"; within:200; nocase; content:"contenteditable=|22|true|22|"; within:200; fast_pattern; content:"onresize=|22|"; within:200; nocase; pcre:"/outerhtml\s*?\+\=\s*?\x22/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-3917; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-088; classtype:attempted-user; sid:28490; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CAnchorElement use after free attempt"; flow:to_client,established; file_data; content:"name"; content:"window.navigate|28|"; distance:0; content:"document.open|28|"; within:100; pcre:"/a\sname\s*=\s*(\x22|\x27)(?P<anchor>\w+).*?window\.navigate\x28(\x22|\x27)\x23(?P=anchor)(\x22|\x27)\x29.*?document\.open\x28(\x22|\x27)(?!(?P=anchor))/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2013-3871; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-088; classtype:attempted-user; sid:28489; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer address bar spoofing attempt"; flow:to_server,established; file_data; content:"|D6 FD 91 46 E0 43 B0 89 8E B9 F0 CB 32 45 EE D4 7D 81 16 4B 39 22 32 93 15 A2 56 98 EA 38|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,17404; reference:cve,2006-1626; classtype:attempted-user; sid:28663; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer address bar spoofing attempt"; flow:to_client,established; file_data; content:"|D6 FD 91 46 E0 43 B0 89 8E B9 F0 CB 32 45 EE D4 7D 81 16 4B 39 22 32 93 15 A2 56 98 EA 38|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,17404; reference:cve,2006-1626; classtype:attempted-user; sid:28662; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer beforeeditfocus use after free exploit attempt"; flow:to_server,established; file_data; content:"beforeeditfocus"; nocase; content:".focus"; within:250; nocase; content:"document.write"; nocase; pcre:"/function\s+(?P<vuln>\w+)\s*\x28[^\x7B]+?\x7B[^\x7D]+?document\.write.*?onbeforeeditfocus\s*[\x22\x27]\s*\x2C\s*(?P=vuln)/si"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,60966; reference:cve,2013-3147; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-055; classtype:attempted-user; sid:28855; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer beforeeditfocus use after free exploit attempt"; flow:to_client,established; file_data; content:"beforeeditfocus"; nocase; content:".focus"; within:250; nocase; content:"document.write"; nocase; pcre:"/function\s+(?P<vuln>\w+)\s*\x28[^\x7B]+?\x7B[^\x7D]+?document\.write.*?onbeforeeditfocus\s*[\x22\x27]\s*\x2C\s*(?P=vuln)/si"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,60966; reference:cve,2013-3147; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-055; classtype:attempted-user; sid:28854; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer Dictionary Object use after free attempt"; flow:to_server,established; file_data; content:"text/vbscript"; nocase; content:".RemoveAll()"; within:500; nocase; content:"CreateObject("; within:200; distance:25; nocase; content:"Scripting.Dictionary"; within:35; content:".RemoveAll()"; within:500; nocase; pcre:"/vbscript.*?(?P<dict1>\w+)\.RemoveAll\x28\x29.*?Set\s*?(?P=dict1)\s*?\x3d\s*?CreateObject\x28\s*?[\x22\x27]\s*?Scripting\.Dictionary.*?(?P=dict1)\.Add.*?(?P=dict1)\.RemoveAll\x28\x29/smi"; metadata:policy security-ips drop, service smtp; reference:bugtraq,64082; reference:cve,2013-5056; reference:url,osvdb.org/show/osvdb/100766; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-099; classtype:attempted-user; sid:28882; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Dictionary Object use after free attempt"; flow:to_client,established; file_data; content:"text/vbscript"; nocase; content:".RemoveAll()"; within:500; nocase; content:"CreateObject("; within:200; distance:25; nocase; content:"Scripting.Dictionary"; within:35; content:".RemoveAll()"; within:500; nocase; pcre:"/vbscript.*?(?P<dict1>\w+)\.RemoveAll\x28\x29.*?Set\s*?(?P=dict1)\s*?\x3d\s*?CreateObject\x28\s*?[\x22\x27]\s*?Scripting\.Dictionary.*?(?P=dict1)\.Add.*?(?P=dict1)\.RemoveAll\x28\x29/smi"; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,64082; reference:cve,2013-5056; reference:url,osvdb.org/show/osvdb/100766; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-099; classtype:attempted-user; sid:28881; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 CElement Use After Free exploit attempt"; flow:to_client,established; file_data; content:"|2E|select|28|"; nocase; content:"oncontrolselect="; nocase; content:"document.write|28|"; within:16; nocase; content:"contentEditable="; nocase; content:"true"; within:5; nocase; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-5052; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097; classtype:attempted-user; sid:28880; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer GetClassObject use after free attempt"; flow:to_server,established; file_data; content:"<object"; nocase; content:"onerror"; within:75; nocase; content:".removeChild"; distance:0; nocase; pcre:"/<object[^>]+?id\s*?=\s*?[\x22\x27]?(?P<obj>\w+?)[\x22\x27]?[^>]*?onerror\s*?=\s*?[\x22\x27](?P<func>\w+?)\s*?\x28.*?(?P=func)\s*?\x28[^\x7b]+?\x7b[^\x7d]*?\x2eremoveChild\s*?\x28\s*?[\x22\x27]?(?P=obj)[\x22\x27]?\s*?\x29/si"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2013-5049; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097; classtype:attempted-user; sid:28878; rev:6;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer GetClassObject use after free attempt"; flow:to_server,established; file_data; content:".removeChild"; nocase; content:"<object"; distance:0; nocase; content:"onerror"; within:75; nocase; pcre:"/function\s+?(?P<func>\w+?)\s*?\x28[^\x7b]+?\x7b[^\x7d]*?\x2eremoveChild\s*?\x28\s*?[\x22\x27]?(?P<obj>\w+?)[\x22\x27]?\s*?\x29.*?<object[^>]+?id\s*?=\s*?[\x22\x27]?(?P=obj)[\x22\x27]?[^>]*?onerror\s*?=\s*?[\x22\x27](?P=func)\s*?\x28/si"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2013-5049; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097; classtype:attempted-user; sid:28877; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer GetClassObject use after free attempt"; flow:to_client,established; file_data; content:"<object"; nocase; content:"onerror"; within:75; nocase; content:".removeChild"; distance:0; nocase; pcre:"/<object[^>]+?id\s*?=\s*?[\x22\x27]?(?P<obj>\w+?)[\x22\x27]?[^>]*?onerror\s*?=\s*?[\x22\x27](?P<func>\w+?)\s*?\x28.*?(?P=func)\s*?\x28[^\x7b]+?\x7b[^\x7d]*?\x2eremoveChild\s*?\x28\s*?[\x22\x27]?(?P=obj)[\x22\x27]?\s*?\x29/si"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-5049; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097; classtype:attempted-user; sid:28876; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer GetClassObject use after free attempt"; flow:to_client,established; file_data; content:".removeChild"; nocase; content:"<object"; distance:0; nocase; content:"onerror"; within:75; nocase; pcre:"/function\s+?(?P<func>\w+?)\s*?\x28[^\x7b]+?\x7b[^\x7d]*?\x2eremoveChild\s*?\x28\s*?[\x22\x27]?(?P<obj>\w+?)[\x22\x27]?\s*?\x29.*?<object[^>]+?id\s*?=\s*?[\x22\x27]?(?P=obj)[\x22\x27]?[^>]*?onerror\s*?=\s*?[\x22\x27](?P=func)\s*?\x28/si"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-5049; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097; classtype:attempted-user; sid:28875; rev:6;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"; flow:to_server,established; file_data; content:"all_elements_list|5B|2|5D|.appendChild|28|document.createElement|28 22|div|22 29 29 3B|"; fast_pattern:only; content:"all_elements_list.push|28|document.getElementById|28 22|t9|22 29 29 3B|"; content:"obj|5B 27|appendChild|27 5D 28|all_elements_list|5B|2|5D 29 3B|"; within:250; distance:150; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-5047; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-097; classtype:attempted-user; sid:28874; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"; flow:to_client,established; file_data; content:"all_elements_list|5B|2|5D|.appendChild|28|document.createElement|28 22|div|22 29 29 3B|"; fast_pattern:only; content:"all_elements_list.push|28|document.getElementById|28 22|t9|22 29 29 3B|"; content:"obj|5B 27|appendChild|27 5D 28|all_elements_list|5B|2|5D 29 3B|"; within:250; distance:150; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-5047; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-097; classtype:attempted-user; sid:28873; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer table sub structure use after free attempt"; flow:to_client,established; file_data; content:"<table "; nocase; content:"<table "; within:256; nocase; content:".appendChild("; content:".insertRow("; within:256; content:".deleteRow("; within:256; fast_pattern; pcre:"/<table[^>]*?>((?!<\/table>).)*?<t(head|body|footer) id=.*?<\/table>.{0,256}<table[^>]*?>((?!<\/table>).)*?<t(head|body|footer) id=.*?<\/table>/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-5048; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097; classtype:attempted-user; sid:28866; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer table sub structure use after free attempt"; flow:to_server,established; file_data; content:"<table "; nocase; content:"<table "; within:256; nocase; content:".appendChild("; content:".insertRow("; within:256; content:".deleteRow("; within:256; fast_pattern; pcre:"/<table[^>]*?>((?!<\/table>).)*?<t(head|body|footer) id=.*?<\/table>.{0,256}<table[^>]*?>((?!<\/table>).)*?<t(head|body|footer) id=.*?<\/table>/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-5048; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097; classtype:attempted-user; sid:28865; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"BROWSER-IE Microsoft Internet Explorer CViewportChangeInvalidation use after free attempt"; flow:to_server,established; file_data; content:"<marquee"; fast_pattern:only; content:"<a"; content:"<i"; within:50; content:"</a"; within:15; content:"<b"; distance:0; content:"<h"; within:15; content:"</b"; within:15; content:"<marquee"; within:50; content:"</i"; within:55; metadata:policy balanced-ips drop, service smtp; reference:cve,2013-5051; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097; classtype:attempted-user; sid:28863; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CViewportChangeInvalidation use after free attempt"; flow:to_client,established; file_data; content:"<marquee"; fast_pattern:only; content:"<a"; content:"<i"; within:50; content:"</a"; within:15; content:"<b"; distance:0; content:"<h"; within:15; content:"</b"; within:15; content:"<marquee"; within:50; content:"</i"; within:55; metadata:policy balanced-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-5051; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097; classtype:attempted-user; sid:28862; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer malformed GIF double-free remote code execution attempt"; flow:to_server,established; flowbits:isset,file.gif; file_data; content:"|2C 00 00 00 00 10 00 10 00 00 00 0E 84 8F A9 CB ED 0F A3 9C B4|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,8530; reference:cve,2003-1048; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-025; classtype:attempted-user; sid:28975; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer malformed GIF double-free remote code execution attempt"; flow:to_server,established; flowbits:isset,file.gif; file_data; content:"|2C 00 00 00 00 01 00 01 00 00 00 01 41 41 41 41 41 41 41 41 41|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,8530; reference:cve,2003-1048; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-025; classtype:attempted-user; sid:28974; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer malformed GIF double-free remote code execution attempt"; flow:to_client,established; flowbits:isset,file.gif; file_data; content:"|2C 00 00 00 00 10 00 10 00 00 00 0E 84 8F A9 CB ED 0F A3 9C B4|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,8530; reference:cve,2003-1048; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-025; classtype:attempted-user; sid:28973; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer malformed GIF double-free remote code execution attempt"; flow:to_client,established; flowbits:isset,file.gif; file_data; content:"|2C 00 00 00 00 01 00 01 00 00 00 01 41 41 41 41 41 41 41 41 41|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,8530; reference:cve,2003-1048; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-025; classtype:attempted-user; sid:28972; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CHM file load attempt"; flow:to_server,established; file_data; content:"showHelp("; nocase; content:".chm"; within:40; nocase; metadata:service smtp; reference:url,msdn.microsoft.com/en-us/library/ie/ms536758%28v=vs.85%29.aspx; classtype:misc-activity; sid:28932; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHM file load attempt"; flow:to_client,established; file_data; content:"showHelp("; fast_pattern; nocase; content:".chm"; within:40; nocase; metadata:service ftp-data, service http, service imap, service pop3; reference:url,msdn.microsoft.com/en-us/library/ie/ms536758%28v=vs.85%29.aspx; classtype:misc-activity; sid:28931; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Windows showHelp CHM malicious file execution attempt"; flow:to_server,established; file_data; content:"showHelp("; nocase; content:"|2E 2E 5C 5C 2E 2E 5C 5C|"; within:40; fast_pattern; metadata:service smtp; reference:bugtraq,9320; reference:cve,2003-1041; reference:url,osvdb.org/show/osvdb/7803; reference:url,technet.microsoft.com/en-us/security/bulletin/ms04-023; classtype:attempted-admin; sid:28925; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Windows showHelp CHM malicious file execution attempt"; flow:to_server,established; file_data; content:"showHelp("; nocase; content:"%2E%2E%5C%5C%2E%2E%5C%5C"; within:60; fast_pattern; metadata:service smtp; reference:bugtraq,9320; reference:cve,2003-1041; reference:url,osvdb.org/show/osvdb/7803; reference:url,technet.microsoft.com/en-us/security/bulletin/ms04-023; classtype:attempted-admin; sid:28924; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Windows showHelp CHM malicious file execution attempt"; flow:to_server,established; file_data; content:"showHelp("; nocase; content:"%25%32%45%25%32%45%255C%255C%25%32%45%25%32%45%255C%255C"; within:85; fast_pattern; metadata:service smtp; reference:bugtraq,9320; reference:cve,2003-1041; reference:url,osvdb.org/show/osvdb/7803; reference:url,technet.microsoft.com/en-us/security/bulletin/ms04-023; classtype:attempted-admin; sid:28923; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Windows showHelp CHM malicious file execution attempt"; flow:to_client,established; file_data; content:"showHelp("; nocase; content:"|2E 2E 5C 5C 2E 2E 5C 5C|"; within:40; fast_pattern; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,9320; reference:cve,2003-1041; reference:url,osvdb.org/show/osvdb/7803; reference:url,technet.microsoft.com/en-us/security/bulletin/ms04-023; classtype:attempted-admin; sid:28922; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Windows showHelp CHM malicious file execution attempt"; flow:to_client,established; file_data; content:"showHelp("; nocase; content:"%2E%2E%5C%5C%2E%2E%5C%5C"; within:60; fast_pattern; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,9320; reference:cve,2003-1041; reference:url,osvdb.org/show/osvdb/7803; reference:url,technet.microsoft.com/en-us/security/bulletin/ms04-023; classtype:attempted-admin; sid:28921; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Windows showHelp CHM malicious file execution attempt"; flow:to_client,established; file_data; content:"showHelp("; nocase; content:"%25%32%45%25%32%45%255C%255C%25%32%45%25%32%45%255C%255C"; within:85; fast_pattern; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,9320; reference:cve,2003-1041; reference:url,osvdb.org/show/osvdb/7803; reference:url,technet.microsoft.com/en-us/security/bulletin/ms04-023; classtype:attempted-admin; sid:28920; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"BROWSER-IE Microsoft Internet Explorer print preview information disclosure attempt"; flow:to_server,established; content:"User-Agent|3A|"; nocase; http_header; content:"MSIE"; within:64; http_header; content:"<img"; http_uri; content:"src="; distance:0; http_uri; metadata:service http; reference:cve,2013-3908; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-088; classtype:attempted-recon; sid:28997; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 CElement Use After Free exploit attempt"; flow:to_client,established; file_data; content:"function "; nocase; content:"{"; distance:0; content:"document.write"; within:20; nocase; content:"oncontrolselect="; fast_pattern:only; content:"contentEditable="; nocase; content:"true"; within:5; nocase; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service http; reference:bugtraq,64124; reference:cve,2013-5052; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097; classtype:attempted-user; sid:29036; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CDisplayPointer use after free attempt"; flow:to_server,established; file_data; content:"contentEditable"; nocase; content:"true"; within:20; nocase; content:"document.execCommand"; within:40; nocase; content:"InsertInput"; within:25; nocase; content:".inner"; within:45; nocase; content:"onbeforeeditfocus"; within:100; fast_pattern; nocase; pcre:"/function\s+?(?P<trigger>\w+)\s*?\x28[^\x7b]+?\x7b[^\x7d]+?document\.write.*?(window\.onload|function|body)\s*?\x3d?\s*?(?P<activate>\w+).*?(onactivate|onbeforeeditfocus)\s*?\x3d\s*?[\x22\x27]?\s*?((?P=trigger)|(?P=activate))/si"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3205; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-069; classtype:attempted-user; sid:29035; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CDisplayPointer use after free attempt"; flow:to_client,established; file_data; content:"contentEditable"; nocase; content:"true"; within:20; nocase; content:"document.execCommand"; within:40; nocase; content:"InsertInput"; within:25; nocase; content:".inner"; within:45; nocase; content:"onbeforeeditfocus"; within:100; fast_pattern; nocase; pcre:"/function\s+?(?P<trigger>\w+)\s*?\x28[^\x7b]+?\x7b[^\x7d]+?document\.write.*?(window\.onload|function|body)\s*?\x3d?\s*?(?P<activate>\w+).*?(onactivate|onbeforeeditfocus)\s*?\x3d\s*?[\x22\x27]?\s*?((?P=trigger)|(?P=activate))/si"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3205; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-069; classtype:attempted-user; sid:29034; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer EUC-JP encoding cross site scripting attempt"; flow:to_client,established; content:"Content-Type|3A|"; http_header; content:"euc-jp"; within:64; fast_pattern; nocase; http_header; file_data; isdataat:4094,relative; content:"|8F 27|"; depth:2; offset:4094; content:"//"; within:512; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3192; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-059; classtype:attempted-user; sid:29169; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer EUC-JP encoding cross site scripting attempt"; flow:to_client,established; content:"Content-Type|3A|"; http_header; content:"euc-jp"; within:64; fast_pattern; nocase; http_header; file_data; isdataat:4094,relative; content:"|8F 22|"; depth:2; offset:4094; content:"//"; within:512; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3192; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-059; classtype:attempted-user; sid:29168; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer invalid object property use after free memory corruption attempt"; flow:to_server,established; file_data; content:"document.getElement"; content:".style."; within:100; content:"document.createElement"; within:45; content:"CollectGarbage"; within:75; fast_pattern; content:"HTML"; within:55; pcre:"/(body\s*?onload\s*?\x3d\s*?[\x22\x22](?P<func>\w+).*?function\s*?(?P=func)\s*?\x28[^\x7b]+?\x7b[^\x7d]+?var\s*?(?P<var>\w+)\s*?\x3d\s*?document\.getElement[^\x7d]+?\.style\.\w+\s*?\x3d\s*?document\.createElement[^\x7d]+?CollectGarbage[^\x7d]+?(?P=var)\.(inner|outer)HTML)|(function\s*?(?P<func2>\w+)\s*?\x28[^\x7b]+?\x7b[^\x7d]+?var\s*?(?P<var2>\w+)\s*?\x3d\s*?document\.getElement[^\x7d]+?\.style\.\w+\s*?\x3d\s*?document\.createElement[^\x7d]+?CollectGarbage[^\x7d]+?(?P=var2)\.(inner|outer)HTML.*?body\s*?onload[^\x3e]+?)(?P=func2)/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-4787; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-077; classtype:attempted-dos; sid:29265; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer msdds clsid access attempt"; flow:to_server,established; file_data; content:"clsid:EC444CB6-3E7E-4865-B1C3-0DE72EF39B3F"; fast_pattern:only; metadata:service smtp; reference:bugtraq,14594; reference:cve,2005-1990; reference:cve,2005-2127; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-038; reference:url,www.frsirt.com/english/advisories/2005/1450; classtype:attempted-user; sid:29223; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer devenum clsid access attempt"; flow:to_server,established; file_data; content:"clsid:083863F1-70DE-11d0-BD40-00A0C911CE86"; fast_pattern:only; metadata:service smtp; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-038; classtype:attempted-user; sid:29222; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer blnmgr clsid access attempt"; flow:to_server,established; file_data; content:"clsid:3F8A6C33-E0FD-11D0-8A8C-00A0C90C2BC5"; fast_pattern:only; metadata:service smtp; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-038; classtype:attempted-user; sid:29221; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer VML array with negative length memory corruption attempt"; flow:to_client,established; file_data; content:"#default#VML"; content:"dashstyle="; fast_pattern:only; content:".length=-"; nocase; content:".split(|22 22|).reverse().join(|22 22|)"; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,58570; reference:cve,2013-2551; reference:url,osvdb.org/show/osvdb/91197; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037; classtype:attempted-user; sid:29602; rev:1;)
alert tcp any any -> $HOME_NET 25 (msg:"BROWSER-IE Microsoft Internet Explorer cmarkup methods use after free attempt"; flow:to_server,established; file_data; content:"|3C 64 69 76 20 69 64 3D 22 64 69 76 31 61 22 20 73 74 79 6C 65 3D 22 68 65 69 67 68 74 3A 32 30 30 30 70 78 22 3E 26 6E 62 73 70 3B 3C 2F 64 69 76 3E|"; fast_pattern:only; content:"|65 6C 73 65 69 66 20 28 66 6C 61 67 31 20 25 20 31 30 30 30 20 3D 3D 20 30 29 20 7B|"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0269; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:29738; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer cmarkup methods use after free attempt"; flow:to_client,established; file_data; content:"|3C 64 69 76 20 69 64 3D 22 64 69 76 31 61 22 20 73 74 79 6C 65 3D 22 68 65 69 67 68 74 3A 32 30 30 30 70 78 22 3E 26 6E 62 73 70 3B 3C 2F 64 69 76 3E|"; fast_pattern:only; content:"|65 6C 73 65 69 66 20 28 66 6C 61 67 31 20 25 20 31 30 30 30 20 3D 3D 20 30 29 20 7B|"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0269; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:29737; rev:2;)
alert tcp any any -> $HOME_NET 25 (msg:"BROWSER-IE Microsoft Internet Explorer overlapping object boundaries memory corruption attempt"; flow:to_server,established; file_data; content:".addEventListener"; content:"DOMNodeRemoved"; within:32; fast_pattern; content:".removeEventListener"; distance:0; content:"DOMNodeRemoved"; within:32; content:"getSelection().removeAllRanges("; within:128; content:"getSelection().deleteFromDocument("; distance:0; pcre:"/\.addEventListener\s*\x28\s*[\x22\x27]DOMNodeRemoved[\x22\x27][^\x29]*?function(?:(?!\)\x3b).)*?\{[^}]*?\.removeEventListener\s*\x28\s*[\x22\x27]DOMNodeRemoved[\x22\x27][^}]*?getselection\s*\x28.*?\x29\.removeAllRanges\s*\x28.*?\x29\x3b[^}]*?\}.*?getSelection\s*\x28.*?\x29\.deleteFromDocument/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0274; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:29734; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer overlapping object boundaries memory corruption attempt"; flow:to_client,established; file_data; content:".addEventListener"; content:"DOMNodeRemoved"; within:32; fast_pattern; content:".removeEventListener"; distance:0; content:"DOMNodeRemoved"; within:32; content:"getSelection().removeAllRanges("; within:128; content:"getSelection().deleteFromDocument("; distance:0; pcre:"/\.addEventListener\s*\x28\s*[\x22\x27]DOMNodeRemoved[\x22\x27][^\x29]*?function(?:(?!\)\x3b).)*?\{[^}]*?\.removeEventListener\s*\x28\s*[\x22\x27]DOMNodeRemoved[\x22\x27][^}]*?getselection\s*\x28.*?\x29\.removeAllRanges\s*\x28.*?\x29\x3b[^}]*?\}.*?getSelection\s*\x28.*?\x29\.deleteFromDocument/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0274; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:29733; rev:7;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer list element use after free attempt"; flow:to_server,established; file_data; content:"|3C|nl"; content:"|3C|ruby"; distance:0; pcre:"/^.{0,200}(?!r[tp])\x3c\x2fruby.{0,200}\x3c\x2fnl/Rmsi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0270; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:29732; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer list element use after free attempt"; flow:to_client,established; file_data; content:"|3C|nl"; content:"|3C|ruby"; distance:0; pcre:"/^.{0,200}(?!r[tp])\x3c\x2fruby.{0,200}\x3c\x2fnl/Rmsi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2014-0270; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:29731; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CElement event handler use after free attempt"; flow:to_server,established; file_data; content:"<area"; nocase; content:".attachEvent"; within:250; fast_pattern; nocase; content:".detachEvent"; within:250; nocase; content:"document.open"; within:100; nocase; pcre:"/<area\s[^>]*?id\s*?=\s*?[\x22\x27]?(?P<area_id>[^\x22\x27\s>]+)[\x22\x27]?[\s>].*?(?P=area_id)\.attachEvent\s*?\x28[^\x29]+?,[^\x29]*?(?<func>[^\x29\s]+)[\s\x29].*?(?P=func)[^\x7b]+?\x7b[^\x7d]*?(?P=area_id)\.detachEvent\s*?\x28[^\x7d]+?document\.open/si"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0275; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:29730; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CElement event handler use after free attempt"; flow:to_server,established; file_data; content:".attachEvent"; fast_pattern; nocase; content:".detachEvent"; within:250; nocase; content:"document.open"; within:100; nocase; content:"<area"; within:250; nocase; pcre:"/(?P<area_id>\w+)\.attachEvent\s*?\x28[^\x29]+?,[^\x29]*?(?<func>[^\x29\s]+)[\s\x29].*?(?P=func)[^\x7b]+?\x7b[^\x7d]*?(?P=area_id)\.detachEvent\s*?\x28[^\x7d]+?document\.open.*?<area\s[^>]*?id\s*?=\s*?[\x22\x27]?(?P=area_id)/si"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0275; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:29729; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CElement event handler use after free attempt"; flow:to_client,established; file_data; content:"<area"; nocase; content:".attachEvent"; within:250; fast_pattern; nocase; content:".detachEvent"; within:250; nocase; content:"document.open"; within:100; nocase; pcre:"/<area\s[^>]*?id\s*?=\s*?[\x22\x27]?(?P<area_id>[^\x22\x27\s>]+)[\x22\x27]?[\s>].*?(?P=area_id)\.attachEvent\s*?\x28[^\x29]+?,[^\x29]*?(?<func>[^\x29\s]+)[\s\x29].*?(?P=func)[^\x7b]+?\x7b[^\x7d]*?(?P=area_id)\.detachEvent\s*?\x28[^\x7d]+?document\.open/si"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0275; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:29728; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CElement event handler use after free attempt"; flow:to_client,established; file_data; content:".attachEvent"; fast_pattern; nocase; content:".detachEvent"; within:250; nocase; content:"document.open"; within:100; nocase; content:"<area"; within:250; nocase; pcre:"/(?P<area_id>\w+)\.attachEvent\s*?\x28[^\x29]+?,[^\x29]*?(?<func>[^\x29\s]+)[\s\x29].*?(?P=func)[^\x7b]+?\x7b[^\x7d]*?(?P=area_id)\.detachEvent\s*?\x28[^\x7d]+?document\.open.*?<area\s[^>]*?id\s*?=\s*?[\x22\x27]?(?P=area_id)/si"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0275; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:29727; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"; flow:to_server,established; file_data; content:"outerText = |22|&nbsp|3B 22|"; content:"|22|div|3A|first-letter{background|3A|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0279; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:29722; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"; flow:to_client,established; file_data; content:"outerText = |22|&nbsp|3B 22|"; content:"|22|div|3A|first-letter{background|3A|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2014-0279; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:29721; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer SLayoutRun use after free attempt"; flow:to_server,established; file_data; content:"<body "; content:"position: absolute"; within:60; content:"<a"; content:"position: relative"; within:60; metadata:service smtp; reference:cve,2014-0276; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010; classtype:attempted-user; sid:29720; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer SLayoutRun use after free attempt"; flow:to_client,established; file_data; content:"<body "; content:"position: absolute"; within:60; content:"<a"; content:"position: relative"; within:60; metadata:service http; reference:cve,2014-0276; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010; classtype:attempted-user; sid:29719; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer text node use after free attempt"; flow:to_server,established; file_data; content:".createTextNode"; content:".addRange"; within:200; content:"delete"; within:250; content:"undo"; within:250; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0289; reference:cve,2014-0298; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012; classtype:attempted-user; sid:29718; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer text node use after free attempt"; flow:to_client,established; file_data; content:".createTextNode"; content:".addRange"; within:200; content:"delete"; within:250; content:"undo"; within:250; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2014-0289; reference:cve,2014-0298; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012; classtype:attempted-user; sid:29717; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted object memory corruption attempt"; flow:to_client,established; file_data; content:"<meta http-equiv=|22|Content-Type|22| content=|22|text/html|3B| charset=UTF-8|22|>"; content:"<meta http-equiv=|22|X-UA-Compatible|22|content=|22|IE=EmulateIE7|22|>"; content:"src : url(|22|"; content:"<body> <div id=|22|titlebar|22|><div id=|22|left|22|><div class=|22|title|22|>|E4 B8 AD E5 9B BD E4 BA BA|</div></div></div></body>|0A|</html>"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2014-0267; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:29716; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer overlapping object boundaries memory corruption attempt"; flow:to_server,established; file_data; content:"<svg"; content:"<path "; within:512; pcre:"/<path[^>]*\sd\s*=\s*[\x22\x27][^\x22\x27]*[\sMLC][-\s]{0,2}(\d{8}|\d+e(0[7-9]|[1-9][0-9]))/i"; metadata:service smtp; reference:cve,2014-0263; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-007; classtype:attempted-user; sid:29714; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer overlapping object boundaries memory corruption attempt"; flow:to_client,established; file_data; content:"<svg"; content:"<path "; within:512; pcre:"/<path[^>]*\sd\s*=\s*[\x22\x27][^\x22\x27]*[\sMLC][-\s]{0,2}(\d{8}|\d+e(0[7-9]|[1-9][0-9]))/i"; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2014-0263; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-007; classtype:attempted-user; sid:29713; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTree Node use after free attempt"; flow:to_server,established; file_data; content:"document.body.offsetHeight"; nocase; content:"document.styleSheets["; within:150; nocase; content:"].deleteRule"; within:16; nocase; content:"document.body.offsetHeight"; distance:0; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0281; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:29712; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTree Node use after free attempt"; flow:to_client,established; file_data; content:"document.body.offsetHeight"; nocase; content:"document.styleSheets["; within:150; nocase; content:"].deleteRule"; within:16; nocase; content:"document.body.offsetHeight"; distance:0; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0281; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:29711; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer fontFamily attribute deleted object access memory corruption attempt"; flow:to_server,established; file_data; content:"<style id"; nocase; content:"@font-face"; within:30; nocase; content:"src|3A|"; within:80; nocase; content:"getElementbyID"; within:300; nocase; content:"innerHTML"; within:50; nocase; content:"style.fontFamily"; within:36; nocase; pcre:"/\<style\s+?id\s?=\s?\"(?P<fontstyle>\w{1,20})\".*?\@font-face.*?src\:\s?.*\.(ttf|).*?getElementByID\(\'(?P=fontstyle)'\).*?innerHTML.*?style.fontFamily/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0284; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:29710; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer fontFamily attribute deleted object access memory corruption attempt"; flow:to_client,established; file_data; content:"<style id"; nocase; content:"@font-face"; within:30; nocase; content:"src|3A|"; within:80; nocase; content:"getElementbyID"; within:300; nocase; content:"innerHTML"; within:50; nocase; content:"style.fontFamily"; within:36; nocase; pcre:"/\<style\s+?id\s?=\s?\"(?P<fontstyle>\w{1,20})\".*?\@font-face.*?src\:\s?.*\.(ttf|).*?getElementByID\(\'(?P=fontstyle)'\).*?innerHTML.*?style.fontFamily/smi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0284; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:29709; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSS uninitialized object access attempt detected"; flow:to_client,established; file_data; content:".dir="; nocase; content:"rtl"; within:4; nocase; content:"word-wrap|3A|break-word"; fast_pattern:only; content:"style="; nocase; content:"border"; within:7; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0278; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010; classtype:attempted-user; sid:29708; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer deleted object access attempt detected"; flow:to_server,established; file_data; content:"window.navigate("; nocase; content:"document.open()"; within:50; nocase; content:"<marquee "; fast_pattern:only; content:"<marquee "; nocase; content:"onactivate|3D|"; within:50; nocase; content:"<legend"; within:100; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0285; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010; classtype:attempted-user; sid:29707; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted object access attempt detected"; flow:to_client,established; file_data; content:"window.navigate("; nocase; content:"document.open()"; within:50; nocase; content:"<marquee "; fast_pattern:only; content:"<marquee "; nocase; content:"onactivate|3D|"; within:50; nocase; content:"<legend"; within:100; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2014-0285; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010; classtype:attempted-user; sid:29706; rev:2;)
alert tcp any any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer swap node user after free"; flow:to_server,established; file_data; content:"javascript"; content:"document|2E|execCommand|28|"; distance:14; content:"InsertUnorderedList"; within:25; distance:1; content:"swapNode|28|"; distance:0; content:"document|2E|execCommand|28|"; distance:0; content:"Undo"; within:8; distance:1; pcre:"/document\.execCommand\(\s*[\x22\x27]InsertUnorderedList[\x22\x27]\s*\)\s*\x3B.{0,250}\s*\w+\.swapNode\(\s*[A-Za-z\(\)\"\'\.\=\ ]{1,75}\s*\)\s*document\.execCommand\(\s*[\x22\x27]Undo[\x22\x27]\s*\)\s*\x3B/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0290; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010; classtype:attempted-user; sid:29679; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer swap node user after free"; flow:to_client,established; file_data; content:"javascript"; content:"document|2E|execCommand|28|"; distance:14; content:"InsertUnorderedList"; within:25; distance:1; content:"swapNode|28|"; distance:0; content:"document|2E|execCommand|28|"; distance:0; content:"Undo"; within:8; distance:1; pcre:"/document\.execCommand\(\s*[\x22\x27]InsertUnorderedList[\x22\x27]\s*\)\s*\x3B.{0,250}\s*\w+\.swapNode\(\s*[A-Za-z\(\)\"\'\.\=\ ]{1,75}\s*\)\s*document\.execCommand\(\s*[\x22\x27]Undo[\x22\x27]\s*\)\s*\x3B/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0290; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010; classtype:attempted-user; sid:29678; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CRootElement Object use after free attempt"; flow:to_server,established; file_data; content:"swapNode"; fast_pattern; content:"createElement"; within:50; content:"focus|28 29|"; within:600; distance:50; content:"onfocusin"; within:250; pcre:"/var\s*?(?P<var>\w+).*?function\s*?(?P<func1>\w+)\s*?\x28[^\x7b]+?\x7b[^\x7d]+?(?P=var)\.swapNode[^\x7d]+?createElement.*?function\s*?(?P<func2>\w+)\s*?\x28[^\x7b]+?\x7b[^\x7d]+?(?P=var)\.focus\x28\x29.*?body\s*?onload\s*?\x3d\s*?[\x22\x27](?P=func2)[^\x3e]+?onfocusin\s*?\x3d\s*?[\x22\x27](?P=func1)/smi"; metadata:policy security-ips alert, service smtp; reference:cve,2014-0273; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010; classtype:attempted-user; sid:29677; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CRootElement Object use after free attempt"; flow:to_client,established; file_data; content:"swapNode"; fast_pattern; content:"createElement"; within:50; content:"focus|28 29|"; within:600; distance:50; content:"onfocusin"; within:250; pcre:"/var\s*?(?P<var>\w+).*?function\s*?(?P<func1>\w+)\s*?\x28[^\x7b]+?\x7b[^\x7d]+?(?P=var)\.swapNode[^\x7d]+?createElement.*?function\s*?(?P<func2>\w+)\s*?\x28[^\x7b]+?\x7b[^\x7d]+?(?P=var)\.focus\x28\x29.*?body\s*?onload\s*?\x3d\s*?[\x22\x27](?P=func2)[^\x3e]+?onfocusin\s*?\x3d\s*?[\x22\x27](?P=func1)/smi"; metadata:policy security-ips alert, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0273; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010; classtype:attempted-user; sid:29676; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer type confusion attempt"; flow:to_client,established; file_data; content:"language=|22|vbscript|22|"; fast_pattern:only; content:"Public Default Property Get"; content:"language=|22|jscript|22|"; pcre:"/Set\s+(?P<class>[a-z0-9]+)\s+\x3D\s+new.*var\s+[a-z0-9]\s+\x3D\s+(?P=class)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2014-0271; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-011; classtype:attempted-user; sid:29675; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer SVG handling use after free attempt"; flow:to_server,established; file_data; content:"<clipPath"; fast_pattern; nocase; content:"clip-path"; within:50; nocase; content:"url|28|"; within:25; nocase; content:"<svg"; nocase; content:"</svg"; within:250; nocase; content:"outerHTML"; nocase; pcre:"/<clipPath[^>]+?id\s*?=\s*?[\x22\x27]?(?P<clip_id>[^\x22\x27\s>]+)[\x22\x27]?[\s>].*?<clipPath[^>]+?clip-path\s*?=\s*?[\x22\x27]?url\x28\x23(?P=clip_id)/si"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,65382; reference:cve,2014-0283; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:29674; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer SVG handling use after free attempt"; flow:to_server,established; file_data; content:"<clipPath"; fast_pattern; nocase; content:"clip-path"; within:50; nocase; content:"url|28|"; within:25; nocase; content:"<svg"; nocase; content:"</svg"; within:250; nocase; content:"innerHTML"; nocase; pcre:"/<clipPath[^>]+?id\s*?=\s*?[\x22\x27]?(?P<clip_id>[^\x22\x27\s>]+)[\x22\x27]?[\s>].*?<clipPath[^>]+?clip-path\s*?=\s*?[\x22\x27]?url\x28\x23(?P=clip_id)/si"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,65382; reference:cve,2014-0283; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:29673; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer SVG handling use after free attempt"; flow:to_client,established; file_data; content:"<clipPath"; fast_pattern; nocase; content:"clip-path"; within:50; nocase; content:"url|28|"; within:25; nocase; content:"<svg"; nocase; content:"</svg"; within:250; nocase; content:"outerHTML"; nocase; pcre:"/<clipPath[^>]+?id\s*?=\s*?[\x22\x27]?(?P<clip_id>[^\x22\x27\s>]+)[\x22\x27]?[\s>].*?<clipPath[^>]+?clip-path\s*?=\s*?[\x22\x27]?url\x28\x23(?P=clip_id)/si"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,65382; reference:cve,2014-0283; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:29672; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer SVG handling use after free attempt"; flow:to_client,established; file_data; content:"<clipPath"; fast_pattern; nocase; content:"clip-path"; within:50; nocase; content:"url|28|"; within:25; nocase; content:"<svg"; nocase; content:"</svg"; within:250; nocase; content:"innerHTML"; nocase; pcre:"/<clipPath[^>]+?id\s*?=\s*?[\x22\x27]?(?P<clip_id>[^\x22\x27\s>]+)[\x22\x27]?[\s>].*?<clipPath[^>]+?clip-path\s*?=\s*?[\x22\x27]?url\x28\x23(?P=clip_id)/si"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,65382; reference:cve,2014-0283; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:29671; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos deleted object access attempt"; flow:to_server,established; file_data; content:"getElementById"; nocase; content:"appendChild"; within:30; nocase; content:"innerHTML"; within:250; nocase; content:"<table id"; within:200; nocase; pcre:"/getElementById\s?\(\"(?P<child>\w{1,10})\"\)\.appendChild.*?innerHTML.*\<table\s?id\s?=\"(?P=child)\"/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0277; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:29668; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos deleted object access attempt"; flow:to_client,established; file_data; content:"getElementById"; nocase; content:"appendChild"; within:30; nocase; content:"innerHTML"; within:250; nocase; content:"<table id"; within:200; nocase; pcre:"/getElementById\s?\(\"(?P<child>\w{1,10})\"\)\.appendChild.*?innerHTML.*\<table\s?id\s?=\"(?P=child)\"/smi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0277; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:29667; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 use after free attempt"; flow:to_client,established; file_data; content:"document.createElement|28|"; content:"document.body.appendChild|28|"; distance:0; content:".applyElement|28|"; distance:0; content:"document.body.contentEditable|3D 22|true|22|"; distance:0; content:".execCommand|28|"; distance:0; content:".applyElement"; distance:0; content:"document.createElement"; within:50; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2014-0272; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:29655; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer MoveToMarkupPointer call with CControlTracker OnExitTree use-after-free attempt"; flow:to_server,established; file_data; content:"body.contentEditable"; fast_pattern:only; content:"execCommand"; nocase; content:"execCommand"; within:40; nocase; content:"Insert"; within:6; distance:2; nocase; content:"onload"; within:200; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,61668; reference:cve,2013-3184; reference:url,osvdb.org/show/osvdb/96182; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-059; classtype:attempted-user; sid:29651; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer MoveToMarkupPointer call with CControlTracker OnExitTree use-after-free attempt"; flow:to_client,established; file_data; content:"body.contentEditable"; fast_pattern:only; content:"execCommand"; nocase; content:"execCommand"; within:40; nocase; content:"Insert"; within:6; distance:2; nocase; content:"onload"; within:200; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,61668; reference:cve,2013-3184; reference:url,osvdb.org/show/osvdb/96182; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-059; classtype:attempted-user; sid:29650; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CInput element user after free attempt"; flow:to_server,established; file_data; content:"input"; content:"type"; within:200; content:"radio"; within:200; content:"onpropertychange"; within:200; pcre:"/<input\s[^>]*?type\s*=\s*[\x22\x27]?radio[\x22\x27]?[^>]*?onpropertychange\s*=\s*[\x22\x27]?(?P<func>\w+)\s*\(.*?(?P=func)\s*\([^{]+?\{[^}]*?\.(inner|outer)HTML/si"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0286; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:29744; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CInput element user after free attempt"; flow:to_client,established; file_data; content:"input"; content:"type"; within:200; content:"radio"; within:200; content:"onpropertychange"; within:200; pcre:"/<input\s[^>]*?type\s*=\s*[\x22\x27]?radio[\x22\x27]?[^>]*?onpropertychange\s*=\s*[\x22\x27]?(?P<func>\w+)\s*\(.*?(?P=func)\s*\([^{]+?\{[^}]*?\.(inner|outer)HTML/si"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0286; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:29743; rev:6;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer deleted object access memory corruption attempt"; flow:to_server,established; file_data; content:"createAttributeNS"; fast_pattern:only; content:"getElementById("; nocase; content:"CollectGarbage()"; distance:0; nocase; content:"getElementById("; distance:0; nocase; pcre:"/getElementById\x28[\'\"](?P<deleted_object>\w{1,20})[\'\"].*?CollectGarbage\x28\x29.*?getElementbyID\x28[\'\"](?P=deleted_object)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0288; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010; classtype:attempted-user; sid:29742; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted object access memory corruption attempt"; flow:to_client,established; file_data; content:"createAttributeNS"; fast_pattern:only; content:"getElementById("; nocase; content:"CollectGarbage()"; distance:0; nocase; content:"getElementById("; distance:0; nocase; pcre:"/getElementById\x28[\'\"](?P<deleted_object>\w{1,20})[\'\"].*?CollectGarbage\x28\x29.*?getElementbyID\x28[\'\"](?P=deleted_object)/smi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0288; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010; classtype:attempted-user; sid:29741; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer null attribute DoS attempt"; flow:to_client,established; file_data; content:"<script"; nocase; content:"function "; distance:0; nocase; content:".attributes|3B|"; distance:0; nocase; content:"null"; within:300; nocase; pcre:"/function\s+?(?P<function>\w+)\s*?\([^{]*?.*?\w+\s*?=\s*?null\x3b.*?(?P=function)\(?/smi"; metadata:service http; reference:bugtraq,49962; reference:cve,2011-1997; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-081; classtype:attempted-user; sid:29814; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer dynamic style update memory corruption attempt"; flow:to_client,established; file_data; content:"strict.dtd"; nocase; content:".getElementByID"; nocase; content:".className"; within:50; nocase; content:"<li"; distance:0; nocase; content:"<textarea"; within:50; fast_pattern; nocase; content:"</textarea"; within:100; nocase; pcre:"/<style[^>]*?>[\r\n\s]+?\.(?P<class>\w+)[\r\n\s]*?\{[\r\n\s]*?zoom\x3a\s*?\d+px\x3b.*?document\.getElementById\s*?\(\s*?[\x22\x27]?(?P<id>\w+)[\x22\x27]?\s*?\).*?\.className\s*?=\s*?[\x22\x27]?(?P=class).*?<li\s[^>]*?id\s*?=\s*?[\x22\x27]?(?P=id)[^>]*?>[\r\n\s]+<textarea/si"; metadata:service http; reference:cve,2009-0076; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-002; classtype:attempted-user; sid:29806; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer dynamic style update memory corruption attempt"; flow:to_client,established; file_data; content:"strict.dtd"; nocase; content:".getElementByID"; nocase; content:".className"; within:50; nocase; content:"<code"; distance:0; nocase; content:"<textarea"; within:50; fast_pattern; nocase; content:"</textarea"; within:100; nocase; pcre:"/<style[^>]*?>[\r\n\s]+?\.(?P<class>\w+)[\r\n\s]*?\{[\r\n\s]*?zoom\x3a\s*?\d+px\x3b.*?document\.getElementById\s*?\(\s*?[\x22\x27]?(?P<id>\w+)[\x22\x27]?\s*?\).*?\.className\s*?=\s*?[\x22\x27]?(?P=class).*?<code\s[^>]*?id\s*?=\s*?[\x22\x27]?(?P=id)[^>]*?>[\r\n\s]+<textarea/si"; metadata:service http; reference:cve,2009-0076; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-002; classtype:attempted-user; sid:29805; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer dynamic style update memory corruption attempt"; flow:to_client,established; file_data; content:"<p"; nocase; content:"<textarea"; within:75; fast_pattern; nocase; content:"</textarea"; within:15; nocase; content:".getElementByID"; distance:0; nocase; content:".className"; within:75; nocase; pcre:"/<style[^>]*?>[\r\n\s]+?\.(?P<class>\w+)[\r\n\s]*?\{[\r\n\s]*?zoom\x3a\s*?\d+px\x3b.*?<p\s[^>]*?id\s*?=\s*?[\x22\x27]?(?P<id>\w+)[\x22\x27]?[^>]*?>[^<]*?<textarea.*?document\.getElementById\s*?\(\s*?[\x22\x27]?(?P=id).*?\.className\s*?=\s*?[\x22\x27]?(?P=class)/si"; metadata:service http; reference:cve,2009-0076; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-002; classtype:attempted-user; sid:29804; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 8 deleted object access via timer memory corruption attempt"; flow:to_server,established; file_data; content:"document.styleSheets"; nocase; content:":first-line"; within:28; fast_pattern; nocase; metadata:service smtp; reference:cve,2013-1311; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037; classtype:attempted-user; sid:29803; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 deleted object access via timer memory corruption attempt"; flow:to_client,established; file_data; content:"document.styleSheets"; nocase; content:":first-line"; within:28; nocase; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2013-1311; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037; classtype:attempted-user; sid:29802; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer SelectAll dangling pointer use after free attempt"; flow:to_server,established; file_data; content:"document.designMode"; nocase; content:"document.execCommand("; distance:0; nocase; content:"selectAll"; within:12; nocase; content:"onbeforedeactivate"; fast_pattern:only; pcre:"/function\s?(?P<freed>\w{1,20}).*?document\.designMode\s?=\s?[\'\"]on[\'\"]\x3B.*?document\.execCommand\([\'\"]selectall[\'\"]\)\x3B.*?onload\s?=s?[\'\"](?P=freed).*?onbeforedeactivate\s?=\s?[\'\"](?P=freed)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-0171; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-023; classtype:attempted-user; sid:29797; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer SelectAll dangling pointer use after free attempt"; flow:to_client,established; file_data; content:"document.designMode"; nocase; content:"document.execCommand("; distance:0; nocase; content:"selectAll"; within:12; nocase; content:"onbeforedeactivate"; fast_pattern:only; pcre:"/function\s?(?P<freed>\w{1,20}).*?document\.designMode\s?=\s?[\'\"]on[\'\"]\x3B.*?document\.execCommand\([\'\"]selectall[\'\"]\)\x3B.*?onload\s?=s?[\'\"](?P=freed).*?onbeforedeactivate\s?=\s?[\'\"](?P=freed)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0171; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-023; classtype:attempted-user; sid:29796; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 8 Javascript negative option index attack attempt"; flow:to_server,established; file_data; content:"<script"; nocase; content:".options.add"; distance:0; nocase; pcre:"/options\.add\x28.*?,\s*?(\-0x[a-f0-9]+?\s*?|-[0-9]{6,15}\s*?)\x29/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,49964; reference:cve,2011-1999; reference:url,osvdb.org/show/osvdb/76211; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-081; classtype:attempted-user; sid:29758; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer style.position use-after-free memory corruption attempt"; flow:to_client,established; file_data; content:"position|3A|fixed"; content:"document.getElementById|28|"; distance:0; content:".focus|28|"; distance:0; content:".style.position"; distance:0; pcre:"/id\s*?\x3d\s*?[\x22\x27]?(?P<id>\w+).*?position\x3Afixed.*?document\.getElementById\x28[\x22\x27](?P=id)[\x22\x27].*?\.focus\x28(?P=id).*?style\.position\s*?\x3d\s*?[\x22\x27]static[\x22\x27]/smi"; metadata:service http; reference:cve,2012-0011; reference:cve,2012-0155; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-010; classtype:attempted-dos; sid:29754; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 10 use after free attempt"; flow:to_server,established; file_data; content:".getElementsByTagName"; content:"script"; within:10; nocase; content:".onpropertychange"; within:200; content:".createElement"; within:200; content:"SELECT"; within:10; nocase; content:"CollectGarbage()"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0322; reference:url,technet.microsoft.com/en-us/security/advisory/2934088; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012; classtype:attempted-user; sid:29820; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 10 use after free attempt"; flow:to_client,established; file_data; content:".getElementsByTagName"; content:"script"; within:10; nocase; content:".onpropertychange"; within:200; content:".createElement"; within:200; content:"SELECT"; within:10; nocase; content:"CollectGarbage()"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0322; reference:url,technet.microsoft.com/en-us/security/advisory/2934088; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012; classtype:attempted-user; sid:29819; rev:7;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer onscroll use after free attempt"; flow:to_server,established; file_data; content:"<body "; nocase; content:"onscroll="; within:50; fast_pattern; content:"document.writeln(|22 22|)"; pcre:"/<script\s*>((?!</script>).)*?function (?P<onload>\w+).*?\{[^}]*?document\.writeln\([\x22\x27]{2}\).*?<body[^>]*?on(scroll|load)\s*=\s*[\x22\x27](?P=onload)/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3123; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-047; classtype:attempted-user; sid:29989; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer onscroll use after free attempt"; flow:to_client,established; file_data; content:"<body "; nocase; content:"onscroll="; within:50; fast_pattern; content:"document.writeln(|22 22|)"; pcre:"/<script\s*>((?!</script>).)*?function (?P<onload>\w+).*?\{[^}]*?document\.writeln\([\x22\x27]{2}\).*?<body[^>]*?on(scroll|load)\s*=\s*[\x22\x27](?P=onload)/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3123; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-047; classtype:attempted-user; sid:29988; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer ruby text tag heap-based buffer overflow attempt"; flow:to_server,established; file_data; content:"<rt"; nocase; content:"-ms-hyphens:"; fast_pattern:only; pcre:"/<rt[^?]*?style\s*=\s*[\x22\x27]?-ms-hyphens\s*\x3A\s*auto\s*\x3B\s*[\x27\x22]?\>[\w\W]{680}/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0313; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012; reference:url,www.w3schools.com/tags/tag_rt.asp; classtype:attempted-dos; sid:30145; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer ruby text tag heap-based buffer overflow attempt"; flow:to_client,established; file_data; content:"<rt"; nocase; content:"-ms-hyphens:"; fast_pattern:only; pcre:"/<rt[^?]*?style\s*=\s*[\x22\x27]?-ms-hyphens\s*\x3A\s*auto\s*\x3B\s*[\x27\x22]?\>[\w\W]{680}/smi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0313; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012; reference:url,www.w3schools.com/tags/tag_rt.asp; classtype:attempted-dos; sid:30144; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer OnMove use after free attempt"; flow:to_server,established; file_data; content:"= document.createElement|28 22|html"; content:".scrollLeft="; fast_pattern:only; content:"onmove="; content:".swapNode(document.createElement"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0324; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012; classtype:attempted-user; sid:30143; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer OnMove use after free attempt"; flow:to_client,established; file_data; content:"= document.createElement|28 22|html"; content:".scrollLeft="; fast_pattern:only; content:"onmove="; content:".swapNode(document.createElement"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0324; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012; classtype:attempted-user; sid:30142; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer OnMove use after free attempt"; flow:to_server,established; file_data; content:"= document.createElement|28 22|html"; content:".scrollTop="; fast_pattern:only; content:"onmove="; content:".swapNode(document.createElement"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0324; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012; classtype:attempted-user; sid:30141; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer OnMove use after free attempt"; flow:to_client,established; file_data; content:"= document.createElement|28 22|html"; content:".scrollTop="; fast_pattern:only; content:"onmove="; content:".swapNode(document.createElement"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0324; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012; classtype:attempted-user; sid:30140; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer ruby element in media element use after free attempt"; flow:to_server,established; file_data; content:"document.createElement|28|"; content:"media"; within:20; content:"innerHTML"; content:"<ruby>"; within:20; content:"insertInputSubmit"; content:"insertInputHidden"; pcre:"/(?P<var>[a-z0-9]+)\s*\x3D\s*document\x2EcreateElement\x28[\x22\x27]media[\x22\x27]\x29.*?(?P=var)\x2EinnerHTML\s*\x3D\s*[\x22\x27]\x3Cruby\x3E[\x22\x27].*?(?P=var)\x2EinnerHTML\s*\x3D\s*[\x22\x27]{2}/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0309; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012; classtype:attempted-user; sid:30132; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer ruby element in media element use after free attempt"; flow:to_client,established; file_data; content:"document.createElement|28|"; content:"media"; within:20; content:"innerHTML"; content:"<ruby>"; within:20; content:"insertInputSubmit"; content:"insertInputHidden"; pcre:"/(?P<var>[a-z0-9]+)\s*\x3D\s*document\x2EcreateElement\x28[\x22\x27]media[\x22\x27]\x29.*?(?P=var)\x2EinnerHTML\s*\x3D\s*[\x22\x27]\x3Cruby\x3E[\x22\x27].*?(?P=var)\x2EinnerHTML\s*\x3D\s*[\x22\x27]{2}/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2014-0309; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012; classtype:attempted-user; sid:30131; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer Nested Tables use after free attempt"; flow:to_server,established; file_data; content:"table"; nocase; content:"].removeNode(false)"; within:23; fast_pattern; nocase; content:"document.write"; nocase; content:"<table>"; within:11; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0299; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012; classtype:attempted-user; sid:30130; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Nested Tables use after free attempt"; flow:to_client,established; file_data; content:"table"; nocase; content:"].removeNode(false)"; within:23; fast_pattern; nocase; content:"document.write"; nocase; content:"<table>"; within:11; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0299; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012; classtype:attempted-user; sid:30129; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer use after free memory corruption attempt"; flow:to_server,established; file_data; content:".contentEditable"; nocase; content:".execCommand|28|"; within:100; nocase; content:"Delete"; within:10; nocase; content:".createTextRange|28 29|.execCommand|28|"; within:100; nocase; content:"SelectAll"; within:15; nocase; content:"HTML"; within:55; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0304; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012; classtype:attempted-user; sid:30128; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer use after free memory corruption attempt"; flow:to_client,established; file_data; content:".contentEditable"; nocase; content:".execCommand|28|"; within:100; nocase; content:"Delete"; within:10; nocase; content:".createTextRange|28 29|.execCommand|28|"; within:100; nocase; content:"SelectAll"; within:15; nocase; content:"HTML"; within:55; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0304; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012; classtype:attempted-user; sid:30127; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreeDataPos object use after free attempt"; flow:to_server,established; file_data; content:"all[1].setAttribute(|22|className|22|, all[1].previousSibling)"; content:"setTimeout('CollectGarbage()|3B|all[0].outerText = |22|aaaa|22 3B|document.body.innerHTML += |22|a|22|', 1000)"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0311; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012; classtype:attempted-user; sid:30126; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreeDataPos object use after free attempt"; flow:to_client,established; file_data; content:"all[1].setAttribute(|22|className|22|, all[1].previousSibling)"; content:"setTimeout('CollectGarbage()|3B|all[0].outerText = |22|aaaa|22 3B|document.body.innerHTML += |22|a|22|', 1000)"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0311; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012; classtype:attempted-user; sid:30125; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos use after free attempt"; flow:to_server,established; file_data; content:".createRange|28|"; nocase; content:".deleteContents|28|"; within:250; nocase; content:".execCommand|28|"; within:100; nocase; content:"insertIFrame"; within:20; fast_pattern; nocase; pcre:"/function.*?\x28[^\x7b]+?\x7b[^\x7d]+?var\s*?(?P<var>\w+)\s*?\x3d[^\x7d]+?\.createRange\x28[^\x7d]+?(?P=var)\.deleteContents\x28[^\x7d]+?\.execCommand\x28\s*?[\x22\x27]\s*?insertIFrame/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0297; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012; classtype:attempted-user; sid:30124; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos use after free attempt"; flow:to_client,established; file_data; content:".createRange|28|"; nocase; content:".deleteContents|28|"; within:250; nocase; content:".execCommand|28|"; within:100; nocase; content:"insertIFrame"; within:20; fast_pattern; nocase; pcre:"/function.*?\x28[^\x7b]+?\x7b[^\x7d]+?var\s*?(?P<var>\w+)\s*?\x3d[^\x7d]+?\.createRange\x28[^\x7d]+?(?P=var)\.deleteContents\x28[^\x7d]+?\.execCommand\x28\s*?[\x22\x27]\s*?insertIFrame/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0297; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012; classtype:attempted-user; sid:30123; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer remote code execution attempt"; flow:to_client,established; file_data; content:"firstChild"; content:"onpropertychange"; within:50; fast_pattern; content:".selected"; content:"document.open("; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0312; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012; classtype:attempted-user; sid:30122; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer button element onreadystatechange use after free attempt"; flow:to_server,established; file_data; content:"document.createElement"; content:"button"; within:20; content:"onreadystatechange"; content:"CollectGarbage"; pcre:"/(?P<button>[a-z0-9]+)\s*\x3D\s*document\.createElement\x28[\x22\x27]button[\x22\x27]\x29.*?(?P=button)\.onreadystatechange\s*\x3D\s*.*?(?P=button)\.addBehavior.*?CollectGarbage\x28/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0302; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012; classtype:attempted-user; sid:30117; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer button element onreadystatechange use after free attempt"; flow:to_client,established; file_data; content:"document.createElement"; content:"button"; within:20; content:"onreadystatechange"; content:"CollectGarbage"; pcre:"/(?P<button>[a-z0-9]+)\s*\x3D\s*document\.createElement\x28[\x22\x27]button[\x22\x27]\x29.*?(?P=button)\.onreadystatechange\s*\x3D\s*.*?(?P=button)\.addBehavior.*?CollectGarbage\x28/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2014-0302; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012; classtype:attempted-user; sid:30116; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup object use after free attempt"; flow:to_server,established; file_data; content:"<body"; nocase; content:"behavior"; within:75; nocase; content:"<body"; within:150; nocase; content:"onreadystatechange"; within:75; fast_pattern; nocase; pcre:"/<body[^>]+?style\s*=\s*[\x22\x27](-ms-)?behavior\s*:.*?<body[^>]+?onreadystatechange\s*=[^>]+?>[\s\t\r\n]*?<\/body/si"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,66028; reference:cve,2014-0303; reference:cve,2014-2799; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052; classtype:attempted-user; sid:30113; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup object use after free attempt"; flow:to_server,established; file_data; content:"<body"; nocase; content:"onreadystatechange"; within:75; fast_pattern; nocase; content:"<body"; within:150; nocase; content:"behavior"; within:75; nocase; pcre:"/<body[^>]+?onreadystatechange\s*=.*?<body[^>]+?style\s*=\s*[\x22\x27](-ms-)?behavior\s*:[^\x22\x27]+?[\x22\x27][^>]*?>[\s\t\r\n]*?<\/body/si"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,66028; reference:cve,2014-0303; reference:cve,2014-2799; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052; classtype:attempted-user; sid:30112; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup object use after free attempt"; flow:to_client,established; file_data; content:"<body"; nocase; content:"behavior"; within:75; nocase; content:"<body"; within:150; nocase; content:"onreadystatechange"; within:75; fast_pattern; nocase; pcre:"/<body[^>]+?style\s*=\s*[\x22\x27](-ms-)?behavior\s*:.*?<body[^>]+?onreadystatechange\s*=[^>]+?>[\s\t\r\n]*?<\/body/si"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,66028; reference:cve,2014-0303; reference:cve,2014-2799; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052; classtype:attempted-user; sid:30111; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup object use after free attempt"; flow:to_client,established; file_data; content:"<body"; nocase; content:"onreadystatechange"; within:75; fast_pattern; nocase; content:"<body"; within:150; nocase; content:"behavior"; within:75; nocase; pcre:"/<body[^>]+?onreadystatechange\s*=.*?<body[^>]+?style\s*=\s*[\x22\x27](-ms-)?behavior\s*:[^\x22\x27]+?[\x22\x27][^>]*?>[\s\t\r\n]*?<\/body/si"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,66028; reference:cve,2014-0303; reference:cve,2014-2799; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052; classtype:attempted-user; sid:30110; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer Remove Format use after free attempt"; flow:to_server,established; file_data; content:"document.body.appendChild"; nocase; content:"createTextRange()"; nocase; content:"moveToElementText(document.body.all[0])"; fast_pattern:only; content:".execCommand('Underline'"; nocase; content:".execCommand('RemoveFormat'"; within:100; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0306; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012; classtype:attempted-user; sid:30109; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Remove Format use after free attempt"; flow:to_client,established; file_data; content:"document.body.appendChild"; nocase; content:"createTextRange()"; nocase; content:"moveToElementText(document.body.all[0])"; fast_pattern:only; content:".execCommand('Underline'"; nocase; content:".execCommand('RemoveFormat'"; within:100; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0306; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012; classtype:attempted-user; sid:30108; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 10 use after free attempt"; flow:to_server,established; file_data; content:".getElementById"; content:"<script id="; nocase; content:".onpropertychange"; content:".createElement"; within:100; content:"body onload="; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0322; reference:url,technet.microsoft.com/en-us/security/advisory/2934088; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012; classtype:attempted-user; sid:30107; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 10 use after free attempt"; flow:to_client,established; file_data; content:".getElementById"; content:"<script id="; nocase; content:".onpropertychange"; content:".createElement"; within:100; content:"body onload="; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0322; reference:url,technet.microsoft.com/en-us/security/advisory/2934088; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012; classtype:attempted-user; sid:30106; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CAnchorElement use after free attempt"; flow:to_server,established; file_data; content:"t.parentNode.runtimeStyle.posWidth = -1|3B|"; content:"t.focus()"; within:20; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3882; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-080; classtype:attempted-user; sid:30105; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CAnchorElement use after free attempt"; flow:to_server,established; file_data; content:"b.runtimeStyle.posWidth = 100|3B|"; content:"t.focus()"; within:20; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3882; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-080; classtype:attempted-user; sid:30104; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CAnchorElement use after free attempt"; flow:to_client,established; file_data; content:"t.parentNode.runtimeStyle.posWidth = -1|3B|"; content:"t.focus()"; within:20; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3882; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-080; classtype:attempted-user; sid:30103; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CAnchorElement use after free attempt"; flow:to_client,established; file_data; content:"b.runtimeStyle.posWidth = 100|3B|"; content:"t.focus()"; within:20; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3882; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-080; classtype:attempted-user; sid:30102; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer SVG handling use after free attempt"; flow:to_server,established; file_data; content:"<clipPath"; fast_pattern; nocase; content:"clip-path"; within:50; nocase; content:"url|28|"; within:25; nocase; content:"<svg"; nocase; content:"</svg"; within:250; nocase; content:"outerText"; nocase; pcre:"/<clipPath[^>]+?id\s*?=\s*?[\x22\x27]?(?P<clip_id>[^\x22\x27\s>]+)[\x22\x27]?[\s>].*?<clipPath[^>]+?clip-path\s*?=\s*?[\x22\x27]?url\x28\x23(?P=clip_id)/si"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,65382; reference:cve,2014-0283; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:30082; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer SVG handling use after free attempt"; flow:to_server,established; file_data; content:"<clipPath"; fast_pattern; nocase; content:"clip-path"; within:50; nocase; content:"url|28|"; within:25; nocase; content:"<svg"; nocase; content:"</svg"; within:250; nocase; content:"innerText"; nocase; pcre:"/<clipPath[^>]+?id\s*?=\s*?[\x22\x27]?(?P<clip_id>[^\x22\x27\s>]+)[\x22\x27]?[\s>].*?<clipPath[^>]+?clip-path\s*?=\s*?[\x22\x27]?url\x28\x23(?P=clip_id)/si"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,65382; reference:cve,2014-0283; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:30081; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer SVG handling use after free attempt"; flow:to_client,established; file_data; content:"<clipPath"; fast_pattern; nocase; content:"clip-path"; within:50; nocase; content:"url|28|"; within:25; nocase; content:"<svg"; nocase; content:"</svg"; within:250; nocase; content:"outerText"; nocase; pcre:"/<clipPath[^>]+?id\s*?=\s*?[\x22\x27]?(?P<clip_id>[^\x22\x27\s>]+)[\x22\x27]?[\s>].*?<clipPath[^>]+?clip-path\s*?=\s*?[\x22\x27]?url\x28\x23(?P=clip_id)/si"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,65382; reference:cve,2014-0283; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:30080; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer SVG handling use after free attempt"; flow:to_client,established; file_data; content:"<clipPath"; fast_pattern; nocase; content:"clip-path"; within:50; nocase; content:"url|28|"; within:25; nocase; content:"<svg"; nocase; content:"</svg"; within:250; nocase; content:"innerText"; nocase; pcre:"/<clipPath[^>]+?id\s*?=\s*?[\x22\x27]?(?P<clip_id>[^\x22\x27\s>]+)[\x22\x27]?[\s>].*?<clipPath[^>]+?clip-path\s*?=\s*?[\x22\x27]?url\x28\x23(?P=clip_id)/si"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,65382; reference:cve,2014-0283; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:30079; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CSS uninitialized object access attempt detected"; flow:to_server,established; file_data; content:".dir="; nocase; content:"rtl"; within:4; nocase; content:"word-wrap|3A|break-word"; fast_pattern:only; content:"style="; nocase; content:"border"; within:7; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0278; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010; classtype:attempted-user; sid:30169; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer merged stylesheet array use after free attempt"; flow:to_server,established; file_data; content:"createStyleSheet"; content:".sheet"; content:".removeRule"; within:50; fast_pattern; pcre:"/function\s+(?P<n>\w+)\s*\([^\)]*?\)\s*\{[^\}]*?\x2e\s*(getElement[s]*ByTagName[^\}]*?sheet\s*\x2e\s*removeRule\s*\(\s*\w\s*\)|sheet\s*\x2e\s*removeRule\s*\(\s*\w\s*\)[^\}]*?\x2e\s*getElement[s]*ByTagName)[^\}]*?(?P=n)\s*\(/si"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3191; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-059; classtype:attempted-user; sid:30201; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer HtmlLayout SmartObject use after free attempt"; flow:to_server,established; file_data; content:"|3C|table"; nocase; content:"|3C|colgroup"; within:100; nocase; content:"|3C 2F|colgroup|3E|"; within:50; distance:1; nocase; content:"|3C|style"; distance:0; nocase; content:"colgroup|7B|"; distance:0; nocase; content:"display|3A|"; within:10; nocase; content:"none"; within:8; nocase; content:"|3C|script"; nocase; content:"document.execCommand|28|"; within:200; metadata:service smtp; reference:cve,2013-3873; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-080; classtype:attempted-user; sid:30289; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer onbeforeeditfocus element attribute use after free attempt"; flow:to_server,established; file_data; content:"onbeforeeditfocus"; nocase; content:"document.write"; within:30; pcre:"/onbeforeeditfocus\s*?=\s*?[\x22\x27]document\x2ewrite/ism"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-0029; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-009; classtype:attempted-user; sid:30345; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 7 swapNode use after free attempt"; flow:to_server,established; file_data; content:"|3C|button|3E 3C|kbd"; fast_pattern:only; content:".appendChild|28|document.createElement|28|"; content:".swapNode|28|document.createElement|28|"; within:200; content:"CollectGarbage|28 29|"; within:200; metadata:service smtp; reference:cve,2014-1752; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-018; classtype:attempted-user; sid:30509; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 7 swapNode use after free attempt"; flow:to_client,established; file_data; content:"|3C|button|3E 3C|kbd"; fast_pattern:only; content:".appendChild|28|document.createElement|28|"; content:".swapNode|28|document.createElement|28|"; within:200; content:"CollectGarbage|28 29|"; within:200; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2014-1752; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-018; classtype:attempted-user; sid:30508; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer GetClassObject use after free attempt"; flow:to_client,established; file_data; content:"getElementByID"; fast_pattern:only; content:".removeChild"; nocase; content:"<object"; nocase; content:"onerror"; within:75; nocase; pcre:"/function\s+?(?P<func>\w+?)\s*?\x28[^\x7b]+?\x7b[^\x7d]*?getElementByID\x28[\x22\x27](?P<obj>\w+?)[\x22\x27]?\s*?\x29[^\x7d]*?removeChild\s*?\x28.*?(?P=obj)\s[^\x3e]*?onerror\s*?=\s*?[\x22\x27](?P=func)\s*?\x28/si"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-5049; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097; classtype:attempted-user; sid:30506; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer GetClassObject use after free attempt"; flow:to_client,established; file_data; content:"getElementByID"; fast_pattern:only; content:".removeChild"; nocase; content:"<object"; nocase; content:"onerror"; within:75; nocase; pcre:"/\x3C(?P<obj>\w+)\s[^\x3e]*?onerror\s*?=\s*?[\x22\x27](?P<func>\w+)\s*?\x28.*?function\s+?(?P=func)\s*?\x28[^\x7b]+?\x7b[^\x7d]*?getElementByID\x28[\x22\x27](?P=obj)[\x22\x27]?\s*?\x29[^\x7d]*?removeChild\s*?\x28/si"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-5049; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097; classtype:attempted-user; sid:30505; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer GetClassObject use after free attempt"; flow:to_client,established; file_data; content:"ElementsBytagName"; nocase; content:".removeChild"; nocase; content:"<object"; nocase; content:"onerror"; within:75; nocase; content:"CollectGarbage()"; fast_pattern:only; pcre:"/function\s+?(?P<func>\w+?)\s*?\x28[^\x7d]*?ElementsByTagName[^\x7d]*?removeChild\s*?\x28.*?object\s[^\x3e]*?onerror\s*?\x3D\s*?[\x22\x27](?P=func)\s*?\x28/si"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-5049; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097; classtype:attempted-user; sid:30504; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer GetClassObject use after free attempt"; flow:to_client,established; file_data; content:"getElementsBytagName"; fast_pattern:only; content:".removeChild"; nocase; content:"<object"; nocase; content:"onerror"; within:75; nocase; pcre:"/\x3C(?P<obj>\w+)\s[^\x3e]*?onerror\s*?=\s*?[\x22\x27](?P<func>\w+)\s*?\x28.*?function\s+?(?P=func)\s*?\x28[^\x7b]+?\x7b[^\x7d]*?getElementsByTagName\x28[\x22\x27](?P=obj)[\x22\x27]?\s*?\x29[^\x7d]*?removeChild\s*?\x28/si"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-5049; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097; classtype:attempted-user; sid:30503; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer nth-child use after free attempt"; flow:to_server, established; file_data; content:"|3A|nth-child|28|"; fast_pattern; content:".createRange|28|"; distance:0; content:"extractContents"; distance:0; content:"|3C|li "; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-1755; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-018; classtype:attempted-user; sid:30502; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer nth-child use after free attempt"; flow:to_client, established; file_data; content:"|3A|nth-child|28|"; fast_pattern; content:".createRange|28|"; distance:0; content:"extractContents"; distance:0; content:"|3C|li "; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-1755; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-018; classtype:attempted-user; sid:30501; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer remote code execution attempt"; flow:to_server,established; file_data; content:"outerText="; nocase; content:"execCommand(|22|SelectAll|22|)"; distance:0; fast_pattern; nocase; content:"onselectstart="; distance:0; nocase; content:"Element"; distance:0; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-1751; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-018; classtype:attempted-user; sid:30500; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer remote code execution attempt"; flow:to_client,established; file_data; content:"outerText="; nocase; content:"execCommand(|22|SelectAll|22|)"; distance:0; fast_pattern; nocase; content:"onselectstart="; distance:0; nocase; content:"Element"; distance:0; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-1751; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-018; classtype:attempted-user; sid:30499; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer failed large copy clonenode attempt"; flow:to_server,established; file_data; content:"document.createElement("; content:".setAttribute("; within:50; content:".cloneNode("; within:100; fast_pattern; content:"<body onload="; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-1753; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-018; classtype:attempted-user; sid:30498; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer failed large copy clonenode attempt"; flow:to_client,established; file_data; content:"document.createElement("; content:".setAttribute("; within:50; content:".cloneNode("; within:100; fast_pattern; content:"<body onload="; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-1753; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-018; classtype:attempted-user; sid:30497; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer address bar spoofing with scripting"; flow:to_server,established; file_data; content:"<script"; nocase; content:"window.open"; distance:0; content:".click"; within:100; pcre:"/window\.open\(\s*(\x5C[\x22\x27])?\s*(?!(about|cdl|dvd|f(ile|tp)|gopher|http?|i(pp|ts)|javascript|local|m(ailto|html|k|sdaipp|s-its)|res|sysimage|tv|vbscript|wia)).{1,10}\:\/\//i"; metadata:service smtp; reference:bugtraq,10943; reference:cve,2004-2219; classtype:attempted-user; sid:30491; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer address bar spoofing with scripting"; flow:to_client,established; file_data; content:"<script"; nocase; content:"window.open"; distance:0; content:".click"; within:100; pcre:"/window\.open\(\s*(\x5C[\x22\x27])?\s*(?!(about|cdl|dvd|f(ile|tp)|gopher|http?|i(pp|ts)|javascript|local|m(ailto|html|k|sdaipp|s-its)|res|sysimage|tv|vbscript|wia)).{1,10}\:\/\//i"; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,10943; reference:cve,2004-2219; classtype:attempted-user; sid:30490; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer VML use after free attempt"; flow:to_server,established; file_data; content:"url|28 23|default|23|VML|29|"; fast_pattern:only; content:"schemas-microsoft-com|3A|vml"; nocase; content:"removeNode"; nocase; content:"onpropertychange"; distance:0; nocase; pcre:"/function\s+?(?P<func>\w+)\s*?\x28\s*?\x29\s*?\x7b[^\x7d]*?this\x2eremoveNode\x28true\x29.*?\x2eonpropertychange\s*?=\s*?(?P=func)/si"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,67075; reference:cve,2014-1776; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-021; classtype:attempted-user; sid:30803; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer VML use after free attempt"; flow:to_client,established; file_data; content:"url|28 23|default|23|VML|29|"; fast_pattern:only; content:"schemas-microsoft-com|3A|vml"; nocase; content:"removeNode"; nocase; content:"onpropertychange"; distance:0; nocase; pcre:"/function\s+?(?P<func>\w+)\s*?\x28\s*?\x29\s*?\x7b[^\x7d]*?this\x2eremoveNode\x28true\x29.*?\x2eonpropertychange\s*?=\s*?(?P=func)/si"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,67075; reference:cve,2014-1776; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-021; classtype:attempted-user; sid:30794; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer type confusion attempt"; flow:to_server,established; file_data; content:"language=|22|vbscript|22|"; fast_pattern:only; content:"Public Default Property Get"; content:"language=|22|jscript|22|"; pcre:"/Set\s+(?P<class>[a-z0-9]+)\s+\x3D\s+new.*var\s+[a-z0-9]\s+\x3D\s+(?P=class)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0271; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-006; classtype:attempted-user; sid:30851; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer type confusion attempt"; flow:to_server,established; file_data; content:"Class "; content:"Public Default Property Get "; distance:0; content:"End Property"; within:100; content:"Set"; distance:0; content:"New"; within:50; nocase; pcre:"/Class\s(?P<class>[a-z0-9]+).*?Public\sDefault\sProperty\sGet\s(?P<property>[a-z0-9]+)\s+(?P=property)[^\x3D]+?End\sProperty.*?Set\s(?P<var>[a-z0-9]+)\s\x3D\sNew\s(?P=class).*?(?P=var)\.(?P=property)\s\x3D/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0271; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-006; classtype:attempted-user; sid:30850; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer type confusion attempt"; flow:to_client,established; file_data; content:"Class "; content:"Public Default Property Get "; distance:0; content:"End Property"; within:100; content:"Set"; distance:0; content:"New"; within:50; nocase; pcre:"/Class\s(?P<class>[a-z0-9]+).*?Public\sDefault\sProperty\sGet\s(?P<property>[a-z0-9]+)\s+(?P=property)[^\x3D]+?End\sProperty.*?Set\s(?P<var>[a-z0-9]+)\s\x3D\sNew\s(?P=class).*?(?P=var)\.(?P=property)\s\x3D/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2014-0271; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-006; classtype:attempted-user; sid:30849; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CElement event handler use after free attempt"; flow:to_server,established; file_data; content:".attachEvent"; fast_pattern; content:"onfocus"; within:15; nocase; content:"document.write"; within:150; content:"<area"; within:250; nocase; pcre:"/(?<area>\w+)\x2EattachEvent\s*\x28[\x27\x22]\s*onfocus(out|in)\s*[\x27\x22]\s*,\s*(?<func>\w+)\s*?\x29.*?function\s*(?P=func)\s*?\x28[^\x29]*?\x29\s*\x7b[^\x7d]*?document\x2Ewrite(ln)?\s*\x28\s*[\x27\x22][^\x29]*?[\x27\x22]\s*?\x29.*?<area\s*id\s*=[\x27\x22]\s*(?P=area)\s*[\x27\x22]/si"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0275; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-005; classtype:attempted-user; sid:30848; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CElement event handler use after free attempt"; flow:to_client,established; file_data; content:".attachEvent"; fast_pattern; content:"onfocus"; within:15; nocase; content:"document.write"; within:150; content:"<area"; within:250; nocase; pcre:"/(?<area>\w+)\x2EattachEvent\s*\x28[\x27\x22]\s*onfocus(out|in)\s*[\x27\x22]\s*,\s*(?<func>\w+)\s*?\x29.*?function\s*(?P=func)\s*?\x28[^\x29]*?\x29\s*\x7b[^\x7d]*?document\x2Ewrite(ln)?\s*\x28\s*[\x27\x22][^\x29]*?[\x27\x22]\s*?\x29.*?<area\s*id\s*=[\x27\x22]\s*(?P=area)\s*[\x27\x22]/si"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0275; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-005; classtype:attempted-user; sid:30847; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer VML use after free attempt"; flow:to_server,established; file_data; content:"|C2 06 62 06 25 80 02 15 DF FF FF 24 00 63 07 24 00 82 63 09 10 34 00 00 09 62 07 D2 62 09 66|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-1776; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-021; classtype:attempted-user; sid:30895; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer VML use after free attempt"; flow:to_client,established; file_data; content:"|C2 06 62 06 25 80 02 15 DF FF FF 24 00 63 07 24 00 82 63 09 10 34 00 00 09 62 07 D2 62 09 66|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-1776; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-021; classtype:attempted-user; sid:30894; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer VML use after free attempt"; flow:to_server,established; file_data; content:"url|28 23|default|23|VML|29|"; fast_pattern:only; content:"embed src="; content:".swf"; within:10; content:"|3C|v|3A|"; content:"id="; within:10; content:"style="; within:15; metadata:policy security-ips drop, service smtp; reference:cve,2014-1776; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-021; classtype:attempted-user; sid:30893; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer VML use after free attempt"; flow:to_client,established; file_data; content:"url|28 23|default|23|VML|29|"; fast_pattern:only; content:"embed src="; content:".swf"; within:10; content:"|3C|v|3A|"; content:"id="; within:10; content:"style="; within:15; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-1776; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-021; classtype:attempted-user; sid:30892; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CElement use after free attempt"; flow:to_server,established; file_data; content:"<marquee"; fast_pattern; nocase; content:".applyElement"; distance:0; nocase; content:".createElement"; within:100; nocase; content:"frameset"; within:50; nocase; content:".createRange"; within:250; nocase; pcre:"/<marquee[^>]+?id\s*?=\s*?[\x22\x27]?(?P<elem>\w+)[\x22\x27]?[\s>].*?(?P=elem)\.applyElement\s*?\x28[^\x29]*?createElement\s*?\x28\s*?[\x22\x27]frameset[\x22\x27]\s*?\x29/si"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-1815; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-029; classtype:attempted-user; sid:30964; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CElement use after free attempt"; flow:to_server,established; file_data; content:".applyElement"; nocase; content:".createElement"; within:100; nocase; content:"frameset"; within:50; nocase; content:".createRange"; within:250; nocase; content:"<marquee"; distance:0; fast_pattern; nocase; pcre:"/(?P<elem>\w+)\.applyElement\s*?\x28[^\x29]*?createElement\s*?\x28\s*?[\x22\x27]frameset[\x22\x27]\s*?\x29.*?<marquee[^>]+?id\s*?=\s*?[\x22\x27]?(?P=elem)/si"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-1815; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-029; classtype:attempted-user; sid:30963; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CElement use after free attempt"; flow:to_client,established; file_data; content:"<marquee"; fast_pattern; nocase; content:".applyElement"; distance:0; nocase; content:".createElement"; within:100; nocase; content:"frameset"; within:50; nocase; content:".createRange"; within:250; nocase; pcre:"/<marquee[^>]+?id\s*?=\s*?[\x22\x27]?(?P<elem>\w+)[\x22\x27]?[\s>].*?(?P=elem)\.applyElement\s*?\x28[^\x29]*?createElement\s*?\x28\s*?[\x22\x27]frameset[\x22\x27]\s*?\x29/si"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-1815; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-029; classtype:attempted-user; sid:30962; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CElement use after free attempt"; flow:to_client,established; file_data; content:".applyElement"; nocase; content:".createElement"; within:100; nocase; content:"frameset"; within:50; nocase; content:".createRange"; within:250; nocase; content:"<marquee"; distance:0; fast_pattern; nocase; pcre:"/(?P<elem>\w+)\.applyElement\s*?\x28[^\x29]*?createElement\s*?\x28\s*?[\x22\x27]frameset[\x22\x27]\s*?\x29.*?<marquee[^>]+?id\s*?=\s*?[\x22\x27]?(?P=elem)/si"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-1815; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-029; classtype:attempted-user; sid:30961; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer deleted object memory corruption attempt"; flow:to_server,established; file_data; content:"<dir"; nocase; content:"<sub"; nocase; content:"fireEvent"; nocase; content:"onfocus"; within:20; content:"attachEvent"; nocase; content:"onfocusout"; within:20; nocase; content:"attachEvent"; distance:0; nocase; content:"onfocusout"; within:20; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0310; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-029; classtype:attempted-user; sid:30957; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted object memory corruption attempt"; flow:to_client,established; file_data; content:"<dir"; nocase; content:"<sub"; nocase; content:"fireEvent"; nocase; content:"onfocus"; within:20; content:"attachEvent"; nocase; content:"onfocusout"; within:20; nocase; content:"attachEvent"; distance:0; nocase; content:"onfocusout"; within:20; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0310; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-029; classtype:attempted-user; sid:30956; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer selectall use after free"; flow:to_server,established; file_data; content:"document.open|28|"; content:"document.execCommand|28|"; content:"SelectAll"; content:"onmove"; content:"onload"; pcre:"/function\s*(?P<func1>\w+)\s*\(\s*\)\s*\{.{0,100}document\.open\(\s*\)\s*\x3B.{0,500}function\s*(?P<func2>\w+)\s*\(\s*\)\s*\{.{0,100}document\.execCommand\(\s*[\x22\x27]SelectAll[\x22\x27]\s*\)\s*\x3B.{0,500}onmove\s*\=\s*eval\(\s*(?P=func1)\s*\(\s*\)\s*\)\s*onload\s*\=\s*eval\(\s*(?P=func2)/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0287; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010; classtype:attempted-user; sid:29736; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer selectall use after free"; flow:to_client,established; file_data; content:"document.open|28|"; content:"document.execCommand|28|"; content:"SelectAll"; content:"onmove"; content:"onload"; pcre:"/function\s*(?P<func1>\w+)\s*\(\s*\)\s*\{.{0,100}document\.open\(\s*\)\s*\x3B.{0,500}function\s*(?P<func2>\w+)\s*\(\s*\)\s*\{.{0,100}document\.execCommand\(\s*[\x22\x27]SelectAll[\x22\x27]\s*\)\s*\x3B.{0,500}onmove\s*\=\s*eval\(\s*(?P=func1)\s*\(\s*\)\s*\)\s*onload\s*\=\s*eval\(\s*(?P=func2)/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0287; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010; classtype:attempted-user; sid:29735; rev:8;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer pastHTML use after free"; flow:to_server,established; file_data; content:"document.body.contentEditable="; content:"true"; within:20; content:"document.execCommand"; within:200; content:"InsertInputSubmit"; within:50; content:".addBehavior"; within:50; content:"document.execCommand"; within:50; content:"SelectAll"; within:20; content:"document.selection.createRange|28 29|.pasteHTML|28|"; within:100; content:"event="; distance:0; content:"onreadystatechange"; within:30; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0305; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012; classtype:attempted-user; sid:30121; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer pastHTML use after free"; flow:to_client,established; file_data; content:"document.body.contentEditable="; content:"true"; within:20; content:"document.execCommand"; within:200; content:"InsertInputSubmit"; within:50; content:".addBehavior"; within:50; content:"document.execCommand"; within:50; content:"SelectAll"; within:20; content:"document.selection.createRange|28 29|.pasteHTML|28|"; within:100; content:"event="; distance:0; content:"onreadystatechange"; within:30; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0305; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012; classtype:attempted-user; sid:30120; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer setEndPoint use after free attempt"; flow:to_server,established; file_data; content:"document.body.createTextRange|28 29|"; content:".moveToElementText"; within:200; content:".moveToElementText"; within:220; content:".setEndPoint"; within:420; content:"EndToStart"; within:30; content:".select"; within:500; content:"document.execCommand|28|"; within:120; content:"delete"; within:30; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0314; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012; classtype:attempted-user; sid:30119; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer setEndPoint use after free attempt"; flow:to_client,established; file_data; content:"document.body.createTextRange|28 29|"; content:".moveToElementText"; within:200; content:".moveToElementText"; within:220; content:".setEndPoint"; within:420; content:"EndToStart"; within:30; content:".select"; within:500; content:"document.execCommand|28|"; within:120; content:"delete"; within:30; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0314; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012; classtype:attempted-user; sid:30118; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer WindowedMarkupContext use after free attempt"; flow:to_server,established; file_data; content:".getSVGDocument"; fast_pattern; nocase; content:".createRange"; within:250; nocase; content:".getSelection"; within:250; nocase; content:".addRange"; within:50; nocase; pcre:"/var\s+?(?P<elem>\w+)\s*?=\s*?\w+\.getSVGDocument\s*?\x28.*?(?P=elem)\.createRange\s*?\x28/si"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-1805; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035; classtype:attempted-user; sid:31220; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer WindowedMarkupContext use after free attempt"; flow:to_client,established; file_data; content:".getSVGDocument"; fast_pattern; nocase; content:".createRange"; within:250; nocase; content:".getSelection"; within:250; nocase; content:".addRange"; within:50; nocase; pcre:"/var\s+?(?P<elem>\w+)\s*?=\s*?\w+\.getSVGDocument\s*?\x28.*?(?P=elem)\.createRange\s*?\x28/si"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-1805; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035; classtype:attempted-user; sid:31219; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"; flow:to_server,established; file_data; content:"<ul "; nocase; content:"style=|22|white-space:pre|3B 22|"; fast_pattern:only; content:"document.createElement(|22|header|22|)"; nocase; content:"applyElement"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-1802; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035; classtype:attempted-user; sid:31216; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"; flow:to_client,established; file_data; content:"<ul "; nocase; content:"style=|22|white-space:pre|3B 22|"; fast_pattern:only; content:"document.createElement(|22|header|22|)"; nocase; content:"applyElement"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-1802; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035; classtype:attempted-user; sid:31215; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CDispNode use after free attempt"; flow:to_server,established; file_data; content:"contentEditable"; fast_pattern; content:"onresize"; within:150; content:".appendChild"; content:"<body onload="; pcre:"/contentEditable\s*\x3d\s*[\x22\x27]true.*?id\s*\x3d\s*(?P<idName>\w+)\s+.*?onresize\s*\x3d[\x22\x27](?P=idName)\x2ereplaceNode\x28(?P=idName)\x29/Rsmi"; metadata:policy security-ips drop, service smtp; reference:cve,2014-1766; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035; classtype:attempted-user; sid:31209; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CDispNode use after free attempt"; flow:to_client,established; file_data; content:"contentEditable"; fast_pattern; content:"onresize"; within:150; content:".appendChild"; content:"<body onload="; pcre:"/contentEditable\s*\x3d\s*[\x22\x27]true.*?id\s*\x3d\s*(?P<idName>\w+)\s+.*?onresize\s*\x3d[\x22\x27](?P=idName)\x2ereplaceNode\x28(?P=idName)\x29/Rsmi"; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-1766; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035; classtype:attempted-user; sid:31208; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 CTreePos child element use-after-free attempt"; flow:to_server,established; file_data; content:"document.getElementByID"; fast_pattern; nocase; content:"innerText"; within:40; nocase; content:"parentNode.removeChild"; within:50; nocase; pcre:"/var\s?(?P<ctreepos>\w+).*?(?P=ctreepos)\.innerText\s?=\s?[\x22\x27]{2}.*?(?P=ctreepos)\.parentNode\.removeChild\x28(?P=ctreepos)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-1800; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035; classtype:attempted-user; sid:31207; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 CTreePos child element use-after-free attempt"; flow:to_client,established; file_data; content:"document.getElementByID"; fast_pattern; nocase; content:"innerText"; within:40; nocase; content:"parentNode.removeChild"; within:50; nocase; pcre:"/var\s?(?P<ctreepos>\w+).*?(?P=ctreepos)\.innerText\s?=\s?[\x22\x27]{2}.*?(?P=ctreepos)\.parentNode\.removeChild\x28(?P=ctreepos)/smi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-1800; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035; classtype:attempted-user; sid:31206; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer celement use after free"; flow:to_server,established; file_data; content:"checkbox"; content:"window.setTimeout|28|"; distance:0; content:"document.getElementById|28|"; distance:0; content:"|29|.onpropertychange"; within:50; distance:3; content:"document.getElementById|28|"; within:100; distance:3; content:"|29|.click|28 29 3B|"; within:50; distance:3; content:"document.write|28|"; distance:5; pcre:"/\<input\s*type\s*\=\s*[\x22\x27]checkbox[\x22\x27]\s*id\s*\=\s*[\x22\x27]\w+[\x22\x27]\s*\>\s*\<\/input\>.{0,500}window.setTimeout\(\s*function\s*\(\s*\)\s*.{0,500}document.getElementById\(\s*[\x22\x27]\w+[\x22\x27]\s*\).onpropertychange\s*\=\s*(?P<var2>\w+)\s*\x3B.{0,500}function\s*(?P=var2)\s*\(\s*\)\s*\{.{0,100}document.write\(\s*[\x22\x27]\<html\>\<\/html\>[\x22\x27]\s*\)\s*\x3B/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0282; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035; classtype:attempted-user; sid:31205; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer celement use after free"; flow:to_client,established; file_data; content:"checkbox"; content:"window.setTimeout|28|"; distance:0; content:"document.getElementById|28|"; distance:0; content:"|29|.onpropertychange"; within:50; distance:3; content:"document.getElementById|28|"; within:100; distance:3; content:"|29|.click|28 29 3B|"; within:50; distance:3; content:"document.write|28|"; distance:5; pcre:"/\<input\s*type\s*\=\s*[\x22\x27]checkbox[\x22\x27]\s*id\s*\=\s*[\x22\x27]\w+[\x22\x27]\s*\>\s*\<\/input\>.{0,500}window.setTimeout\(\s*function\s*\(\s*\)\s*.{0,500}document.getElementById\(\s*[\x22\x27]\w+[\x22\x27]\s*\).onpropertychange\s*\=\s*(?P<var2>\w+)\s*\x3B.{0,500}function\s*(?P=var2)\s*\(\s*\)\s*\{.{0,100}document.write\(\s*[\x22\x27]\<html\>\<\/html\>[\x22\x27]\s*\)\s*\x3B/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0282; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035; classtype:attempted-user; sid:31204; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CRangeSaver use after free attempt"; flow:to_server,established; file_data; content:".createRange"; nocase; content:".set"; within:250; nocase; content:"NaN"; within:50; content:".addRange"; within:250; nocase; content:".execCommand"; within:250; fast_pattern; nocase; pcre:"/(?P<range>\w+)\.set(Start|End)\s*?\x28[^\x2c]+?\x2c\s*?NaN\s*?\x29.*?\.addRange\x28\s*?(?P=range)\s*?\x29/si"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-1772; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035; classtype:attempted-user; sid:31203; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CRangeSaver use after free attempt"; flow:to_client,established; file_data; content:".createRange"; nocase; content:".set"; within:250; nocase; content:"NaN"; within:50; content:".addRange"; within:250; nocase; content:".execCommand"; within:250; fast_pattern; nocase; pcre:"/(?P<range>\w+)\.set(Start|End)\s*?\x28[^\x2c]+?\x2c\s*?NaN\s*?\x29.*?\.addRange\x28\s*?(?P=range)\s*?\x29/si"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-1772; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035; classtype:attempted-user; sid:31202; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer summary node swap use after free"; flow:to_server,established; file_data; content:".swapNode(document.createElement(|22|frame|22|)"; fast_pattern; content:"<summary"; within:200; metadata:service smtp; reference:cve,2014-1789; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035; classtype:attempted-user; sid:31201; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer summary node swap use after free"; flow:to_client,established; file_data; content:".swapNode(document.createElement(|22|frame|22|)"; fast_pattern; content:"<summary"; within:200; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2014-1789; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035; classtype:attempted-user; sid:31200; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"; flow:to_server,established; file_data; content:"onload="; content:"onresize="; distance:0; nocase; content:".applyElement(document.createElement("; fast_pattern:only; nocase; content:"<tr>"; nocase; content:"<tt"; distance:0; nocase; content:"</tt>"; distance:0; nocase; content:"</tr>"; distance:0; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-1804; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035; classtype:attempted-user; sid:31199; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"; flow:to_client,established; file_data; content:"onload="; content:"onresize="; distance:0; nocase; content:".applyElement(document.createElement("; fast_pattern:only; nocase; content:"<tr>"; nocase; content:"<tt"; distance:0; nocase; content:"</tt>"; distance:0; nocase; content:"</tr>"; distance:0; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-1804; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035; classtype:attempted-user; sid:31198; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode onmousemove use-after-free attempt"; flow:to_server,established; file_data; content:"onmousemove"; nocase; content:"setCapture"; distance:0; nocase; content:"removeNode(true)"; nocase; content:"CollectGarbage"; within:18; nocase; content:"setCapture"; distance:0; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-1791; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035; classtype:attempted-user; sid:31197; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode onmousemove use-after-free attempt"; flow:to_client,established; file_data; content:"onmousemove"; nocase; content:"setCapture"; distance:0; nocase; content:"removeNode(true)"; nocase; content:"CollectGarbage"; within:18; nocase; content:"setCapture"; distance:0; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-1791; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035; classtype:attempted-user; sid:31196; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer onpagehide use after free attempt"; flow:to_client,established; file_data; content:"contentEditable"; content:"true"; within:14; content:"onpagehide"; fast_pattern:only; content:".execCommand"; content:"Refresh"; within:10; content:".createTextRange"; distance:0; content:".execCommand"; within:15; content:"SelectAll"; within:15; content:"InsertInputSubmit"; content:"document.write"; within:30; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2014-1795; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035; classtype:attempted-user; sid:31194; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 use after free attempt"; flow:to_server,established; file_data; content:".createRange|28|"; nocase; content:".setStart"; within:100; nocase; content:".setEnd"; within:100; nocase; content:"endContainer"; within:150; distance:100; fast_pattern; nocase; content:"removeNode"; within:25; nocase; content:"endContainer"; within:25; nocase; metadata:service smtp; reference:cve,2014-1762; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-035; classtype:attempted-user; sid:31193; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 use after free attempt"; flow:to_client,established; file_data; content:".createRange|28|"; nocase; content:".setStart"; within:100; nocase; content:".setEnd"; within:100; nocase; content:"endContainer"; within:150; distance:100; fast_pattern; nocase; content:"removeNode"; within:25; nocase; content:"endContainer"; within:25; nocase; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2014-1762; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-035; classtype:attempted-user; sid:31192; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer RemoveSplice use-after-free attempt"; flow:to_server,established; file_data; content:".addEventListener"; content:"DOMNodeRemoved"; within:20; fast_pattern; nocase; content:".execCommand"; content:"SelectAll"; within:15; nocase; content:".execCommand"; distance:0; content:"Insert"; within:15; nocase; pcre:"/(?P<target>\w+)\x2eaddEventListener\s*\x28\s*[\x22\x27]\s*DOMNodeRemoved\s*[\x22\x27]\s*\x2c.*?(?P=target)\x2eexecCommand\s*\x28\s*[\x22\x27]\s*SelectAll\s*[\x22\x27]\s*\x29.*?(?P=target)\x2eexecCommand\s*\x28\s*[\x22\x27]\s*Insert[^B(HT)]\w+[\x22\x27]\s*\x2c/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-1785; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-035; classtype:attempted-user; sid:31191; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer RemoveSplice use-after-free attempt"; flow:to_client,established; file_data; content:".addEventListener"; content:"DOMNodeRemoved"; within:20; fast_pattern; nocase; content:".execCommand"; content:"SelectAll"; within:15; nocase; content:".execCommand"; distance:0; content:"Insert"; within:15; nocase; pcre:"/(?P<target>\w+)\x2eaddEventListener\s*\x28\s*[\x22\x27]\s*DOMNodeRemoved\s*[\x22\x27]\s*\x2c.*?(?P=target)\x2eexecCommand\s*\x28\s*[\x22\x27]\s*SelectAll\s*[\x22\x27]\s*\x29.*?(?P=target)\x2eexecCommand\s*\x28\s*[\x22\x27]\s*Insert[^B(HT)]\w+[\x22\x27]\s*\x2c/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-1785; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-035; classtype:attempted-user; sid:31190; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer isIndex attribute overflow attempt"; flow:to_server,established; file_data; content:"for(i=0|3B| i<0xfffe|3B| i++)"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-1797; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035; classtype:attempted-user; sid:31189; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer isIndex attribute overflow attempt"; flow:to_client,established; file_data; content:"for(i=0|3B| i<0xfffe|3B| i++)"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-1797; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035; classtype:attempted-user; sid:31188; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer XSLT memory corruption attempt"; flow:to_server,established; file_data; content:"xmlns"; nocase; content:"|3A|xsl"; within:8; nocase; content:"http|2D|equiv|3D|"; nocase; content:"refresh"; within:10; nocase; content:"onunload"; fast_pattern:only; pcre:"/http\x2dequiv\x3d\s*?[\x22\x27]\s*?refresh\s*?[\x22\x27]\s*?content\s*?\x3d\s*?[\x22\x27]\s*?((1\s*?)|(0\s*?)|(\.\d\s*?)|(1\.\d\s*?))[\x22\x27]/smi"; metadata:policy security-ips drop, service smtp; reference:bugtraq,49037; reference:cve,2011-1963; reference:url,osvdb.org/show/osvdb/74499; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-057; classtype:attempted-user; sid:31301; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer negative margin use after free attempt"; flow:to_server,established; file_data; content:"<object"; nocase; content:"align="; within:60; nocase; content:"width"; within:100; distance:-50; nocase; content:!"height"; within:200; distance:-100; nocase; content:!"hspace"; within:200; distance:-100; nocase; content:"dir="; nocase; content:"margin"; nocase; pcre:"/<[^>]*?style\s*[>=].{1,1024}margin\s*\x3a\s*[^\x3b\x7d]*?-\d+.*?[\x7b\x3b]/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,54950; reference:cve,2012-1526; reference:url,osvdb.org/show/osvdb/84595; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-052; classtype:attempted-user; sid:31296; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer BSTR use after free attempt"; flow:to_server,established; file_data; content:"window.history.replaceState("; fast_pattern:only; content:"document|2E|createElement"; content:"applet"; within:20; content:"getElement"; content:"appendChild|28|"; within:30; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-2804; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-037; classtype:attempted-user; sid:31391; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer BSTR use after free attempt"; flow:to_client,established; file_data; content:"window.history.replaceState("; fast_pattern:only; content:"document|2E|createElement"; content:"applet"; within:20; content:"getElement"; content:"appendChild|28|"; within:30; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-2804; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-037; classtype:attempted-user; sid:31390; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer improper object cast memory corruption attempt"; flow:to_server,established; file_data; content:"sca5=document.createElement"; nocase; content:"document.body.createTextRange().execCommand"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-2787; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-037; classtype:attempted-user; sid:31389; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer improper object cast memory corruption attempt"; flow:to_client,established; file_data; content:"sca5=document.createElement"; nocase; content:"document.body.createTextRange().execCommand"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-2787; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-037; classtype:attempted-user; sid:31388; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CLayout object user after free attempt"; flow:to_client,established; file_data; content:"document.body.createTextRange"; content:".execCommand"; within:20; content:"SelectAll"; within:20; content:"document.body.createTextRange"; within:150; content:".select"; within:15; metadata:service smtp; reference:cve,2014-2801; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-037; classtype:attempted-user; sid:31387; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CLayout object user after free attempt"; flow:to_client,established; file_data; content:"document.body.createTextRange"; content:".execCommand"; within:20; content:"SelectAll"; within:20; content:"document.body.createTextRange"; within:150; content:".select"; within:15; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2014-2801; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-037; classtype:attempted-user; sid:31386; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"; flow:to_server,established; file_data; content:"<ul "; nocase; content:"style=|22|list-style-type:lower-latin"; fast_pattern:only; content:"<li"; nocase; metadata:policy security-ips drop, service smtp; reference:cve,2014-2795; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-037; classtype:attempted-user; sid:31385; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"; flow:to_client,established; file_data; content:"<ul "; nocase; content:"style=|22|list-style-type:lower-latin"; fast_pattern:only; content:"<li"; nocase; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-2795; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-037; classtype:attempted-user; sid:31384; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer uninitialized object use after free attempt"; flow:to_server,established; file_data; content:".createRange("; content:".createTextNode("; within:100; distance:20; content:"CollectGarbage("; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-2797; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-037; classtype:attempted-user; sid:31383; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer uninitialized object use after free attempt"; flow:to_client,established; file_data; content:".createRange("; content:".createTextNode("; within:100; distance:20; content:"CollectGarbage("; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-2797; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-037; classtype:attempted-user; sid:31382; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 onpropertychange remote code execution attempt"; flow:to_server,established; file_data; content:"document.createElement(|22|font|22|)"; content:"ff.attachEvent(|22|onpropertychange|22|, "; content:"window.event.srcElement.removeAttribute(|22|style|22|)|3B|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,66244; reference:cve,2014-1765; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-037; classtype:attempted-user; sid:31381; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 onpropertychange remote code execution attempt"; flow:to_client,established; file_data; content:"document.createElement(|22|font|22|)"; content:"ff.attachEvent(|22|onpropertychange|22|, "; content:"window.event.srcElement.removeAttribute(|22|style|22|)|3B|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,66244; reference:cve,2014-1765; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-037; classtype:attempted-user; sid:31380; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer celement use after free"; flow:to_server,established; file_data; content:"<input"; content:"checkbox"; within:100; content:"getElementById"; content:"innerHTML"; within:100; content:"getElementById"; within:200; content:"checked"; within:100; content:"getElementById"; within:100; content:"onpropertychange"; within:200; content:".reset|28 29|"; within:100; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0282; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035; classtype:attempted-user; sid:31404; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer celement use after free"; flow:to_client,established; file_data; content:"<input"; content:"checkbox"; within:100; content:"getElementById"; content:"innerHTML"; within:100; content:"getElementById"; within:200; content:"checked"; within:100; content:"getElementById"; within:100; content:"onpropertychange"; within:200; content:".reset|28 29|"; within:100; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0282; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035; classtype:attempted-user; sid:31403; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer Unexpected method call remote code execution attempt"; flow:to_client,established; file_data; content:"clearAttributes"; fast_pattern:only; pcre:"/(\w+)\.insertCell.*\1\.deleteCell.*\1\.clearAttributes/smi"; metadata:service smtp; reference:cve,2009-1141; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-019; classtype:attempted-user; sid:31402; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer html table column span width increase memory corruption attempt"; flow:to_server,established; file_data; content:"table-layout|3A|"; nocase; content:"fixed"; within:7; nocase; content:"<col id="; within:20; content:"width="; within:20; nocase; content:"span="; within:30; distance:-10; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-1876; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-037; classtype:attempted-user; sid:31428; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer onbeforeeditfocus element attribute use after free attempt"; flow:to_server,established; file_data; content:"onbeforeeditfocus"; nocase; content:"document.write"; within:90; content:"getElementsByTagName"; fast_pattern:only; pcre:"/(?P<editfocus>onbeforeeditfocus\s?=\s?[\x22\x27])(?P<focus>\w+?\x28\x29)[\x22\x27].*?(?P=editfocus)(?P=focus).*?(?P=focus)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-0029; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-009; classtype:attempted-user; sid:31486; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer onbeforeeditfocus element attribute use after free attempt"; flow:to_client,established; file_data; content:"onbeforeeditfocus"; nocase; content:"document.write"; within:90; content:"getElementsByTagName"; fast_pattern:only; pcre:"/(?P<editfocus>onbeforeeditfocus\s?=\s?[\x22\x27])(?P<focus>\w+?\x28\x29)[\x22\x27].*?(?P=editfocus)(?P=focus).*?(?P=focus)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-0029; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-009; classtype:attempted-user; sid:31485; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer getBoundingClientRect incorrect rebalancing attempt"; flow:to_server,established; file_data; content:".getClientRects|28 29|"; fast_pattern:only; content:"for|28|n=0|3B|n<tList.length|3B|n++|29 7B|"; content:"tList|5B|n|5D|.tBodies|5B|0|5D|.appendChild|28|document.createElement|28 27|tr|27 29 29|"; content:"tList|5B|n|5D|.removeChild|28|tList|5B|n|5D|.children|5B|0|5D 29|"; metadata:service smtp; reference:cve,2012-1880; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-037; classtype:attempted-user; sid:31471; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer getBoundingClientRect incorrect rebalancing attempt"; flow:to_server,established; file_data; content:".getBoundingClientRect|28 29|"; fast_pattern:only; content:".insertAdjacentElement"; nocase; content:".insertRow|28 29|"; nocase; pcre:"/document.getElementById\x28\x22(?P<dfnelement>\w+?)\x22\x29\x2einsertAdjacentElement.*document.getElementById\x28\x22\w+?\x22\x29.getBoundingClientRect\x28\x29.*?document.getElementById\x28\x22\w+?\x22\x29.insertRow\x28\x29.*?\x3cdfn id\x3d\x22(?P=dfnelement)\x22\x3e/smi"; metadata:policy security-ips drop, service smtp; reference:cve,2012-1880; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-037; classtype:attempted-user; sid:31470; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer getBoundingClientRect incorrect rebalancing attempt"; flow:to_client,established; file_data; content:".getClientRects|28 29|"; fast_pattern:only; content:"for|28|n=0|3B|n<tList.length|3B|n++|29 7B|"; content:"tList|5B|n|5D|.tBodies|5B|0|5D|.appendChild|28|document.createElement|28 27|tr|27 29 29|"; content:"tList|5B|n|5D|.removeChild|28|tList|5B|n|5D|.children|5B|0|5D 29|"; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-1880; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-037; classtype:attempted-user; sid:31469; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer outerHTML against incomplete element heap corruption attempt"; flow:to_server,established; file_data; content:".outerHTML"; fast_pattern; content:"document|2E|createStyleSheet"; within:75; nocase; pcre:"/\s(id|name)\s*?=\s*?[\x22\x27](?P<id1>\w+)[\x22\x27].*?<script[^<]*?(?P=id1)\x2eouterHTML(\x2b{2}|\s*?=\s*?[\x22\x27])/si"; metadata:policy security-ips drop, service smtp; reference:cve,2010-0490; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-018; classtype:attempted-user; sid:31504; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CSS .ipsum layout use-after-free attempt"; flow:to_server,established; file_data; content:"text/css"; nocase; content:".ipsum"; fast_pattern:only; pcre:"/\.ipsum\s*?{[^>}]*?(position|float|display|zoom):/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,59751; reference:cve,2013-1310; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-037; reference:url,yuhongbao.blogspot.ca/2013/07/how-i-found-cve-2013-1310.html; classtype:attempted-user; sid:31585; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSS .ipsum layout use-after-free attempt"; flow:to_client,established; file_data; content:"text/css"; nocase; content:".ipsum"; fast_pattern:only; pcre:"/\.ipsum\s*?{[^>}]*?(position|float|display|zoom):/smi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,59751; reference:cve,2013-1310; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-037; reference:url,yuhongbao.blogspot.ca/2013/07/how-i-found-cve-2013-1310.html; classtype:attempted-user; sid:31584; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer OnMove Use After Free exploit attempt"; flow:to_server,established; file_data; content:" onmove"; fast_pattern:only; pcre:"/\sonmove\s*?=\s*?[\x27\x22](?P<func_name>\w+)\x28.*?\s(?P=func_name)\x28[^7D]*?document\x2Ewrite\x28[\x27\x22]{2}\x29/is"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,55641; reference:cve,2012-1529; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-063; classtype:attempted-user; sid:31583; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer OnMove Use After Free exploit attempt"; flow:to_server,established; file_data; content:" onmove"; fast_pattern:only; pcre:"/\s(?P<func_name>\w+)\x28[^7D]*?document\x2Ewrite\x28[\x27\x22]{2}\x29.*?[\x27\x22](?P=func_name)\x28/is"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,55641; reference:cve,2012-1529; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-063; classtype:attempted-user; sid:31582; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer OnMove Use After Free exploit attempt"; flow:to_client,established; file_data; content:" onmove"; fast_pattern:only; pcre:"/\sonmove\s*?=\s*?[\x27\x22](?P<func_name>\w+)\x28.*?\s(?P=func_name)\x28[^7D]*?document\x2Ewrite\x28[\x27\x22]{2}\x29/is"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,55641; reference:cve,2012-1529; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-063; classtype:attempted-user; sid:31581; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer OnMove Use After Free exploit attempt"; flow:to_client,established; file_data; content:" onmove"; fast_pattern:only; pcre:"/\s(?P<func_name>\w+)\x28[^7D]*?document\x2Ewrite\x28[\x27\x22]{2}\x29.*?[\x27\x22](?P=func_name)\x28/is"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,55641; reference:cve,2012-1529; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-063; classtype:attempted-user; sid:31580; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer cloneNode for loop remote code execution attempt"; flow:to_server,established; file_data; content:"iframe src="; nocase; content:".html"; within:20; nocase; content:"setTimeout"; within:30; nocase; content:"history.go"; within:15; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,55647; reference:cve,2012-2557; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-063; classtype:attempted-user; sid:31611; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer cloneNode for loop remote code execution attempt"; flow:to_server,established; file_data; content:"for"; nocase; content:"++"; within:25; content:"cloneNode()"; within:30; pcre:"/(?P<clone>\w+?\x28\x29).*?cloneNode\x28\x29.*?(?P=clone)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,55647; reference:cve,2012-2557; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-063; classtype:attempted-user; sid:31610; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer cloneNode for loop remote code execution attempt"; flow:to_client,established; file_data; content:"iframe src="; nocase; content:".html"; within:20; nocase; content:"setTimeout"; within:30; nocase; content:"history.go"; within:15; nocase; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,55647; reference:cve,2012-2557; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-063; classtype:attempted-user; sid:31609; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer cloneNode for loop remote code execution attempt"; flow:to_client,established; file_data; content:"for"; nocase; content:"++"; within:25; content:"cloneNode()"; within:30; pcre:"/(?P<clone>\w+?\x28\x29).*?cloneNode\x28\x29.*?(?P=clone)/smi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,55647; reference:cve,2012-2557; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-063; classtype:attempted-user; sid:31608; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer margin overflow use after free attempt"; flow:to_server,established; file_data; content:".createElement("; nocase; content:"header"; within:20; nocase; content:".createElement("; nocase; content:"legend"; within:20; nocase; content:".execCommand("; fast_pattern; content:"Indent"; within:20; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-2824; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051; classtype:attempted-user; sid:31635; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer margin overflow use after free attempt"; flow:to_client,established; file_data; content:".createElement("; nocase; content:"header"; within:20; nocase; content:".createElement("; nocase; content:"legend"; within:20; nocase; content:".execCommand("; fast_pattern; content:"Indent"; within:20; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-2824; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051; classtype:attempted-user; sid:31634; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup insertMarquee use after free attempt"; flow:to_server,established; file_data; content:"onpropertychange"; nocase; content:".execCommand"; within:60; nocase; content:"InsertMarquee"; within:60; fast_pattern; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4057; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051; classtype:attempted-user; sid:31630; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup insertMarquee use after free attempt"; flow:to_client,established; file_data; content:"onpropertychange"; nocase; content:".execCommand"; within:60; nocase; content:"InsertMarquee"; within:60; fast_pattern; nocase; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4057; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051; classtype:attempted-user; sid:31629; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CDOMUIEvent use after free attempt"; flow:to_server,established; file_data; content:".createEvent"; content:"UIEvents"; within:30; content:".initUIEvent"; fast_pattern; content:"DOMFocusIn"; within:30; content:".dispatchEvent"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-2820; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051; classtype:attempted-user; sid:31628; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CDOMUIEvent use after free attempt"; flow:to_client,established; file_data; content:".createEvent"; content:"UIEvents"; within:30; content:".initUIEvent"; fast_pattern; content:"DOMFocusIn"; within:30; content:".dispatchEvent"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-2820; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051; classtype:attempted-user; sid:31627; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer Use after free attempt"; flow:to_server,established; file_data; content:"hgroup.appendChild(iElement)"; content:"document.execCommand(|22|justifyCenter|22| , false, |22 22|)|3B|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-2823; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051; classtype:attempted-user; sid:31626; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Use after free attempt"; flow:to_client,established; file_data; content:"hgroup.appendChild(iElement)"; content:"document.execCommand(|22|justifyCenter|22| , false, |22 22|)|3B|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-2823; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051; classtype:attempted-user; sid:31625; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer EventListener use after free attempt"; flow:to_server,established; file_data; content:"<meta"; nocase; content:".addEventListener"; nocase; content:"DOM"; within:55; nocase; content:".createRange|28|"; distance:0; nocase; content:".deleteContents|28|"; within:250; nocase; content:".createRange|28|"; distance:0; nocase; content:".deleteContents|28|"; within:250; nocase; metadata:policy balanced-ips alert, policy security-ips drop, service smtp; reference:bugtraq,55645; reference:cve,2012-2546; reference:url,osvdb.org/show/osvdb/85572; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-063; classtype:attempted-user; sid:31624; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer EventListener use after free attempt"; flow:to_client,established; file_data; content:"<meta"; nocase; content:".addEventListener"; nocase; content:"DOM"; within:55; nocase; content:".createRange|28|"; distance:0; nocase; content:".deleteContents|28|"; within:250; nocase; content:".createRange|28|"; distance:0; nocase; content:".deleteContents|28|"; within:250; nocase; metadata:policy balanced-ips alert, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,55645; reference:cve,2012-2546; reference:url,osvdb.org/show/osvdb/85572; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-063; classtype:attempted-user; sid:31623; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer onreadystatechange use after free attempt"; flow:to_server,established; file_data; content:"onreadystatechange"; fast_pattern:only; content:"selectAll"; nocase; content:"Indent"; within:150; nocase; content:"selectAll"; distance:0; nocase; content:"fieldset"; distance:0; nocase; content:"changeStyles"; within:50; nocase; metadata:policy balanced-ips alert, policy security-ips drop, service smtp; reference:cve,2014-4063; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051; classtype:attempted-user; sid:31622; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer onreadystatechange use after free attempt"; flow:to_client,established; file_data; content:"onreadystatechange"; fast_pattern:only; content:"selectAll"; nocase; content:"Indent"; within:150; nocase; content:"selectAll"; distance:0; nocase; content:"fieldset"; distance:0; nocase; content:"changeStyles"; within:50; nocase; metadata:policy balanced-ips alert, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4063; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051; classtype:attempted-user; sid:31621; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer kbd element use-after-free attempt"; flow:to_server,established; file_data; content:"<object>"; content:"<kbd>"; within:50; content:"|2A 3A|nth-child|28|-"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4050; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051; classtype:attempted-user; sid:31620; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer kbd element use-after-free attempt"; flow:to_client,established; file_data; content:"<object>"; content:"<kbd>"; within:50; content:"|2A 3A|nth-child|28|-"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4050; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051; classtype:attempted-user; sid:31619; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer meter element use-after-free attempt"; flow:to_server,established; file_data; content:".createElement"; content:"meter"; within:20; content:".cloneNode"; distance:0; content:".offsetHeight"; distance:0; metadata:service smtp; reference:cve,2012-2548; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-063; classtype:attempted-user; sid:31618; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer meter element use-after-free attempt"; flow:to_client,established; file_data; content:".createElement"; content:"meter"; within:20; content:".cloneNode"; distance:0; content:".offsetHeight"; distance:0; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-2548; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-063; classtype:attempted-user; sid:31617; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 5 XML page object type validation"; flow:to_server,established; file_data; content:"datasrc|3D 22 23|"; content:"datafld|3D 22|"; within:50; content:"<xml"; distance:0; content:"<![CDATA"; within:150; pcre:"/datasrc\x3D\x22\x23(?P<id>\w+)\x22\s*datafld\x3D\x22(?P<tag1>\w+)\x22.*\<xml\s+id\x3D\x22(?P=id)\x22\>\s*\<\w+\>\s*\<(?P=tag1)\>\s*\<\x21\x5BCDATA/"; metadata:service smtp; reference:bugtraq,8565; reference:cve,2003-0809; classtype:attempted-user; sid:31646; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 5 XML page object type validation"; flow:to_client,established; file_data; content:"datasrc|3D 22 23|"; content:"datafld|3D 22|"; within:50; content:"<xml"; distance:0; content:"<![CDATA"; within:150; pcre:"/datasrc\x3D\x22\x23(?P<id>\w+)\x22\s*datafld\x3D\x22(?P<tag1>\w+)\x22.*\<xml\s+id\x3D\x22(?P=id)\x22\>\s*\<\w+\>\s*\<(?P=tag1)\>\s*\<\x21\x5BCDATA/"; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,8565; reference:cve,2003-0809; classtype:attempted-user; sid:31645; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer GetClassObject use after free attempt"; flow:to_server,established; file_data; content:"getElementsBytagName"; fast_pattern:only; content:".removeChild"; nocase; content:"<object"; nocase; content:"onerror"; within:75; nocase; pcre:"/\x3C(?P<obj>\w+)\s[^\x3e]*?onerror\s*?=\s*?[\x22\x27](?P<func>\w+)\s*?\x28.*?function\s+?(?P=func)\s*?\x28[^\x7b]+?\x7b[^\x7d]*?getElementsByTagName\x28[\x22\x27](?P=obj)[\x22\x27]?\s*?\x29[^\x7d]*?removeChild\s*?\x28/si"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-5049; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097; classtype:attempted-user; sid:31763; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer GetClassObject use after free attempt"; flow:to_server,established; file_data; content:"getElementByID"; fast_pattern:only; content:".removeChild"; nocase; content:"<object"; nocase; content:"onerror"; within:75; nocase; pcre:"/function\s+?(?P<func>\w+?)\s*?\x28[^\x7b]+?\x7b[^\x7d]*?getElementByID\x28[\x22\x27](?P<obj>\w+?)[\x22\x27]?\s*?\x29[^\x7d]*?removeChild\s*?\x28.*?(?P=obj)\s[^\x3e]*?onerror\s*?=\s*?[\x22\x27](?P=func)\s*?\x28/si"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-5049; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097; classtype:attempted-user; sid:31762; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer GetClassObject use after free attempt"; flow:to_server,established; file_data; content:"getElementByID"; fast_pattern:only; content:".removeChild"; nocase; content:"<object"; nocase; content:"onerror"; within:75; nocase; pcre:"/\x3C(?P<obj>\w+)\s[^\x3e]*?onerror\s*?=\s*?[\x22\x27](?P<func>\w+)\s*?\x28.*?function\s+?(?P=func)\s*?\x28[^\x7b]+?\x7b[^\x7d]*?getElementByID\x28[\x22\x27](?P=obj)[\x22\x27]?\s*?\x29[^\x7d]*?removeChild\s*?\x28/si"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-5049; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097; classtype:attempted-user; sid:31761; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer GetClassObject use after free attempt"; flow:to_server,established; file_data; content:"ElementsBytagName"; nocase; content:".removeChild"; nocase; content:"<object"; nocase; content:"onerror"; within:75; nocase; content:"CollectGarbage()"; fast_pattern:only; pcre:"/function\s+?(?P<func>\w+?)\s*?\x28[^\x7d]*?ElementsByTagName[^\x7d]*?removeChild\s*?\x28.*?object\s[^\x3e]*?onerror\s*?\x3D\s*?[\x22\x27](?P=func)\s*?\x28/si"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-5049; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097; classtype:attempted-user; sid:31760; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 InsertInputSubmit use after free attempt"; flow:to_server,established; file_data; content:".applyElement"; nocase; content:"document.createElement"; within:55; nocase; content:".createTextRange"; within:250; nocase; content:".execCommand"; within:55; nocase; content:"InsertInputSubmit"; within:40; fast_pattern; nocase; content:".innerHTML"; within:250; nocase; content:".execCommand"; within:250; nocase; content:"Undo"; within:30; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4088; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-052; classtype:attempted-user; sid:31802; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 InsertInputSubmit use after free attempt"; flow:to_client,established; file_data; content:".applyElement"; nocase; content:"document.createElement"; within:55; nocase; content:".createTextRange"; within:250; nocase; content:".execCommand"; within:55; nocase; content:"InsertInputSubmit"; within:40; fast_pattern; nocase; content:".innerHTML"; within:250; nocase; content:".execCommand"; within:250; nocase; content:"Undo"; within:30; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4088; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-052; classtype:attempted-user; sid:31801; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTableCell Use After Free exploit attempt"; flow:to_server,established; file_data; content:"document.addEventListener("; content:"DOMNodeInserted"; within:20; content:".applyElement("; content:"inside"; within:25; nocase; content:"document.body.createTextRange().execCommand("; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4092; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052; classtype:attempted-user; sid:31800; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTableCell Use After Free exploit attempt"; flow:to_client,established; file_data; content:"document.addEventListener("; content:"DOMNodeInserted"; within:20; content:".applyElement("; content:"inside"; within:25; nocase; content:"document.body.createTextRange().execCommand("; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4092; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052; classtype:attempted-user; sid:31799; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 CTreeNode use after free"; flow:to_server,established; file_data; content:"document.addEventListener"; nocase; content:"DOMNodeInserted"; within:20; distance:2; fast_pattern; nocase; content:"function"; within:20; distance:2; nocase; content:".selectAllChildren|28|"; within:80; distance:5; nocase; content:"document.selection.createRange|28|"; distance:0; nocase; content:".pasteHTML|28|"; within:20; nocase; content:"</th>"; distance:0; nocase; metadata:service smtp; reference:cve,2014-4089; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-052; classtype:attempted-user; sid:31797; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 CTreeNode use after free"; flow:to_client,established; file_data; content:"document.addEventListener"; nocase; content:"DOMNodeInserted"; within:20; distance:2; fast_pattern; nocase; content:"function"; within:20; distance:2; nocase; content:".selectAllChildren|28|"; within:80; distance:5; nocase; content:"document.selection.createRange|28|"; distance:0; nocase; content:".pasteHTML|28|"; within:20; nocase; content:"</th>"; distance:0; nocase; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2014-4089; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-052; classtype:attempted-user; sid:31796; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer access violation attempt"; flow:to_server,established; file_data; content:"document.createElement(|22|head|22|)"; nocase; content:"createTextRange().execCommand(|22|Outdent|22|)"; nocase; content:"createTextRange().execCommand(|22|InsertInputCheckbox|22|)"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4081; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052; classtype:attempted-user; sid:31795; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer access violation attempt"; flow:to_client,established; file_data; content:"document.createElement(|22|head|22|)"; nocase; content:"createTextRange().execCommand(|22|Outdent|22|)"; nocase; content:"createTextRange().execCommand(|22|InsertInputCheckbox|22|)"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4081; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052; classtype:attempted-user; sid:31794; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CGeneratedTreeNode use-after-free attempt"; flow:to_client,established; file_data; content:".createElement(|22|th|22|)"; nocase; content:"<v:oval"; nocase; content:".execCommand(|22|Indent|22|)"; content:".execCommand(|22|Outdent|22|)"; fast_pattern:only; content:".onbeforeeditfocus"; content:".createElement(|22|html|22|)"; nocase; content:".appendChild"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4084; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-046; classtype:attempted-user; sid:31793; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CGeneratedTreeNode use-after-free attempt"; flow:to_client,established; file_data; content:".createElement(|22|th|22|)"; nocase; content:"<v:oval"; nocase; content:".execCommand(|22|Indent|22|)"; content:".execCommand(|22|Outdent|22|)"; fast_pattern:only; content:".onbeforeeditfocus"; content:".createElement(|22|html|22|)"; nocase; content:".appendChild"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4084; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-046; classtype:attempted-user; sid:31792; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CAttrArray use after free attempt"; flow:to_server,established; file_data; content:"for|28|var i=0|3B|i<0x1FFFF"; fast_pattern:only; content:"setAttribute"; content:"['lang']"; within:200; metadata:policy security-ips drop, service smtp; reference:cve,2014-4065; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-052; classtype:attempted-user; sid:31791; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CAttrArray use after free attempt"; flow:to_client,established; file_data; content:"for|28|var i=0|3B|i<0x1FFFF"; fast_pattern:only; content:"setAttribute"; content:"['lang']"; within:200; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4065; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-052; classtype:attempted-user; sid:31790; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer justifying text with an incorrect type use after free attempt"; flow:to_server,established; file_data; content:".applyElement"; content:".createTextNode"; content:".insertAdjacentHTML("; content:"beforeBegin"; within:18; content:".execCommand("; content:"Justify"; within:12; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4080; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052; classtype:attempted-user; sid:31789; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer justifying text with an incorrect type use after free attempt"; flow:to_client,established; file_data; content:".applyElement"; content:".createTextNode"; content:".insertAdjacentHTML("; content:"beforeBegin"; within:18; content:".execCommand("; content:"Justify"; within:12; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4080; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052; classtype:attempted-user; sid:31788; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer style-image-url use after free attempt"; flow:to_server,established; file_data; content:"onbeforeactivate"; content:"list-style-image|3A|url"; fast_pattern:only; pcre:"/id=[\x22\x27\s]*?(?P<id>[\w\d]+)[^\x3e]*onbeforeactivate=[\x22\x27\s]*(?P=id)\x2e/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4087; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052; classtype:attempted-user; sid:31787; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer style-image-url use after free attempt"; flow:to_client,established; file_data; content:"onbeforeactivate"; content:"list-style-image|3A|url"; fast_pattern:only; pcre:"/id=[\x22\x27\s]*?(?P<id>[\w\d]+)[^\x3e]*onbeforeactivate=[\x22\x27\s]*(?P=id)\x2e/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4087; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052; classtype:attempted-user; sid:31786; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 C1DLayout ruby element use-after-free attempt"; flow:to_server,established; file_data; content:"style.position"; nocase; content:".createTextRange().execCommand"; within:250; fast_pattern; nocase; content:"style.position"; within:100; nocase; content:"createTextRange().select()"; within:250; nocase; content:"<ruby id="; within:400; metadata:policy security-ips drop, service smtp; reference:cve,2014-4094; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052; classtype:attempted-user; sid:31785; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 C1DLayout ruby element use-after-free attempt"; flow:to_client,established; file_data; content:"style.position"; nocase; content:".createTextRange().execCommand"; within:250; fast_pattern; nocase; content:"style.position"; within:100; nocase; content:"createTextRange().select()"; within:250; nocase; content:"<ruby id="; within:400; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4094; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052; classtype:attempted-user; sid:31784; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor instance use after free attempt"; flow:to_server,established; file_data; content:"progress"; content:"source"; content:"contentEditable"; content:"removeNode"; content:"moveToElementText"; fast_pattern:only; content:"moveEnd"; content:"character"; within:40; content:"swapNode"; content:"footer"; within:40; content:"file://"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4095; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052; classtype:attempted-user; sid:31783; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor instance use after free attempt"; flow:to_client,established; file_data; content:"progress"; content:"source"; content:"contentEditable"; content:"removeNode"; content:"moveToElementText"; fast_pattern:only; content:"moveEnd"; content:"character"; within:40; content:"swapNode"; content:"footer"; within:40; content:"file://"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4095; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052; classtype:attempted-user; sid:31782; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CHtmlLayout use after free attempt"; flow:to_server,established; file_data; content:"document.body.createTextRange|28 29|.queryCommandState|28 22|InsertIFrame|22 29|"; fast_pattern:only; content:".swapNode|28|document.createTextNode|28|"; metadata:service smtp; reference:cve,2014-4086; reference:url,reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052; classtype:attempted-user; sid:31812; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHtmlLayout use after free attempt"; flow:to_client,established; file_data; content:"document.body.createTextRange|28 29|.queryCommandState|28 22|InsertIFrame|22 29|"; fast_pattern:only; content:".swapNode|28|document.createTextNode|28|"; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2014-4086; reference:url,reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052; classtype:attempted-user; sid:31811; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer integer overflow exploit attempt"; flow:to_server,established; file_data; content:"createElement|28|"; content:"samp"; within:7; content:"document|2E|body|2E|onbeforeactivate"; content:"parentNode.applyElement|28|"; within:50; content:"document|2E|body|2E|contentEditable"; content:"getSelection|28 29 2E|addRange("; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4082; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052; classtype:attempted-user; sid:31810; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer integer overflow exploit attempt"; flow:to_client,established; file_data; content:"createElement|28|"; content:"samp"; within:7; content:"document|2E|body|2E|onbeforeactivate"; content:"parentNode.applyElement|28|"; within:50; content:"document|2E|body|2E|contentEditable"; content:"getSelection|28 29 2E|addRange|28|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4082; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052; classtype:attempted-user; sid:31809; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer URL domain spoof attempt"; flow:to_server,established; file_data; content:"%01"; fast_pattern:only; content:"|40|www|2E|"; pcre:"/href=[\x22\x27][^\x22\x27]*?\x2501[^\x22\x27]*?\x40www\x2e/is"; metadata:service smtp; reference:cve,2003-1025; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-004; classtype:attempted-user; sid:31888; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer URL domain spoof attempt"; flow:to_client,established; file_data; content:"%01"; fast_pattern:only; content:"|40|www|2E|"; pcre:"/href=[\x22\x27][^\x22\x27]*?\x2501[^\x22\x27]*?\x40www\x2e/is"; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2003-1025; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-004; classtype:attempted-user; sid:31887; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTransientLookaside object use after free attempt"; flow:to_server,established; file_data; content:"|3A|nth-child|28|"; fast_pattern:only; content:"display|3A|"; nocase; content:"inline-table|3B|"; within:20; nocase; content:"transition-duration|3A|"; nocase; content:"|3C|article"; nocase; content:"document.getElementById"; nocase; content:".parentNode.removeChild|28|"; nocase; pcre:"/\x3carticle\s*?id\s*?\x3d\s*?[\x22\x27](?P<art>\w+).*?(?P<elem>\w+)\s*?\x3d\s*?document\.getElementById\s*?\x28\s*?[\x22\x27](?P=art).*?(?P=elem)\.parentNode\.removeChild\s*?\x28\s*?(?P=elem)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4126; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-056; classtype:attempted-user; sid:32169; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTransientLookaside object use after free attempt"; flow:to_client,established; file_data; content:"|3A|nth-child|28|"; fast_pattern:only; content:"display|3A|"; nocase; content:"inline-table|3B|"; within:20; nocase; content:"transition-duration|3A|"; nocase; content:"|3C|article"; nocase; content:"document.getElementById"; nocase; content:".parentNode.removeChild|28|"; nocase; pcre:"/\x3carticle\s*?id\s*?\x3d\s*?[\x22\x27](?P<art>\w+).*?(?P<elem>\w+)\s*?\x3d\s*?document\.getElementById\s*?\x28\s*?[\x22\x27](?P=art).*?(?P=elem)\.parentNode\.removeChild\s*?\x28\s*?(?P=elem)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4126; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-056; classtype:attempted-user; sid:32168; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE GetUpdatedLayout partial table declaration use-after-free attempt"; flow:to_server,established; stream_size:server,<,16000; file_data; content:".execCommand|28 22|SelectAll|22 29|"; fast_pattern:only; content:"<table>"; nocase; content:!"</table>"; distance:0; nocase; content:"<script>"; distance:0; nocase; metadata:service smtp; reference:cve,2014-4128; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-056; classtype:attempted-user; sid:32164; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE GetUpdatedLayout partial table declaration use-after-free attempt"; flow:to_client,established; stream_size:server,<,16000; file_data; content:".execCommand|28 22|SelectAll|22 29|"; fast_pattern:only; content:"<table>"; nocase; content:!"</table>"; distance:0; nocase; content:"<script>"; distance:0; nocase; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2014-4128; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-056; classtype:attempted-user; sid:32163; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer superscript invalid parameter denial of service attempt"; flow:to_server,established; file_data; content:"document.createElement"; nocase; content:"lang"; within:300; nocase; content:"document.createElement"; distance:0; nocase; content:"lang"; within:300; nocase; content:"document.createElement"; distance:0; nocase; content:"lang"; within:300; nocase; content:"text_range.execCommand"; distance:0; nocase; content:"superscript"; within:20; fast_pattern; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4133; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-056; classtype:attempted-dos; sid:32162; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer superscript invalid parameter denial of service attempt"; flow:to_client,established; file_data; content:"document.createElement"; nocase; content:"lang"; within:300; nocase; content:"document.createElement"; distance:0; nocase; content:"lang"; within:300; nocase; content:"document.createElement"; distance:0; nocase; content:"lang"; within:300; nocase; content:"text_range.execCommand"; distance:0; nocase; content:"superscript"; within:20; fast_pattern; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4133; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-056; classtype:attempted-dos; sid:32161; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup Object use after free attempt"; flow:to_server,established; file_data; content:"obj.textContent = |22|%u33%u17%uB0%u5D%uCC%u84%u91%uD2%uE5%uDC|22|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4132; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056; classtype:attempted-user; sid:32160; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup Object use after free attempt"; flow:to_client,established; file_data; content:"obj.textContent = |22|%u33%u17%uB0%u5D%uCC%u84%u91%uD2%uE5%uDC|22|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4132; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056; classtype:attempted-user; sid:32159; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 CMarkup GetMarkupTitle use-after-free attempt"; flow:to_server,established; file_data; content:"DOMAttrModified"; nocase; content:"currentTarget.parentNode.swapNode"; fast_pattern:only; content:"currentTarget.previousSibling"; nocase; content:"<iframe"; distance:0; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4130; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056; classtype:attempted-user; sid:32158; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 CMarkup GetMarkupTitle use-after-free attempt"; flow:to_client,established; file_data; content:"DOMAttrModified"; nocase; content:"currentTarget.parentNode.swapNode"; fast_pattern:only; content:"currentTarget.previousSibling"; nocase; content:"<iframe"; distance:0; nocase; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4130; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056; classtype:attempted-user; sid:32157; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer FormatContext Use after free attempt"; flow:to_server,established; file_data; content:"table id="; nocase; content:"document.createElement(|22|bdo|22|)|3B|"; nocase; content:"document.createElement(|22|base|22|)|3B|"; nocase; content:", |22|inside|22|)|3B|"; nocase; content:"style.styleFloat=|27|right|27 3B|"; nocase; content:"document.createElement(|22|ruby|22|),|22|inside|22|)|3B|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4129; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056; classtype:attempted-user; sid:32156; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer FormatContext Use after free attempt"; flow:to_client,established; file_data; content:"table id="; nocase; content:"document.createElement(|22|bdo|22|)|3B|"; nocase; content:"document.createElement(|22|base|22|)|3B|"; nocase; content:", |22|inside|22|)|3B|"; nocase; content:"style.styleFloat=|27|right|27 3B|"; nocase; content:"document.createElement(|22|ruby|22|),|22|inside|22|)|3B|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4129; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056; classtype:attempted-user; sid:32155; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer innerHTML use after free attempt"; flow:to_server,established; file_data; content:"<v:line"; fast_pattern:only; content:".contentEditable"; content:"true"; within:10; content:"execCommand"; content:"Undo"; within:10; content:"innerHTML"; pcre:"/title\s+id=(?P<title>\w+).*?(?P=title).innerHtml\s*?=\s*?(\x22\x22|\x27\x27)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4127; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056; classtype:attempted-user; sid:32154; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer innerHTML use after free attempt"; flow:to_client,established; file_data; content:"<v:line"; fast_pattern:only; content:".contentEditable"; content:"true"; within:10; content:"execCommand"; content:"Undo"; within:10; content:"innerHTML"; pcre:"/title\s+id=(?P<title>\w+).*?(?P=title).innerHtml\s*?=\s*?(\x22\x22|\x27\x27)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4127; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056; classtype:attempted-user; sid:32153; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer DCOM sandbox escape attempt"; flow:to_server,established; file_data; content:"|16 13 09 14 13 08 14 13 07 14 13 06 14 0D 14 13 05 28 3E 01 00 06 18 5A FE 0F 13 04 28 0F 00 00 06 13 08 1F 18 28 1E 01 00 06|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4073; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-057; classtype:attempted-user; sid:32140; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer DCOM sandbox escape attempt"; flow:to_client,established; file_data; content:"|16 13 09 14 13 08 14 13 07 14 13 06 14 0D 14 13 05 28 3E 01 00 06 18 5A FE 0F 13 04 28 0F 00 00 06 13 08 1F 18 28 1E 01 00 06|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4073; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-057; classtype:attempted-user; sid:32139; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer element attribute use after free attempt"; flow:to_client,established; file_data; content:"document.body.all["; nocase; content:".setAttribute"; within:175; nocase; content:"document.body.all["; within:250; nocase; content:".setAttribute"; within:175; nocase; content:"document.body.all["; distance:0; nocase; content:"].appendChild|28|"; within:30; nocase; content:"document.createElement|28|"; within:300; nocase; content:".setAttribute|28|"; within:300; nocase; pcre:"/document\x2ebody\x2eall\x5b\d*\x5D\x2eappendChild\x28(?P<var>\w+)\x29.*?var\s*(?P=var)\s*?=\s*document.createElement\x28.*?(?P=var)\x2esetAttribute\x28/si"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4134; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056; classtype:attempted-user; sid:32138; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer element attribute use after free attempt"; flow:to_server,established; file_data; content:"document.body.all["; nocase; content:".setAttribute"; within:175; nocase; content:"document.body.all["; within:250; nocase; content:".setAttribute"; within:175; nocase; content:"document.body.all["; distance:0; nocase; content:"].appendChild|28|"; within:30; nocase; content:"document.createElement|28|"; within:300; nocase; content:".setAttribute|28|"; within:300; nocase; pcre:"/document\x2ebody\x2eall\x5b\d*\x5D\x2eappendChild\x28(?P<var>\w+)\x29.*?var\s*(?P=var)\s*?=\s*document.createElement\x28.*?(?P=var)\x2esetAttribute\x28/si"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4134; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056; classtype:attempted-user; sid:32137; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CFunctionPointer use after free exploit attempt"; flow:to_server,established; file_data; content:".getElementsByTagName("; nocase; content:"rt"; within:3; content:".execCommand("; nocase; content:"ms-beginUndoUnit"; within:17; fast_pattern; nocase; content:"document.body.parentElement"; nocase; content:"document.body.parentTextEdit"; nocase; content:".execCommand("; nocase; content:"Undo"; within:5; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4141; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056; classtype:attempted-user; sid:32185; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CFunctionPointer use after free exploit attempt"; flow:to_client,established; file_data; content:".getElementsByTagName("; nocase; content:"rt"; within:3; content:".execCommand("; nocase; content:"ms-beginUndoUnit"; within:17; fast_pattern; nocase; content:"document.body.parentElement"; nocase; content:"document.body.parentTextEdit"; nocase; content:".execCommand("; nocase; content:"Undo"; within:5; nocase; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4141; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056; classtype:attempted-user; sid:32184; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTableLayout AddRow out of bounds array access heap corruption attempt"; flow:to_server,established; file_data; content:"createT"; nocase; content:"document.getElementById("; distance:0; nocase; content:"deleteRow(-1)"; within:80; fast_pattern; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4137; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056; classtype:attempted-user; sid:32183; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTableLayout AddRow out of bounds array access heap corruption attempt"; flow:to_client,established; file_data; content:"createT"; nocase; content:"document.getElementById("; distance:0; nocase; content:"deleteRow(-1)"; within:80; fast_pattern; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4137; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056; classtype:attempted-user; sid:32182; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer address bar spoofing without scripting"; flow:to_server,established; file_data; content:"<body"; nocase; content:"<a "; distance:0; nocase; content:"target="; within:80; nocase; content:"newwindow"; within:10; nocase; content:"href="; within:80; nocase; pcre:"/<a[^>]{1,80}target=(\x22|\x27|)newwindow(\x22|\x27|)[^>]{1,80}href=\s*(\x5C[\x22\x27])?\s*(?!(about|cdl|dvd|file|ftp|gopher|http|https|ipp|its|javascript|local|mailto|mhtml|mk|msdaipp|ms-its|res|sysimage|tv|vbscript|wia)).{1,10}\:/i"; metadata:service smtp; reference:bugtraq,10943; reference:cve,2004-2219; classtype:attempted-user; sid:32231; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer address bar spoofing without scripting"; flow:to_client,established; file_data; content:"<body"; nocase; content:"<a "; distance:0; nocase; content:"target="; within:80; nocase; content:"newwindow"; within:10; nocase; content:"href="; within:80; nocase; pcre:"/<a[^>]{1,80}target=(\x22|\x27|)newwindow(\x22|\x27|)[^>]{1,80}href=\s*(\x5C[\x22\x27])?\s*(?!(about|cdl|dvd|file|ftp|gopher|http|https|ipp|its|javascript|local|mailto|mhtml|mk|msdaipp|ms-its|res|sysimage|tv|vbscript|wia)).{1,10}\:/i"; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,10943; reference:cve,2004-2219; classtype:attempted-user; sid:32230; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 out of bounds array access attempt"; flow:to_server,established; file_data; content:"<basefont"; nocase; content:"</basefont"; within:250; nocase; pcre:"/\x3cbasefont.{0,250}(&#13|&#xd|0x0D|0x000D|0x0000000D|\x5cu000D).{0,5}\x3c\x2fbasefont/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4140; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-056; classtype:attempted-user; sid:32267; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 out of bounds array access attempt"; flow:to_client,established; file_data; content:"<basefont"; nocase; content:"</basefont"; within:250; nocase; pcre:"/\x3cbasefont.{0,250}(&#13|&#xd|0x0D|0x000D|0x0000000D|\x5cu000D).{0,5}\x3c\x2fbasefont/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4140; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-056; classtype:attempted-user; sid:32266; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE ActiveX installer broker object sandbox escape attempt"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|55 8B EC 6A FF 68 A8 31 01 10 64 A1 00 00 00 00 50 83 EC 0C A1 20 B0 01 10 33 C5 89 45 F0 56 50|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4123; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-056; classtype:attempted-user; sid:32265; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE ActiveX installer broker object sandbox escape attempt"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|55 8B EC 6A FF 68 A8 31 01 10 64 A1 00 00 00 00 50 83 EC 0C A1 20 B0 01 10 33 C5 89 45 F0 56 50|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4123; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-056; classtype:attempted-user; sid:32264; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer Active X installer broker privilege elevation attempt"; flow:to_server,established; file_data; content:"r Broker: %p|0A 00 00 00 00|Created AX Install Broker: %p|0A|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4124; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056; classtype:attempted-user; sid:32263; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Active X installer broker privilege elevation attempt"; flow:to_client,established; file_data; content:"r Broker: %p|0A 00 00 00 00|Created AX Install Broker: %p|0A|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4124; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056; classtype:attempted-user; sid:32262; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer onreadystatechange use after free attempt"; flow:to_server,established; file_data; content:"onreadystatechange"; nocase; content:"execCommand|28|"; within:50; nocase; content:"selectAll"; within:25; nocase; content:"execCommand|28|"; within:50; nocase; content:"Indent"; within:25; nocase; metadata:policy balanced-ips alert, policy security-ips drop, service smtp; reference:cve,2014-4063; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051; classtype:attempted-user; sid:32318; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer onreadystatechange use after free attempt"; flow:to_client,established; file_data; content:"onreadystatechange"; nocase; content:"execCommand|28|"; within:50; nocase; content:"selectAll"; within:25; nocase; content:"execCommand|28|"; within:50; nocase; content:"Indent"; within:25; nocase; metadata:policy balanced-ips alert, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4063; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051; classtype:attempted-user; sid:32317; rev:1;)
alert tcp any any -> $HOME_NET 25 (msg:"BROWSER-IE Microsoft Internet Explorer overlapping object boundaries memory corruption attempt"; flow:to_server,established; file_data; content:".addEventListener"; content:"DOMNodeRemoved"; within:32; fast_pattern; content:".createElement|28|"; within:150; content:"div"; within:10; content:".appendChild|28|"; within:150; content:".selectAllChildren|28|"; within:150; content:".deleteFromDocument|28|"; within:100; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0274; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:32365; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer overlapping object boundaries memory corruption attempt"; flow:to_client,established; file_data; content:".addEventListener"; content:"DOMNodeRemoved"; within:32; fast_pattern; content:".createElement|28|"; within:150; content:"div"; within:10; content:".appendChild|28|"; within:150; content:".selectAllChildren|28|"; within:150; content:".deleteFromDocument|28|"; within:100; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0274; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:32364; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer VML use after free attempt"; flow:to_server,established; file_data; content:"url|28 23|default|23|VML|29|"; fast_pattern:only; content:"schemas-microsoft-com|3A|vml"; nocase; content:"onpropertychange"; nocase; content:"removeNode"; distance:0; nocase; pcre:"/onpropertychange(\x22\x5d)?\s*?=\s*?function\s+?\x28\s*?\x29\s*?\x7b[^\x7d]*?this[^\x3b]+?removeNode[^\x3b]*?\x28true\x29/si"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,67075; reference:cve,2014-1776; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-021; classtype:attempted-user; sid:32363; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer VML use after free attempt"; flow:to_client,established; file_data; content:"url|28 23|default|23|VML|29|"; fast_pattern:only; content:"schemas-microsoft-com|3A|vml"; nocase; content:"onpropertychange"; nocase; content:"removeNode"; distance:0; nocase; pcre:"/onpropertychange(\x22\x5d)?\s*?=\s*?function\s+?\x28\s*?\x29\s*?\x7b[^\x7d]*?this[^\x3b]+?removeNode[^\x3b]*?\x28true\x29/si"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,67075; reference:cve,2014-1776; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-021; classtype:attempted-user; sid:32362; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CQuotes use-after-free attempt"; flow:to_server,established; file_data; content:"applyElement(document.createElement("; nocase; content:"frameset"; within:10; nocase; content:"window.location.href"; within:50; nocase; content:"quotes:none"; within:200; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6351; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065; classtype:attempted-user; sid:32498; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CQuotes use-after-free attempt"; flow:to_client,established; file_data; content:"applyElement(document.createElement("; nocase; content:"frameset"; within:10; nocase; content:"window.location.href"; within:50; nocase; content:"quotes:none"; within:200; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6351; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065; classtype:attempted-user; sid:32497; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 CStyleSheet object use after free attempt"; flow:to_server,established; file_data; content:".setAttribute|28 22|type|22|, null|29|"; fast_pattern:only; content:".addImport"; content:".imports.item|28|"; within:50; content:".removeImport|28|"; within:50; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6341; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065; classtype:attempted-user; sid:32496; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 CStyleSheet object use after free attempt"; flow:to_client,established; file_data; content:".setAttribute|28 22|type|22|, null|29|"; fast_pattern:only; content:".addImport"; content:".imports.item|28|"; within:50; content:".removeImport|28|"; within:50; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6341; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065; classtype:attempted-user; sid:32495; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer information disclosure attempt"; flow:to_server,established; file_data; content:"window.onerror = function(e, url) {"; nocase; content:"<script src|3D 22|http|3A|//vict"; within:75; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6346; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065; classtype:misc-activity; sid:32492; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer information disclosure attempt"; flow:to_client,established; file_data; content:"window.onerror = function(e, url) {"; nocase; content:"<script src|3D 22|http|3A|//vict"; within:75; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6346; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065; classtype:misc-activity; sid:32491; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer immutable application settings sandbox escape attempt"; flow:to_server,established; file_data; content:"|5C 00|B|00|a|00|s|00|e|00|N|00|a|00|m|00|e|00|d|00|O|00|b|00|j|00|e|00|c|00|t|00|s|00 5C 00|i|00|e|00|_|00|i|00|a|00|s|00|_"; fast_pattern:only; content:"|00|-|00|0|00|0|00|0|00|0|00|-|00|0|00|0|00|0|00|0|00|-|00|0|00|0|00|0|00|0|00|-|00|0|00|0|00|0|00|0|00|0|00|0|00|0|00|0|00|0|00|0|00|0|00|0"; content:"|5C 00|S|00|e|00|s|00|s|00|i|00|o|00|n|00|s|00 5C 00|"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6349; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065; classtype:attempted-user; sid:32485; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer immutable application settings sandbox escape attempt"; flow:to_client,established; file_data; content:"|5C 00|B|00|a|00|s|00|e|00|N|00|a|00|m|00|e|00|d|00|O|00|b|00|j|00|e|00|c|00|t|00|s|00 5C 00|i|00|e|00|_|00|i|00|a|00|s|00|_"; fast_pattern:only; content:"|00|-|00|0|00|0|00|0|00|0|00|-|00|0|00|0|00|0|00|0|00|-|00|0|00|0|00|0|00|0|00|-|00|0|00|0|00|0|00|0|00|0|00|0|00|0|00|0|00|0|00|0|00|0|00|0"; content:"|5C 00|S|00|e|00|s|00|s|00|i|00|o|00|n|00|s|00 5C 00|"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6349; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065; classtype:attempted-user; sid:32484; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer pasteHTML use after free attempt"; flow:to_server,established; file_data; content:".selection.createRange().pasteHTML("; fast_pattern:only; content:".createTextRange("; nocase; content:"Outdent"; within:25; nocase; content:".createTextRange("; nocase; content:"SelectAll"; within:25; nocase; content:".style.display"; nocase; content:"none"; within:15; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6339; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065; classtype:attempted-user; sid:32483; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer pasteHTML use after free attempt"; flow:to_client,established; file_data; content:".selection.createRange().pasteHTML("; fast_pattern:only; content:".createTextRange("; nocase; content:"Outdent"; within:25; nocase; content:".createTextRange("; nocase; content:"SelectAll"; within:25; nocase; content:".style.display"; nocase; content:"none"; within:15; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6339; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065; classtype:attempted-user; sid:32482; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CSecurityContext use after free attempt"; flow:to_server,established; file_data; content:".clearAttributes("; fast_pattern:only; content:".contentWindow.document"; nocase; content:"setTimeout("; within:150; nocase; content:".contentWindow.document"; within:800; nocase; content:"setTimeout("; within:150; nocase; content:".contentWindow.document"; within:800; nocase; content:"setTimeout("; within:150; nocase; metadata:policy balanced-ips alert, policy security-ips drop, service smtp; reference:cve,2014-4143; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065; classtype:attempted-user; sid:32479; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSecurityContext use after free attempt"; flow:to_client,established; file_data; content:".clearAttributes("; fast_pattern:only; content:".contentWindow.document"; nocase; content:"setTimeout("; within:150; nocase; content:".contentWindow.document"; within:800; nocase; content:"setTimeout("; within:150; nocase; content:".contentWindow.document"; within:800; nocase; content:"setTimeout("; within:150; nocase; metadata:policy balanced-ips alert, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4143; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065; classtype:attempted-user; sid:32478; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 VBScript redim preserve denial-of-service attempt"; flow:to_server,established; file_data; content:"redim"; nocase; content:"preserve"; within:20; nocase; content:"(&h"; within:20; byte_test:6,>,1000,0,relative,string,hex; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6332; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-064; classtype:attempted-dos; sid:32473; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 VBScript redim preserve denial-of-service attempt"; flow:to_server,established; file_data; content:"redim"; nocase; content:"preserve"; within:20; nocase; content:"("; within:20; byte_test:6,>,1000,0,relative,string,dec; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6332; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-064; classtype:attempted-dos; sid:32472; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 VBScript redim preserve denial-of-service attempt"; flow:to_client,established; file_data; content:"redim"; nocase; content:"preserve"; within:20; nocase; content:"(&h"; within:20; byte_test:6,>,1000,0,relative,string,hex; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6332; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-064; classtype:attempted-dos; sid:32471; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 VBScript redim preserve denial-of-service attempt"; flow:to_client,established; file_data; content:"redim"; nocase; content:"preserve"; within:20; nocase; content:"("; within:20; byte_test:6,>,1000,0,relative,string,dec; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6332; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-064; classtype:attempted-dos; sid:32470; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CPtsTextParaclient out of bounds error remote code execution attempt"; flow:to_server,established; file_data; content:"position: relative"; nocase; content:"position: fixed"; nocase; content:"display: block"; nocase; content:"appendChild(document.createElement"; fast_pattern:only; content:"addNode(document.documentElement"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6342; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065; classtype:attempted-admin; sid:32461; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CPtsTextParaclient out of bounds error remote code execution attempt"; flow:to_client,established; file_data; content:"position: relative"; nocase; content:"position: fixed"; nocase; content:"display: block"; nocase; content:"appendChild(document.createElement"; fast_pattern:only; content:"addNode(document.documentElement"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6342; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065; classtype:attempted-admin; sid:32460; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer clipboardData unauthorized JavaScript read and write attempt"; flow:to_server,established; file_data; content:"onpaste"; nocase; content:"clipboardData.getData"; distance:0; content:"clipboardData.setData"; within:150; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6323; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065; classtype:attempted-admin; sid:32459; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer clipboardData unauthorized JavaScript read and write attempt"; flow:to_client,established; file_data; content:"onpaste"; nocase; content:"clipboardData.getData"; distance:0; content:"clipboardData.setData"; within:150; nocase; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6323; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065; classtype:attempted-admin; sid:32458; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CElementIDContextList use after free attempt"; flow:to_server,established; file_data; content:"|27|NaN|27|, |27|thick|27|, |27|DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD|27|, |27|dir"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6343; reference:cve,2015-1662; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032; classtype:attempted-user; sid:32443; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CElementIDContextList use after free attempt"; flow:to_client,established; file_data; content:"|27|NaN|27|, |27|thick|27|, |27|DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD|27|, |27|dir"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6343; reference:cve,2015-1662; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032; classtype:attempted-user; sid:32442; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"; flow:to_client,established; file_data; content:"document.createElement('BUTTON')"; content:"id_1.insertBefore(id_14, id_1.childNodes[1])"; fast_pattern:only; content:"id_2.offsetLeft = id_2.offsetLeft"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6344; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065; classtype:attempted-user; sid:32441; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"; flow:to_server,established; file_data; content:"document.createElement('BUTTON')"; content:"id_1.insertBefore(id_14, id_1.childNodes[1])"; fast_pattern:only; content:"id_2.offsetLeft = id_2.offsetLeft"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6344; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065; classtype:attempted-user; sid:32440; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 9 CHTMLEditorProxy use after free attempt"; flow:to_server,established; file_data; content:"|5C|u475046"; fast_pattern:only; content:"onkeydown"; content:"window.location.reload"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6353; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065; classtype:attempted-user; sid:32439; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 CHTMLEditorProxy use after free attempt"; flow:to_client,established; file_data; content:"|5C|u475046"; fast_pattern:only; content:"onkeydown"; content:"window.location.reload"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6353; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065; classtype:attempted-user; sid:32438; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer document.URL override information disclosure attempt"; flow:to_server,established; file_data; content:"IE_DisplayURL"; fast_pattern:only; content:".ExecWB(51, "; content:"<script"; metadata:policy security-ips drop, service smtp; reference:cve,2014-6340; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065; classtype:attempted-recon; sid:32437; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer document.URL override information disclosure attempt"; flow:to_client,established; file_data; content:"IE_DisplayURL"; fast_pattern:only; content:".ExecWB(51, "; content:"<script"; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6340; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065; classtype:attempted-recon; sid:32436; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CHeaderElement object use-after-free remote code execution attempt"; flow:to_server,established; file_data; content:"createRange().pasteHTML("; nocase; content:"createTextRange()"; within:70; nocase; content:"moveToElementText(document.getElementsByTagName"; within:100; nocase; content:"select()"; within:100; nocase; content:"insertimage"; within:100; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6348; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065; classtype:attempted-admin; sid:32431; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHeaderElement object use-after-free remote code execution attempt"; flow:to_client,established; file_data; content:"createRange().pasteHTML("; nocase; content:"createTextRange()"; within:70; nocase; content:"moveToElementText(document.getElementsByTagName"; within:100; nocase; content:"select()"; within:100; nocase; content:"insertimage"; within:100; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6348; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065; classtype:attempted-admin; sid:32430; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer contentEditable use after free attempt"; flow:to_server,established; file_data; content:".contentEditable"; nocase; content:"true"; within:15; nocase; content:"document.selection.createRange().scrollIntoView("; within:100; nocase; content:".contentEditable"; within:75; nocase; content:"false"; within:15; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6337; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065; classtype:attempted-user; sid:32427; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer contentEditable use after free attempt"; flow:to_client,established; file_data; content:".contentEditable"; nocase; content:"true"; within:15; nocase; content:"document.selection.createRange().scrollIntoView("; within:100; nocase; content:".contentEditable"; within:75; nocase; content:"false"; within:15; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6337; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065; classtype:attempted-user; sid:32426; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer object type confusion remote code execution attempt"; flow:to_server,established; file_data; content:".createTextNode|28|"; nocase; content:".__proto__"; within:100; nocase; content:"document.documentElement.dataset"; within:40; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6347; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065; classtype:attempted-user; sid:32425; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer object type confusion remote code execution attempt"; flow:to_client,established; file_data; content:".createTextNode|28|"; nocase; content:".__proto__"; within:100; nocase; content:"document.documentElement.dataset"; within:40; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6347; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065; classtype:attempted-user; sid:32424; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer style sheet array memory corruption attempt"; flow:to_server,established; file_data; content:"document.styleSheets|5B|"; fast_pattern; nocase; content:"|5D|.imports"; within:10; nocase; content:".appendChild|28|"; within:40; nocase; content:".removeChild|28|"; within:40; nocase; content:"outerHTML"; within:40; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,40410; reference:cve,2010-1117; reference:cve,2010-1118; reference:cve,2010-1259; reference:cve,2010-1262; reference:cve,2011-0027; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-035; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-002; classtype:attempted-user; sid:32532; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 VBScript redim preserve denial-of-service attempt"; flow:to_server,established; file_data; content:"myarray"; content:"chrw"; within:10; content:"chrw"; within:20; content:"32767"; within:10; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6332; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-064; classtype:attempted-dos; sid:32565; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 VBScript redim preserve denial-of-service attempt"; flow:to_client,established; file_data; content:"myarray"; content:"chrw"; within:10; content:"chrw"; within:20; content:"32767"; within:10; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6332; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-064; classtype:attempted-dos; sid:32564; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 VBScript redim preserve denial-of-service attempt"; flow:to_server,established; file_data; content:"redim  Preserve arr(&h8000002)"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6332; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-064; classtype:attempted-dos; sid:32630; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 VBScript redim preserve denial-of-service attempt"; flow:to_client,established; file_data; content:"redim  Preserve arr(&h8000002)"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6332; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-064; classtype:attempted-dos; sid:32629; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos insertAdjacentText use after free attempt"; flow:to_server,established; file_data; content:"addEventListener"; nocase; content:"DOMSubtreeModified"; within:30; nocase; content:"currentTarget.insertAdjacentText"; within:300; nocase; content:"currentTarget.insertAdjacentText"; within:75; nocase; metadata:policy security-ips drop, service smtp; reference:cve,2014-6329; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-080; classtype:attempted-user; sid:32725; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos insertAdjacentText use after free attempt"; flow:to_client,established; file_data; content:"addEventListener"; nocase; content:"DOMSubtreeModified"; within:30; nocase; content:"currentTarget.insertAdjacentText"; within:300; nocase; content:"currentTarget.insertAdjacentText"; within:75; nocase; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6329; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-080; classtype:attempted-user; sid:32724; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CButton object use after free attempt"; flow:to_server,established; file_data; content:".attachEvent("; nocase; content:".fireEvent("; within:100; nocase; content:".attachEvent("; within:100; nocase; content:".fireEvent("; within:100; nocase; content:".attachEvent("; within:100; nocase; content:".fireEvent("; within:100; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6375; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-080; classtype:attempted-user; sid:32723; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CButton object use after free attempt"; flow:to_client,established; file_data; content:".attachEvent("; nocase; content:".fireEvent("; within:100; nocase; content:".attachEvent("; within:100; nocase; content:".fireEvent("; within:100; nocase; content:".attachEvent("; within:100; nocase; content:".fireEvent("; within:100; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6375; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-080; classtype:attempted-user; sid:32722; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer element type confusion use after free attempt"; flow:to_server,established; file_data; content:"attachEvent("; nocase; content:"onpropertychange"; within:30; nocase; content:"createTFoot()"; distance:0; nocase; content:"setAttribute("; within:30; nocase; content:"innerHTML"; within:20; nocase; content:"true"; within:10; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-8966; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-080; classtype:attempted-user; sid:32721; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer element type confusion use after free attempt"; flow:to_client,established; file_data; content:"attachEvent("; nocase; content:"onpropertychange"; within:30; nocase; content:"createTFoot()"; distance:0; nocase; content:"setAttribute("; within:30; nocase; content:"innerHTML"; within:20; nocase; content:"true"; within:10; nocase; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-8966; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-080; classtype:attempted-user; sid:32720; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 7 CTreeNode object remote code execution attempt"; flow:to_server,established; file_data; content:"contentEditable"; content:"true"; within:20; content:"attachEvent"; within:50; content:"onpropertychange"; within:50; content:"applyElement"; within:75; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6366; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-080; classtype:attempted-user; sid:32717; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 7 CTreeNode object remote code execution attempt"; flow:to_client,established; file_data; content:"contentEditable"; content:"true"; within:20; content:"attachEvent"; within:50; content:"onpropertychange"; within:50; content:"applyElement"; within:75; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6366; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-080; classtype:attempted-user; sid:32716; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 10 CTableSection remote code execution attempt"; flow:to_server,established; file_data; content:"createElement"; content:"setAttribute"; within:100; content:"clearAttributes"; within:50; content:"null"; within:20; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6369; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-080; classtype:attempted-user; sid:32715; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 10 CTableSection remote code execution attempt"; flow:to_client,established; file_data; content:"createElement"; content:"setAttribute"; within:100; content:"clearAttributes"; within:50; content:"null"; within:20; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6369; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-080; classtype:attempted-user; sid:32714; rev:1;)
# alert tcp $HOME_NET any -> any $HTTP_PORTS (msg:"BROWSER-IE Microsoft Internet Explorer XSS filter bypass attempt"; flow:to_server,established; content:"%253C"; fast_pattern:only; content:"%253C"; nocase; http_raw_uri; content:"%253E"; distance:4; nocase; http_raw_uri; metadata:service http; reference:cve,2014-6365; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-080; classtype:web-application-attack; sid:32710; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE VBScript RegEx use-after-free attempt"; flow:to_client, established; file_data; content:"|7C|()*?"; fast_pattern:only; content:"New RegExp"; content:".Global"; within:100; content:"True"; within:10; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2014-6363; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-080; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-084; classtype:attempted-user; sid:32709; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer use of rtf file in clipboard attempt"; flow:to_server,established; file_data; content:"designMode"; content:"execCommand"; within:100; content:"InsertInputFileUpload"; within:50; content:"execCommand"; within:50; content:"Copy"; within:25; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6374; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-080; classtype:attempted-user; sid:32704; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer use of rtf file in clipboard attempt"; flow:to_client,established; file_data; content:"designMode"; content:"execCommand"; within:100; content:"InsertInputFileUpload"; within:50; content:"execCommand"; within:50; content:"Copy"; within:25; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6374; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-080; classtype:attempted-user; sid:32703; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer JPEG stack information disclosure attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|FF D8|"; content:"|FF C0|"; distance:0; content:"|FF C4|"; distance:0; content:"|11 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; within:17; distance:2; fast_pattern; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6355; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-085; classtype:attempted-user; sid:32702; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer JPEG stack information disclosure attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|FF D8|"; content:"|FF C0|"; distance:0; content:"|FF C4|"; distance:0; content:"|11 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; within:17; distance:2; fast_pattern; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6355; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-085; classtype:attempted-user; sid:32701; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer JPEG stack information disclosure attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|FF D8|"; content:"|FF C0|"; distance:0; content:"|FF C4|"; distance:0; content:"|10 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; within:17; distance:2; fast_pattern; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6355; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-085; classtype:attempted-user; sid:32700; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer JPEG stack information disclosure attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|FF D8|"; content:"|FF C0|"; distance:0; content:"|FF C4|"; distance:0; content:"|10 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; within:17; distance:2; fast_pattern; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6355; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-085; classtype:attempted-user; sid:32699; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer JPEG stack information disclosure attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|FF D8|"; content:"|FF C0|"; distance:0; content:"|FF C4|"; distance:0; content:"|01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; within:17; distance:2; fast_pattern; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6355; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-085; classtype:attempted-user; sid:32698; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer JPEG stack information disclosure attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|FF D8|"; content:"|FF C0|"; distance:0; content:"|FF C4|"; distance:0; content:"|01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; within:17; distance:2; fast_pattern; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6355; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-085; classtype:attempted-user; sid:32697; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer JPEG stack information disclosure attempt"; flow:to_server,established; file_data; content:"|FF D8 FF|"; depth:3; fast_pattern; content:"|FF C0|"; distance:0; content:"|FF C4|"; distance:0; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; within:17; distance:2; metadata:service smtp; reference:cve,2014-6355; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-085; classtype:attempted-user; sid:32696; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer JPEG stack information disclosure attempt"; flow:to_client,established; file_data; content:"|FF D8 FF|"; depth:3; fast_pattern; content:"|FF C0|"; distance:0; content:"|FF C4|"; distance:0; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; within:17; distance:2; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2014-6355; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-085; classtype:attempted-user; sid:32695; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CSS out-of-bounds buffer access attempt"; flow:to_server,established; file_data; content:"#thiz_iz a {"; content:".wesome {          }"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6368; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-080; classtype:attempted-user; sid:32694; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSS out-of-bounds buffer access attempt"; flow:to_client,established; file_data; content:"#thiz_iz a {"; content:".wesome {          }"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6368; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-080; classtype:attempted-user; sid:32693; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer NodeFilter use after free attempt"; flow:to_server,established; file_data; content:"NodeFilter.FILTER_REJECT"; fast_pattern:only; content:".createTreeWalker"; nocase; content:".execCommand"; distance:0; nocase; content:".appendChild"; distance:0; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6330; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-080; classtype:attempted-user; sid:32692; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer NodeFilter use after free attempt"; flow:to_client,established; file_data; content:"NodeFilter.FILTER_REJECT"; fast_pattern:only; content:".createTreeWalker"; nocase; content:".execCommand"; distance:0; nocase; content:".appendChild"; distance:0; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6330; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-080; classtype:attempted-user; sid:32691; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer style object type confusion attempt"; flow:to_server,established; file_data; content:"SetTimeout("; nocase; content:".parentNode.appendChild("; within:150; nocase; content:".style.setProperty("; within:150; nocase; content:"table-cell"; within:35; nocase; content:".style.setProperty("; within:150; nocase; content:"relative"; within:35; nocase; content:"location.reload"; within:150; nocase; metadata:policy security-ips drop, service smtp; reference:cve,2014-6373; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-080; classtype:attempted-user; sid:32690; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer style object type confusion attempt"; flow:to_client,established; file_data; content:"SetTimeout("; nocase; content:".parentNode.appendChild("; within:150; nocase; content:".style.setProperty("; within:150; nocase; content:"table-cell"; within:35; nocase; content:".style.setProperty("; within:150; nocase; content:"relative"; within:35; nocase; content:"location.reload"; within:150; nocase; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6373; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-080; classtype:attempted-user; sid:32689; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer setTimeout use after free attempt"; flow:to_server,established; file_data; content:"iframe"; nocase; content:"getElementById"; within:300; nocase; content:".removeChild"; within:50; nocase; content:"delete"; within:20; nocase; content:".appendChild"; distance:0; nocase; content:"setTimeout("; within:30; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6327; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-080; classtype:attempted-user; sid:32686; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer setTimeout use after free attempt"; flow:to_client,established; file_data; content:"iframe"; nocase; content:"getElementById"; within:300; nocase; content:".removeChild"; within:50; nocase; content:"delete"; within:20; nocase; content:".appendChild"; distance:0; nocase; content:"setTimeout("; within:30; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6327; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-080; classtype:attempted-user; sid:32685; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer lineboxbuilder out of bound array access attempt"; flow:to_server,established; file_data; content:"nth-child("; nocase; content:"::before"; within:20; nocase; content:".createTextRange("; nocase; content:".insertAdjacentHTML("; within:100; nocase; content:"beforeend"; within:20; nocase; metadata:policy security-ips drop, service smtp; reference:cve,2014-6376; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-080; classtype:attempted-user; sid:32680; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer lineboxbuilder out of bound array access attempt"; flow:to_client,established; file_data; content:"nth-child("; nocase; content:"::before"; within:20; nocase; content:".createTextRange("; nocase; content:".insertAdjacentHTML("; within:100; nocase; content:"beforeend"; within:20; nocase; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6376; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-080; classtype:attempted-user; sid:32679; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer TextRange after free attempt "; flow:to_server,established; file_data; content:"createTextRange"; content:"moveToElementText"; content:".children["; within:50; content:"execCommand"; content:"InsertInput"; within:40; content:"execCommand"; content:"RemoveFormat"; within:40; content:"<body onload="; metadata:policy max-detect-ips drop, service smtp; reference:cve,2014-0307; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012; classtype:attempted-user; sid:32763; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer TextRange after free attempt "; flow:to_client,established; file_data; content:"createTextRange"; content:"moveToElementText"; content:".children["; within:50; content:"execCommand"; content:"InsertInput"; within:40; content:"execCommand"; content:"RemoveFormat"; within:40; content:"<body onload="; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0307; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012; classtype:attempted-user; sid:32762; rev:6;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CheaderElement use after free attempt"; flow:to_server,established; file_data; content:".styleSheets[0].insertRule(' * {display: run-in|3B|}', 0)"; fast_pattern:only; content:"defaultView.scrollBy(1, 1)"; content:".execCommand('selectAll'"; within:200; content:".execCommand('justifyLeft'"; within:200; content:".getSelection().deleteFromDocument()"; within:200; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-8967; classtype:attempted-user; sid:32778; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CheaderElement use after free attempt"; flow:to_client,established; file_data; content:".styleSheets[0].insertRule(' * {display: run-in|3B|}', 0)"; fast_pattern:only; content:"defaultView.scrollBy(1, 1)"; content:".execCommand('selectAll'"; within:200; content:".execCommand('justifyLeft'"; within:200; content:".getSelection().deleteFromDocument()"; within:200; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-8967; classtype:attempted-user; sid:32777; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Oracle WebCenter BlackIceDevMode ActiveX buffer overflow attempt"; flow:established,to_server; file_data; content:"BLACKICEDEVMODE.BlackIceDEVMODECtrl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22BLACKICEDEVMODE\.BlackIceDEVMODECtrl(\.\d*)?\x22|\x27BLACKICEDEVMODE\.BlackIceDEVMODECtrl(\.\d*)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*SetAnnotationFont\s*|.*(?P=v)\s*\.\s*SetAnnotationFont\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22BLACKICEDEVMODE\.BlackIceDEVMODECtrl(\.\d*)?\x22|\x27BLACKICEDEVMODE\.BlackIceDEVMODECtrl(\.\d*)?\x27)\s*\)(\s*\.\s*SetAnnotationFont\s*|.*(?P=n)\s*\.\s*SetAnnotationFont\s*)/smiO"; metadata:policy max-detect-ips drop, service smtp; reference:url,www.oracle.com/technetwork/topics/security/cpuapr2013-1899555.html; classtype:attempted-user; sid:33021; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Oracle WebCenter BlackIceDevMode ActiveX buffer overflow attempt"; flow:established,to_client; file_data; content:"BLACKICEDEVMODE.BlackIceDEVMODECtrl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22BLACKICEDEVMODE\.BlackIceDEVMODECtrl(\.\d*)?\x22|\x27BLACKICEDEVMODE\.BlackIceDEVMODECtrl(\.\d*)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*SetAnnotationFont\s*|.*(?P=v)\s*\.\s*SetAnnotationFont\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22BLACKICEDEVMODE\.BlackIceDEVMODECtrl(\.\d*)?\x22|\x27BLACKICEDEVMODE\.BlackIceDEVMODECtrl(\.\d*)?\x27)\s*\)(\s*\.\s*SetAnnotationFont\s*|.*(?P=n)\s*\.\s*SetAnnotationFont\s*)/smiO"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,www.oracle.com/technetwork/topics/security/cpuapr2013-1899555.html; classtype:attempted-user; sid:33020; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Oracle WebCenter BlackIceDevMode ActiveX buffer overflow attempt"; flow:established,to_server; file_data; content:"1503569a-0ae2-4333-b6e6-466ab0bc73e5"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>|\x2F)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*1503569a-0ae2-4333-b6e6-466ab0bc73e5\s*}?\s*(?P=q1)(\s|>|\x2F).*(?P=id1)\s*\.\s*(SetAnnotationFont)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*1503569a-0ae2-4333-b6e6-466ab0bc73e5\s*}?\s*(?P=q2)(\s|>|\x2F)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>|\x2F).*(?P=id2)\.(SetAnnotationFont))/siO"; metadata:policy max-detect-ips drop, service smtp; reference:url,www.oracle.com/technetwork/topics/security/cpuapr2013-1899555.html; classtype:attempted-user; sid:33019; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Oracle WebCenter BlackIceDevMode ActiveX buffer overflow attempt"; flow:established,to_client; file_data; content:"1503569a-0ae2-4333-b6e6-466ab0bc73e5"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>|\x2F)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*1503569a-0ae2-4333-b6e6-466ab0bc73e5\s*}?\s*(?P=q1)(\s|>|\x2F).*(?P=id1)\s*\.\s*(SetAnnotationFont)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*1503569a-0ae2-4333-b6e6-466ab0bc73e5\s*}?\s*(?P=q2)(\s|>|\x2F)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>|\x2F).*(?P=id2)\.(SetAnnotationFont))/siO"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,www.oracle.com/technetwork/topics/security/cpuapr2013-1899555.html; classtype:attempted-user; sid:33018; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CAnchorElement use after free attempt"; flow:to_client,established; file_data; content:"window.location.href"; nocase; content:"document.write("; nocase; pcre:"/window\.location\.href=[\x22\x27]\x23(?P<anchor>\w+)[\x22\x27].*?document\.write\x28[\x22\x27](?!(?P=anchor)).*?a\sname\s*=\s*[\x22\x27](?P=anchor)/smi"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3871; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-088; classtype:attempted-user; sid:33099; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos Use After Free attempt"; flow:to_server,established; file_data; content:"innerText"; content:"<textarea"; within:300; distance:10; content:"display|3A|"; within:50; distance:1; content:"ruby"; within:10; pcre:"/function\s+(?P<funcName>\w+)\(\)\s*\{[^}]+innerText\s*=.{0,200}onload\s*=\s*(\x22|\x27)(?P=funcName)\x3B(\x22|\x27).{0,100}<textarea.{0,50}style=(\x22|\x27)display\x3A\s*ruby\x3B(\x22|\x27)/smi"; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3845; reference:url,www.osvdb.org/show/osvdb/97097; classtype:attempted-user; sid:33098; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos Use After Free attempt"; flow:to_client,established; file_data; content:"innerText"; content:"<textarea"; within:300; distance:10; content:"display|3A|"; within:50; distance:1; content:"ruby"; within:10; pcre:"/function\s+(?P<funcName>\w+)\(\)\s*\{[^}]+innerText\s*=.{0,200}onload\s*=\s*(\x22|\x27)(?P=funcName)\(\)\x3B(\x22|\x27).{0,100}<textarea.{0,50}style=(\x22|\x27)display\x3A\s*ruby\x3B(\x22|\x27)/smi"; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3845; reference:url,www.osvdb.org/show/osvdb/97097; classtype:attempted-user; sid:33097; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos Use After Free attempt"; flow:to_server,established; file_data; content:"inner"; content:"textarea"; within:300; distance:10; content:"display|3A|"; within:50; distance:1; content:"ruby"; within:10; pcre:"/for\s*\([^{]+document\.[^}]+inner(HTML|Text)\s*=.{0,300}textarea\s*\{.{0,50}display\x3A\s*ruby/smi"; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3845; reference:url,www.osvdb.org/show/osvdb/97097; classtype:attempted-user; sid:33096; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos Use After Free attempt"; flow:to_client,established; file_data; content:"inner"; content:"textarea"; within:300; distance:10; content:"display|3A|"; within:50; distance:1; content:"ruby"; within:10; pcre:"/for\s*\([^{]+document\.[^}]+inner(HTML|Text)\s*=.{0,300}textarea\s*\{.{0,50}display\x3A\s*ruby/smi"; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3845; reference:url,www.osvdb.org/show/osvdb/97097; classtype:attempted-user; sid:33095; rev:6;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CInput element user after free attempt"; flow:to_server,established; file_data; content:"input"; content:"type"; within:200; content:"radio"; within:200; content:"onpropertychange"; within:200; pcre:"/<input\s[^>]*?type\s*=\s*[\x22\x27]?radio[\x22\x27]?.*?(?P<doc>\w+)\.checked[^>]+(?P=doc)\.onpropertychange[^>]+?\.checked/si"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0286; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:33094; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CInput element user after free attempt"; flow:to_client,established; file_data; content:"input"; content:"type"; within:200; content:"radio"; within:200; content:"onpropertychange"; within:200; pcre:"/<input\s[^>]*?type\s*=\s*[\x22\x27]?radio[\x22\x27]?.*?(?P<doc>\w+)\.checked[^>]+(?P=doc)\.onpropertychange[^>]+?\.checked/si"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0286; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010; classtype:attempted-user; sid:33093; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 10 use after free attempt"; flow:to_server,established; file_data; content:"%5b%27%67%65%74%45%6c%65%6d%65%6e%74%73%42%79%54%61%67%4e%61%6d%65%27%5d%28%27%73%63%72%69%70%74%27%29%3b"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0322; reference:url,technet.microsoft.com/en-us/security/advisory/2934088; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012; classtype:attempted-user; sid:33086; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 10 use after free attempt"; flow:to_client,established; file_data; content:"%5b%27%67%65%74%45%6c%65%6d%65%6e%74%73%42%79%54%61%67%4e%61%6d%65%27%5d%28%27%73%63%72%69%70%74%27%29%3b"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0322; reference:url,technet.microsoft.com/en-us/security/advisory/2934088; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012; classtype:attempted-user; sid:33085; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Internet Explorer 11 VBScript redim preserve denial-of-service attempt"; flow:to_server,established; file_data; content:"HIvIauuKF6i9p*qI1wE8J*znjk3Yl8td"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6332; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-064; classtype:attempted-dos; sid:33116; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Internet Explorer 11 VBScript redim preserve denial-of-service attempt"; flow:to_client,established; file_data; content:"HIvIauuKF6i9p*qI1wE8J*znjk3Yl8td"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6332; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-064; classtype:attempted-dos; sid:33115; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CClipStack array index exploitation attempt"; flow:to_server,established; file_data; content:"<canvas"; content:".getContext"; content:"2d"; within:5; content:".strokeRect"; within:1000; fast_pattern; content:"0"; within:30; pcre:"/\x2estrokeRect\x28([^\x2c]+\x2c){2}([^\x2c]+\x2c[0\s]*\x29|[0\s]*\x2c[^\x29]+\x29)/i"; metadata:policy security-ips drop, service smtp; reference:cve,2014-1773; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-035; classtype:attempted-user; sid:33158; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CClipStack array index exploitation attempt"; flow:to_client,established; file_data; content:"<canvas"; content:".getContext"; content:"2d"; within:5; content:".strokeRect"; within:1000; fast_pattern; content:"0"; within:30; pcre:"/\x2estrokeRect\x28([^\x2c]+\x2c){2}([^\x2c]+\x2c[0\s]*\x29|[0\s]*\x2c[^\x29]+\x29)/i"; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-1773; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-035; classtype:attempted-user; sid:33157; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Internet Explorer CQuotes use-after-free attempt"; flow:to_server,established; file_data; content:"document[|22|createElement|22|]('fr' + |22|name|22|.substr(1,3) + 's' + |22|e|22| + 't')"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6351; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065; classtype:attempted-user; sid:33196; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Internet Explorer CQuotes use-after-free attempt"; flow:to_client,established; file_data; content:"document[|22|createElement|22|]('fr' + |22|name|22|.substr(1,3) + 's' + |22|e|22| + 't')"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6351; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065; classtype:attempted-user; sid:33195; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Internet Explorer CQuotes use-after-free attempt"; flow:to_server,established; file_data; content:"[|22|appendChild|22|](document.createElement(|22|french|22|.substr(0,2) + 'ame' + |22|marmaset|22|.substr(5,3)))"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6351; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065; classtype:attempted-user; sid:33194; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Internet Explorer CQuotes use-after-free attempt"; flow:to_server,established; file_data; content:"[|22|appendChild|22|](document.createElement('fr' + |22|name|22|.substr(1,3) + 's' + |22|e|22| + 't'))"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6351; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065; classtype:attempted-user; sid:33193; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Internet Explorer CQuotes use-after-free attempt"; flow:to_client,established; file_data; content:"[|22|appendChild|22|](document.createElement(|22|french|22|.substr(0,2) + 'ame' + |22|marmaset|22|.substr(5,3)))"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6351; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065; classtype:attempted-user; sid:33192; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Internet Explorer CQuotes use-after-free attempt"; flow:to_client,established; file_data; content:"[|22|appendChild|22|](document.createElement('fr' + |22|name|22|.substr(1,3) + 's' + |22|e|22| + 't'))"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6351; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065; classtype:attempted-user; sid:33191; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer same origin policy bypass attempt"; flow:to_server,established; file_data; content:"<iframe"; nocase; content:"src"; within:150; nocase; content:".php"; within:50; nocase; content:"<iframe"; within:200; nocase; content:"src"; within:150; nocase; content:"http"; within:50; nocase; content:"<script"; distance:0; nocase; content:"top"; within:100; content:".location="; within:100; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0072; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-018; classtype:attempted-user; sid:33288; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer same origin policy bypass attempt"; flow:to_client,established; file_data; content:"<iframe"; nocase; content:"src"; within:150; nocase; content:".php"; within:50; nocase; content:"<iframe"; within:200; nocase; content:"src"; within:150; nocase; content:"http"; within:50; nocase; content:"<script"; distance:0; nocase; content:"top"; within:100; content:".location="; within:100; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0072; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-018; classtype:attempted-user; sid:33287; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CMarkupTransNavContext object use after free attempt"; flow:to_server,established; file_data; content:"onload"; content:".focus"; content:"history.go(0)"; fast_pattern:only; content:"onbeforeeditfocus"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0031; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009; classtype:attempted-user; sid:33428; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CMarkupTransNavContext object use after free attempt"; flow:to_client,established; file_data; content:"onload"; content:".focus"; content:"history.go(0)"; fast_pattern:only; content:"onbeforeeditfocus"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0031; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009; classtype:attempted-user; sid:33427; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup object use after free attempt"; flow:to_server,established; file_data; content:"onload"; nocase; content:"document.write"; within:25; nocase; content:"<embed></embed>"; within:25; fast_pattern; nocase; pcre:"/onload\s*?=[^>]*?document\.write\s*?\x28\s*?[\x22\x27]{2}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0018; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009; classtype:attempted-user; sid:33426; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup object use after free attempt"; flow:to_client,established; file_data; content:"onload"; nocase; content:"document.write"; within:25; nocase; content:"<embed></embed>"; within:25; fast_pattern; nocase; pcre:"/onload\s*?=[^>]*?document\.write\s*?\x28\s*?[\x22\x27]{2}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0018; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009; classtype:attempted-user; sid:33425; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CHeaderElement object use after free attempt"; flow:to_server,established; file_data; content:"display:block|3B|"; nocase; content:"<iframe></iframe>"; within:200; nocase; content:"onload"; within:400; nocase; content:".contentDocument"; within:200; nocase; content:"insertRule(' * {display: run-in|3B|}')|3B|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-8967; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009; classtype:attempted-user; sid:33424; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHeaderElement object use after free attempt"; flow:to_client,established; file_data; content:"display:block|3B|"; nocase; content:"<iframe></iframe>"; within:200; nocase; content:"onload"; within:400; nocase; content:".contentDocument"; within:200; nocase; content:"insertRule(' * {display: run-in|3B|}')|3B|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-8967; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009; classtype:attempted-user; sid:33423; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer memory leak exploit attempt"; flow:to_client,established; file_data; content:"payload += "; content:"i<0x50000"; content:"document.execCommand(|22|Outdent|22|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2015-0037; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009; classtype:attempted-user; sid:33422; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE CTreeDataPos use-after-free remote code execution attempt"; flow:established,to_client; file_data; content:"document.createRange()"; content:"document.createDocumentFragment()"; within:100; content:"appendChild("; within:100; content:".selectNodeContents("; within:150; content:".replaceNode("; within:100; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2015-0041; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33421; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos use after free attempt"; flow:to_server,established; file_data; content:"document.createElement(|22|cite|22|)"; fast_pattern:only; content:".applyElement"; content:"try"; within:200; content:".scrollIntoView(false)"; within:200; content:".execCommand(|22|SelectAll|22|)"; within:200; content:".removeNode"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0068; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009; classtype:attempted-user; sid:33420; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos use after free attempt"; flow:to_client,established; file_data; content:"document.createElement(|22|cite|22|)"; fast_pattern:only; content:".applyElement"; content:"try"; within:200; content:".scrollIntoView(false)"; within:200; content:".execCommand(|22|SelectAll|22|)"; within:200; content:".removeNode"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0068; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009; classtype:attempted-user; sid:33419; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CGenericElement use after free attempt"; flow:established,to_server; file_data; content:"selection.createRange().scrollIntoView(true)"; fast_pattern; content:".createElement(|22|frameset|22|)"; content:"CollectGarbage()"; content:"|3C|v|3A|oval"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0017; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33418; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CGenericElement use after free attempt"; flow:established,to_client; file_data; content:"selection.createRange().scrollIntoView(true)"; fast_pattern; content:".createElement(|22|frameset|22|)"; content:"CollectGarbage()"; content:"|3C|v|3A|oval"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0017; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33417; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CLineCore use after free attempt"; flow:to_server,established; file_data; content:".runtimeStyle.position"; nocase; content:".parentNode"; within:75; nocase; content:".parentNode.removeNode"; within:75; nocase; content:".appendChild"; within:75; nocase; pcre:"/(?P<ref>\w+)\s*?=\s*?(?P<obj>\w+)\x2eparentNode.*?(?P=obj)\x2eparentNode\x2eremoveNode.*?(?P=obj)\x2eappendChild\s*?\x28\s*?(?P=ref)/si"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0045; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009; classtype:attempted-user; sid:33416; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CLineCore use after free attempt"; flow:to_client,established; file_data; content:".runtimeStyle.position"; nocase; content:".parentNode"; within:75; nocase; content:".parentNode.removeNode"; within:75; nocase; content:".appendChild"; within:75; nocase; pcre:"/(?P<ref>\w+)\s*?=\s*?(?P<obj>\w+)\x2eparentNode.*?(?P=obj)\x2eparentNode\x2eremoveNode.*?(?P=obj)\x2eappendChild\s*?\x28\s*?(?P=ref)/si"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0045; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009; classtype:attempted-user; sid:33415; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer unitialized memory access attempt"; flow:to_server,established; file_data; content:"div:first-line"; content:"background:"; within:50; content:"margin"; distance:0; content:"document.createElement(|27|div|27|)"; content:"document.createElement(|27|a|27|)"; fast_pattern:only; content:"appendChild"; content:"appendChild"; distance:0; pcre:"/(\w*)\s*=\s*document.createElement\(\'div\'\).*?(\w*)\s*=\s*document\.createElement\(\'a\'\).*?\1\.appendChild\(\2\)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0051; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33414; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer unitialized memory access attempt"; flow:to_client,established; file_data; content:"div:first-line"; content:"background:"; within:50; content:"margin"; distance:0; content:"document.createElement(|27|div|27|)"; content:"document.createElement(|27|a|27|)"; fast_pattern:only; content:"appendChild"; content:"appendChild"; distance:0; pcre:"/(\w*)\s*=\s*document.createElement\(\'div\'\).*?(\w*)\s*=\s*document\.createElement\(\'a\'\).*?\1\.appendChild\(\2\)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0051; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33413; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Internet Explorer style type confusion remote code execution attempt"; flow:established,to_client; file_data; content:"setTimeout(function()"; content:".setAttribute(|27|class|27|"; within:75; content:"setTimeout("; within:75; content:".removeAttribute(|27|class|27|)"; within:75; content:"location.reload()"; within:150; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2015-0052; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33412; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CMapElement use-after-free attempt"; flow:to_server,established; file_data; content:".addEventListener|28 22|readystatechange|22|, onReadyStateChangeCallback"; fast_pattern:only; content:".createElement|28 22|oContainer|22 29|"; nocase; content:".createElement|28 22|map|22 29|"; within:100; nocase; content:".createElement|28 22|applet|22 29|"; within:100; nocase; content:".createElement|28 22|map|22 29|"; within:100; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0040; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33366; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CMapElement use-after-free attempt"; flow:to_client,established; file_data; content:".addEventListener|28 22|readystatechange|22|, onReadyStateChangeCallback"; fast_pattern:only; content:".createElement|28 22|oContainer|22 29|"; nocase; content:".createElement|28 22|map|22 29|"; within:100; nocase; content:".createElement|28 22|applet|22 29|"; within:100; nocase; content:".createElement|28 22|map|22 29|"; within:100; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0040; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33365; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CCharFormat use-after-free attempt"; flow:to_client,established; file_data; content:"document.body.createTextRange("; content:"|22|onpropertychange|22|"; distance:0; content:"moveToElementText"; distance:0; content:"execCommand("; distance:0; content:".select("; distance:0; content:".innerText"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0029; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-admin; sid:33361; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer svg use after free attempt"; flow:to_server,established; file_data; content:"altGlyph"; content:"marker"; within:50; content:"switch"; within:100; content:"marker-start"; within:50; content:"marker-mid"; within:100; content:"InsertOrderedList"; distance:0; content:"getElementsByTagNameNS"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0042; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33360; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer svg use after free attempt"; flow:to_client,established; file_data; content:"altGlyph"; content:"marker"; within:50; content:"switch"; within:100; content:"marker-start"; within:50; content:"marker-mid"; within:100; content:"InsertOrderedList"; distance:0; content:"getElementsByTagNameNS"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0042; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33359; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer SLayoutRun use-after-free attempt"; flow:to_client,established; file_data; content:"setTimeout|28|"; content:".setAttribute"; within:200; content:"setTimeout|28|"; within:200; content:"document.write"; within:200; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2015-0050; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009; classtype:attempted-user; sid:33358; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode object used after free attempt"; flow:to_server,established; file_data; content:"<ruby>"; content:"getElementsByTagName(|22|li|22|"; fast_pattern; nocase; content:"innerText"; within:50; content:"ruby"; content:"removeNode"; within:50; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0023; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33357; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode object used after free attempt"; flow:to_client,established; file_data; content:"<ruby>"; content:"getElementsByTagName(|22|li|22|"; fast_pattern; nocase; content:"innerText"; within:50; content:"ruby"; content:"removeNode"; within:50; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0023; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33356; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CAttrArray object used after free attempt"; flow:to_server,established; file_data; content:".execCommand|28 27|Delete|27 29|"; fast_pattern:only; content:"document.body.createTextRange"; content:"root.removeChild(root.firstChild)"; pcre:"/var\s*([\d\w]*)\s*=\s*document\.body\.createTextRange.*?\1\.execCommand\(\'Delete\'\)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0038; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33354; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CAttrArray object used after free attempt"; flow:to_client,established; file_data; content:".execCommand|28 27|Delete|27 29|"; fast_pattern:only; content:"document.body.createTextRange"; content:"root.removeChild(root.firstChild)"; pcre:"/var\s*([\d\w]*)\s*=\s*document\.body\.createTextRange.*?\1\.execCommand\(\'Delete\'\)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0038; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33353; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"BROWSER-IE Microsoft Internet Explorer 9 error handler XSS exploit attempt"; flow:to_server,established; content:"onerror=eval"; http_uri; content:"throw"; distance:1; http_uri; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2015-0070; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009; classtype:attempted-user; sid:33352; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer dximagetransform.microsoft.shadow out of bounds array access attempt"; flow:to_server,established; file_data; content:"dximagetransform.microsoft.shadow"; nocase; content:"direction"; distance:0; nocase; pcre:"/dximagetransform\.microsoft\.shadow\x28[^\x29]*?direction\s*?=\s*?\d{10}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0036; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33349; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer dximagetransform.microsoft.shadow out of bounds array access attempt"; flow:to_client,established; file_data; content:"dximagetransform.microsoft.shadow"; nocase; content:"direction"; distance:0; nocase; pcre:"/dximagetransform\.microsoft\.shadow\x28[^\x29]*?direction\s*?=\s*?\d{10}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0036; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33348; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos use-after-free attempt"; flow:to_client,established; file_data; content:".style.whiteSpace"; content:"pre"; within:20; content:".offsetWidth"; within:200; content:"document.body.createTextRange|28 29|"; within:200; fast_pattern; content:"CollectGarbage|28 29|"; within:200; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2015-0021; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009; classtype:attempted-user; sid:33347; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CBatchParentUndoUnit object use after free attempt"; flow:to_server,established; file_data; content:"var documentFragment = id_2000.extractContents()"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0030; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33346; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CBatchParentUndoUnit object use after free attempt"; flow:to_client,established; file_data; content:"var documentFragment = id_2000.extractContents()"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0030; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33345; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CParaElement use after free attempt"; flow:to_server,established; file_data; content:".createTextRange("; fast_pattern; nocase; content:".onresize"; within:100; nocase; content:"function"; within:20; nocase; content:".execCommand"; within:50; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0019; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33341; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CParaElement use after free attempt"; flow:to_client,established; file_data; content:".createTextRange("; fast_pattern; nocase; content:".onresize"; within:100; nocase; content:"function"; within:20; nocase; content:".execCommand"; within:50; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0019; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33340; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer runtimeStyle use-after-free attempt"; flow:to_server,established; file_data; content:".runtimeStyle"; content:".left"; within:100; content:"auto"; within:20; nocase; content:"posLeft"; distance:0; content:"NaN"; within:15; content:"window.x"; within:50; metadata:service smtp; reference:cve,2015-0053; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33338; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer runtimeStyle use-after-free attempt"; flow:to_client,established; file_data; content:".runtimeStyle"; content:".left"; within:100; content:"auto"; within:20; nocase; content:"posLeft"; distance:0; content:"NaN"; within:15; content:"window.x"; within:50; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2015-0053; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33337; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer ActiveX type confusion attempt"; flow:to_server,established; file_data; content:"884E2049-217D-11DA-B2A4-000E7BBB2B09"; fast_pattern:only; content:"document.body.swapNode"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0046; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33336; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer ActiveX type confusion attempt"; flow:to_client,established; file_data; content:"884E2049-217D-11DA-B2A4-000E7BBB2B09"; fast_pattern:only; content:"document.body.swapNode"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0046; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33335; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer Hyphenator object use after free attempt"; flow:to_server,established; file_data; content:".getElementsByTagName("; nocase; content:"html"; within:50; nocase; content:"columnWidth"; within:250; nocase; content:"msHyphens"; within:250; nocase; content:"auto"; within:50; nocase; content:"outlineStyle"; within:250; nocase; content:".replaceAdjacentText("; fast_pattern; nocase; content:"afterBegin"; within:50; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0039; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009; classtype:attempted-user; sid:33334; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Hyphenator object use after free attempt"; flow:to_client,established; file_data; content:".getElementsByTagName("; nocase; content:"html"; within:50; nocase; content:"columnWidth"; within:250; nocase; content:"msHyphens"; within:250; nocase; content:"auto"; within:50; nocase; content:"outlineStyle"; within:250; nocase; content:".replaceAdjacentText("; fast_pattern; nocase; content:"afterBegin"; within:50; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0039; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009; classtype:attempted-user; sid:33333; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditorProxy use after free attempt"; flow:to_server,established; file_data; content:"window.open("; nocase; content:".designMode"; nocase; content:"on"; within:20; nocase; content:".execCommand("; within:250; nocase; content:"InsertFieldset"; within:20; fast_pattern; nocase; content:".execCommand("; within:250; nocase; content:"delete"; within:20; nocase; content:".designMode"; within:250; nocase; content:"off"; within:20; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0049; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009; classtype:attempted-user; sid:33332; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditorProxy use after free attempt"; flow:to_client,established; file_data; content:"window.open("; nocase; content:".designMode"; nocase; content:"on"; within:20; nocase; content:".execCommand("; within:250; nocase; content:"InsertFieldset"; within:20; fast_pattern; nocase; content:".execCommand("; within:250; nocase; content:"delete"; within:20; nocase; content:".designMode"; within:250; nocase; content:"off"; within:20; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0049; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009; classtype:attempted-user; sid:33331; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CFormElement use after free attempt"; flow:to_server,established; file_data; content:".createElement("; nocase; content:"form"; within:20; nocase; content:".appendChild("; within:100; nocase; content:".createElement("; within:200; nocase; content:".appendChild("; within:100; nocase; content:"null"; nocase; content:".body.innerHTML"; within:50; nocase; content:"CollectGarbage("; within:50; fast_pattern; nocase; content:"document.write("; within:250; nocase; pcre:"/null[^\x7d]{0,50}\.body\.innerHTML\s*?\x3d\s*?[\x22\x27]{2}[^\x7d]{0,50}CollectGarbage\x28\s*?\x29[^\x7d]{0,250}document\.write\x28\s*?[\x22\x27]{2}/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0026; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009; classtype:attempted-user; sid:33325; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CFormElement use after free attempt"; flow:to_client,established; file_data; content:".createElement("; nocase; content:"form"; within:20; nocase; content:".appendChild("; within:100; nocase; content:".createElement("; within:200; nocase; content:".appendChild("; within:100; nocase; content:"null"; nocase; content:".body.innerHTML"; within:50; nocase; content:"CollectGarbage("; within:50; fast_pattern; nocase; content:"document.write("; within:250; nocase; pcre:"/null[^\x7d]{0,50}\.body\.innerHTML\s*?\x3d\s*?[\x22\x27]{2}[^\x7d]{0,50}CollectGarbage\x28\s*?\x29[^\x7d]{0,250}document\.write\x28\s*?[\x22\x27]{2}/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0026; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009; classtype:attempted-user; sid:33324; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer uninitialized pointer use exploit attempt"; flow:to_client,established; file_data; content:"document.getElementById("; content:".recordset"; within:36; distance:4; content:"document.getElementById("; distance:0; content:".DataSource"; distance:0; pcre:"/(?<RS>\w+)\s?=\s?document\x2egetElementById\x28[\x22\x27]\w+[\x22\x27]\x29\x2erecordset.*(?<OBJ>\w+)\s?=\s?document.getElementById\x28[\x22\x27]\w+[\x22\x27]\x29.*\k<RS>.DataSource\s?=\s?\k<OBJ>/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0067; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-admin; sid:33323; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer EPM MOTWCreateFileW file access bypass attempt"; flow:to_server,established; file_data; content:"|3A FF 75 08 0F 57 C0 66 0F D6 06 C7 46 08 00 00 00 00 C7 46 04 00 00 00 00 C7 46 08 01|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0055; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009; classtype:policy-violation; sid:33322; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer EPM MOTWCreateFileW file access bypass attempt"; flow:to_server,established; file_data; content:"|08 E8 32 07 00 00 83 C0 20 50 E8 64 09 00 00 8B F8 89 7D E4 E8 1F 07 00 00 83 C0 20 50 56 E8 F1|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0055; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009; classtype:policy-violation; sid:33321; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer EPM MOTWCreateFileW file access bypass attempt"; flow:to_client,established; file_data; content:"|3A FF 75 08 0F 57 C0 66 0F D6 06 C7 46 08 00 00 00 00 C7 46 04 00 00 00 00 C7 46 08 01|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0055; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009; classtype:policy-violation; sid:33320; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer EPM MOTWCreateFileW file access bypass attempt"; flow:to_client,established; file_data; content:"|08 E8 32 07 00 00 83 C0 20 50 E8 64 09 00 00 8B F8 89 7D E4 E8 1F 07 00 00 83 C0 20 50 56 E8 F1|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0055; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009; classtype:policy-violation; sid:33319; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode use after free attempt"; flow:to_server,established; file_data; content:".execCommand"; nocase; content:"insertOrderedList"; within:50; fast_pattern; nocase; content:".attachEvent"; nocase; content:"onpropertychange"; within:50; nocase; content:"noframes"; nocase; content:"iframe"; nocase; pcre:"/(?P<obj>\w+)\s*?=\s*?document\.body\.createtextrange.*?(?P=obj)\.execCommand\s*?\x28\s*?[\x22\x27]\s*?insertOrderedList/si"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0020; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33318; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode use after free attempt"; flow:to_client,established; file_data; content:".execCommand"; nocase; content:"insertOrderedList"; within:50; fast_pattern; nocase; content:".attachEvent"; nocase; content:"onpropertychange"; within:50; nocase; content:"noframes"; nocase; content:"iframe"; nocase; pcre:"/(?P<obj>\w+)\s*?=\s*?document\.body\.createtextrange.*?(?P=obj)\.execCommand\s*?\x28\s*?[\x22\x27]\s*?insertOrderedList/si"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0020; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33317; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CElement use after free attempt"; flow:to_server,established; file_data; content:"ms-clearUndoStack"; fast_pattern:only; content:".setStartBefore"; nocase; content:".setEnd"; within:200; nocase; content:"InsertIFrame"; within:200; nocase; content:".scrollIntoView"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0035; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009; classtype:attempted-user; sid:33316; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CElement use after free attempt"; flow:to_client,established; file_data; content:"ms-clearUndoStack"; fast_pattern:only; content:".setStartBefore"; nocase; content:".setEnd"; within:200; nocase; content:"InsertIFrame"; within:200; nocase; content:".scrollIntoView"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0035; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009; classtype:attempted-user; sid:33315; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CGeneratedSvgTreeNode use-after-free attempt"; flow:to_client,established; file_data; content:"<svg>"; content:"<linearGradient"; distance:0; content:"|22|linearGradient|22|"; fast_pattern; content:".x1.baseVal"; within:25; distance:2; pcre:"/<linearGradient[^>]*>\s*<\x2flinearGradient>/i"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0043; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33314; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer InsertElementInternal out of bounds indexed array remote code execution attempt"; flow:to_server,established; file_data; content:".insertBefore(document.body)"; nocase; content:"createElement("; within:60; nocase; content:"TR"; within:5; nocase; content:"<body"; distance:0; nocase; content:"</body>"; within:60; nocase; pcre:"/insertBefore\(document\.body\)([^?]+createElement\([\x22\x27]TR[\x22\x27]\)\))+[^?]+<body[^?]+?<\/body>/i"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0044; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33313; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer InsertElementInternal out of bounds indexed array remote code execution attempt"; flow:to_client,established; file_data; content:".insertBefore(document.body)"; content:"createElement("; within:60; nocase; content:"TR"; within:5; nocase; content:"<body"; distance:0; nocase; content:"</body>"; within:60; nocase; pcre:"/insertBefore\(document\.body\)([^?]+createElement\([\x22\x27]TR[\x22\x27]\)\))+[^?]+<body[^?]+?<\/body>/i"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0044; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009; classtype:attempted-user; sid:33312; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer dynamic style update memory corruption attempt"; flow:to_client,established; file_data; content:"<br"; nocase; content:"<textarea"; within:75; fast_pattern; nocase; content:"</textarea"; within:15; nocase; content:".getElementByID"; distance:0; nocase; content:".className"; within:75; nocase; pcre:"/<style[^>]*?>[\r\n\s]+?\.(?P<class>\w+)[\r\n\s]*?\{[\r\n\s]*?zoom\x3a\s*?\d+px\x3b.*?<br\s[^>]*?id\s*?=\s*?[\x22\x27]?(?P<id>\w+)[\x22\x27]?[^>]*?>[^<]*?<textarea.*?document\.getElementById\s*?\(\s*?[\x22\x27]?(?P=id).*?\.className\s*?=\s*?[\x22\x27]?(?P=class)/si"; metadata:service http; reference:cve,2009-0076; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-002; classtype:attempted-user; sid:33495; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer dynamic style update memory corruption attempt"; flow:to_client,established; file_data; content:"<h3"; nocase; content:"<textarea"; within:75; fast_pattern; nocase; content:"</textarea"; within:15; nocase; content:".getElementByID"; distance:0; nocase; content:".className"; within:75; nocase; pcre:"/<style[^>]*?>[\r\n\s]+?\.(?P<class>\w+)[\r\n\s]*?\{[\r\n\s]*?zoom\x3a\s*?\d+px\x3b.*?<h3\s[^>]*?id\s*?=\s*?[\x22\x27]?(?P<id>\w+)[\x22\x27]?[^>]*?>[^<]*?<textarea.*?document\.getElementById\s*?\(\s*?[\x22\x27]?(?P=id).*?\.className\s*?=\s*?[\x22\x27]?(?P=class)/si"; metadata:service http; reference:cve,2009-0076; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-002; classtype:attempted-user; sid:33494; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer dynamic style update memory corruption attempt"; flow:to_client,established; file_data; content:"<h2"; nocase; content:"<textarea"; within:75; fast_pattern; nocase; content:"</textarea"; within:15; nocase; content:".getElementByID"; distance:0; nocase; content:".className"; within:75; nocase; pcre:"/<style[^>]*?>[\r\n\s]+?\.(?P<class>\w+)[\r\n\s]*?\{[\r\n\s]*?zoom\x3a\s*?\d+px\x3b.*?<h2\s[^>]*?id\s*?=\s*?[\x22\x27]?(?P<id>\w+)[\x22\x27]?[^>]*?>[^<]*?<textarea.*?document\.getElementById\s*?\(\s*?[\x22\x27]?(?P=id).*?\.className\s*?=\s*?[\x22\x27]?(?P=class)/si"; metadata:service http; reference:cve,2009-0076; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-002; classtype:attempted-user; sid:33493; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer dynamic style update memory corruption attempt"; flow:to_client,established; file_data; content:"<h1"; nocase; content:"<textarea"; within:75; fast_pattern; nocase; content:"</textarea"; within:15; nocase; content:".getElementByID"; distance:0; nocase; content:".className"; within:75; nocase; pcre:"/<style[^>]*?>[\r\n\s]+?\.(?P<class>\w+)[\r\n\s]*?\{[\r\n\s]*?zoom\x3a\s*?\d+px\x3b.*?<h1\s[^>]*?id\s*?=\s*?[\x22\x27]?(?P<id>\w+)[\x22\x27]?[^>]*?>[^<]*?<textarea.*?document\.getElementById\s*?\(\s*?[\x22\x27]?(?P=id).*?\.className\s*?=\s*?[\x22\x27]?(?P=class)/si"; metadata:service http; reference:cve,2009-0076; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-002; classtype:attempted-user; sid:33492; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTableLayout memory corruption attempt"; flow:to_server,established; file_data; content:"document.getElementById("; nocase; content:"HTML"; within:50; content:".onpropertychange"; nocase; content:"<table"; nocase; content:"<col"; within:15; nocase; pcre:"/function\s*(?<del_func>\w+)\x28\s*\x29\s*\x7b[^\x7d]+?\x2e(inner|outer)HTML\s*=\s*[\x22\x27].*[\x22\x27].*\x2eonpropertychange\s*=\s*\k<del_func>/smi"; metadata:service smtp; reference:bugtraq,37891; reference:cve,2010-0244; reference:url,osvdb.org/show/osvdb/61910; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-002; classtype:attempted-user; sid:33570; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTableLayout memory corruption attempt"; flow:to_client,established; file_data; content:"document.getElementById("; nocase; content:"HTML"; within:50; content:".onpropertychange"; nocase; content:"<table"; nocase; content:"<col"; within:15; nocase; pcre:"/function\s*(?<del_func>\w+)\x28\s*\x29\s*\x7b[^\x7d]+?\x2e(inner|outer)HTML\s*=\s*[\x22\x27].*[\x22\x27].*\x2eonpropertychange\s*=\s*\k<del_func>/smi"; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,37891; reference:cve,2010-0244; reference:url,osvdb.org/show/osvdb/61910; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-002; classtype:attempted-user; sid:33569; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CAnchorElement use after free attempt"; flow:to_server,established; file_data; content:".runtimeStyle.posWidth"; content:"(|7E 7E|"; within:10; content:".focus()"; within:20; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3882; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-080; classtype:attempted-user; sid:33606; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CAnchorElement use after free attempt"; flow:to_client,established; file_data; content:".runtimeStyle.posWidth"; content:"(|7E 7E|"; within:10; content:".focus()"; within:20; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3882; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-080; classtype:attempted-user; sid:33605; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer Java applet denial of service attempt"; flow:to_server,established; file_data; content:"<APPLET"; nocase; content:"HSPACE"; within:50; nocase; content:"file:"; within:10; nocase; metadata:service smtp; reference:bugtraq,15208; classtype:attempted-dos; sid:33639; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Java applet denial of service attempt"; flow:to_client,established; file_data; content:"<APPLET"; nocase; content:"HSPACE"; within:50; nocase; content:"file:"; within:10; nocase; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,15208; classtype:attempted-dos; sid:33638; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 CInputContext object use after free attempt"; flow:to_server,established; file_data; content:"createTextRange"; content:"execCommand"; within:50; nocase; content:"JustifyRight"; within:20; nocase; content:"null"; within:10; nocase; content:"true"; within:10; nocase; content:"execCommand"; within:30; nocase; content:"copy"; within:10; nocase; metadata:policy security-ips drop, service smtp; reference:cve,2015-1634; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-018; classtype:attempted-user; sid:33764; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 CInputContext object use after free attempt"; flow:to_client,established; file_data; content:"createTextRange"; content:"execCommand"; within:50; nocase; content:"JustifyRight"; within:20; nocase; content:"null"; within:10; nocase; content:"true"; within:10; nocase; content:"execCommand"; within:30; nocase; content:"copy"; within:10; nocase; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-1634; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-018; classtype:attempted-user; sid:33763; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer table cell out-of-bounds access attempt"; flow:to_server,established; file_data; content:"X-UA-Compatible"; fast_pattern; content:"IE=5"; within:30; content:".swapNode"; nocase; content:".mergeAttributes"; within:100; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-1625; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-018; classtype:attempted-user; sid:33744; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer table cell out-of-bounds access attempt"; flow:to_client,established; file_data; content:"X-UA-Compatible"; fast_pattern; content:"IE=5"; within:30; content:".swapNode"; nocase; content:".mergeAttributes"; within:100; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-1625; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-018; classtype:attempted-user; sid:33743; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode use-after-free attempt"; flow:to_server,established; file_data; content:".onfocusout"; nocase; content:".setActive"; fast_pattern; nocase; content:".setActive"; within:40; nocase; content:".setActive"; within:40; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0100; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-018; classtype:attempted-user; sid:33742; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode use-after-free attempt"; flow:to_client,established; file_data; content:".onfocusout"; nocase; content:".setActive"; fast_pattern; nocase; content:".setActive"; within:40; nocase; content:".setActive"; within:40; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0100; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-018; classtype:attempted-user; sid:33741; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 CInputContext object use after free attempt"; flow:to_server,established; file_data; content:".removeNode"; nocase; content:"contentEditable"; nocase; content:".onfocusin"; within:70; nocase; content:"createElement"; nocase; content:"SELECT"; within:30; nocase; content:".autofocus"; within:50; nocase; content:"true"; within:20; nocase; metadata:policy security-ips drop, service smtp; reference:cve,2015-1626; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-018; classtype:attempted-user; sid:33739; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 CInputContext object use after free attempt"; flow:to_client,established; file_data; content:".removeNode"; nocase; content:"contentEditable"; nocase; content:".onfocusin"; within:70; nocase; content:"createElement"; nocase; content:"SELECT"; within:30; nocase; content:".autofocus"; within:50; nocase; content:"true"; within:20; nocase; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-1626; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-018; classtype:attempted-user; sid:33738; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CGeneratedTreeNode use after free attempt"; flow:to_server,established; file_data; content:".getElementsByTagName"; content:".innerText"; within:50; content:".execCommand"; within:100; content:"selectAll"; within:20; content:".innerHTML"; within:150; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-1624; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-018; classtype:attempted-user; sid:33737; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CGeneratedTreeNode use after free attempt"; flow:to_client,established; file_data; content:".getElementsByTagName"; content:".innerText"; within:50; content:".execCommand"; within:100; content:"selectAll"; within:20; content:".innerHTML"; within:150; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-1624; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-018; classtype:attempted-user; sid:33736; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer out of bounds array access attempt"; flow:to_server,established; file_data; content:"key-frame"; fast_pattern; nocase; content:"from"; within:200; nocase; content:"cursor"; within:200; nocase; content:"url()"; within:200; nocase; content:"auto"; within:50; nocase; content:"opacity:"; nocase; content:"inherit"; within:50; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0099; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-018; classtype:attempted-user; sid:33731; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer out of bounds array access attempt"; flow:to_client,established; file_data; content:"key-frame"; fast_pattern; nocase; content:"from"; within:200; nocase; content:"cursor"; within:200; nocase; content:"url()"; within:200; nocase; content:"auto"; within:50; nocase; content:"opacity:"; nocase; content:"inherit"; within:50; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0099; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-018; classtype:attempted-user; sid:33730; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup object use after free attempt"; flow:to_server,established; file_data; content:".createDocumentFragment"; nocase; content:".createDocumentFragment"; within:500; nocase; content:".createDocumentFragment"; within:500; nocase; content:"MutationObserver"; fast_pattern:only; content:".replaceNode"; content:".adoptNode"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-1623; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-018; classtype:attempted-user; sid:33727; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup object use after free attempt"; flow:to_client,established; file_data; content:".createDocumentFragment"; nocase; content:".createDocumentFragment"; within:500; nocase; content:".createDocumentFragment"; within:500; nocase; content:"MutationObserver"; fast_pattern:only; content:".replaceNode"; nocase; content:".adoptNode"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-1623; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-018; classtype:attempted-user; sid:33726; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 sandbox bypass attempt"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|6A 19 53 FF 15 08 10 41 00 85 C0 74 17 FF 37 FF 15 0C 10 41 00 0F B6 00 48 50 FF 37 FF 15 10 10|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-1627; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-018; classtype:attempted-user; sid:33721; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 sandbox bypass attempt"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|6A 19 53 FF 15 08 10 41 00 85 C0 74 17 FF 37 FF 15 0C 10 41 00 0F B6 00 48 50 FF 37 FF 15 10 10|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-1627; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-018; classtype:attempted-user; sid:33720; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode interpreted as CGeneratedTreeNode remote code execution attempt"; flow:established,to_server; file_data; content:"list-item"; content:"url|28|data:text/plain|2C|"; within:150; content:".id"; content:"document.body.offsetTop"; within:75; content:".id"; within:50; content:"document.body.offsetTop"; within:75; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-1622; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-018; classtype:attempted-user; sid:33719; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode interpreted as CGeneratedTreeNode remote code execution attempt"; flow:established,to_client; file_data; content:"list-item"; content:"url|28|data:text/plain|2C|"; within:150; content:".id"; content:"document.body.offsetTop"; within:75; content:".id"; within:50; content:"document.body.offsetTop"; within:75; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-1622; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-018; classtype:attempted-user; sid:33718; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 VBScript array element use after free attempt"; flow:to_server,established; file_data; content:"Execute "; nocase; content:"ReDim "; within:7; nocase; content:"ReDim "; within:100; nocase; content:"Filter("; within:80; fast_pattern; nocase; pcre:"/Execute\s[\x22\x27]ReDim\s(?P<array>\w+)\([\w\x2c]+\)[^>]*?ReDim\s(?P=array)[^>]*?(?P=array)[^>]*?Filter\((?P=array)/sm"; metadata:policy security-ips drop, service smtp; reference:cve,2015-0032; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-018; classtype:attempted-user; sid:33710; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 VBScript array element use after free attempt"; flow:to_client,established; file_data; content:"Execute "; nocase; content:"ReDim "; within:7; nocase; content:"ReDim "; within:100; nocase; content:"Filter("; within:80; fast_pattern; nocase; pcre:"/Execute\s[\x22\x27]ReDim\s(?P<array>\w+)\([\w\x2c]+\)[^>]*?ReDim\s(?P=array)[^>]*?(?P=array)[^>]*?Filter\((?P=array)/sm"; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0032; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-018; classtype:attempted-user; sid:33709; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"; flow:to_server,established; file_data; content:"['lastChild']['parentNode']['firstChild']['parentNode'].cloneNode"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0056; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-018; classtype:attempted-user; sid:33708; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"; flow:to_client,established; file_data; content:"['lastChild']['parentNode']['firstChild']['parentNode'].cloneNode"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0056; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-018; classtype:attempted-user; sid:33707; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer out of bounds array access attempt"; flow:to_server,established; file_data; content:".insertAdjacentElement"; nocase; content:"afterbegin"; within:25; nocase; content:".selectAllChildren"; within:100; nocase; content:".insertAdjacentElement"; within:100; nocase; content:"beforebegin"; within:25; nocase; content:".push("; within:50; nocase; content:".push("; within:50; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0081; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-020; classtype:attempted-user; sid:33776; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer out of bounds array access attempt"; flow:to_client,established; file_data; content:".insertAdjacentElement"; nocase; content:"afterbegin"; within:25; nocase; content:".selectAllChildren"; within:100; nocase; content:".insertAdjacentElement"; within:100; nocase; content:"beforebegin"; within:25; nocase; content:".push("; within:50; nocase; content:".push("; within:50; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0081; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-020; classtype:attempted-user; sid:33775; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer javascript iframe injection attempt"; flow:to_server,established; file_data; content:"<iframe"; nocase; content:"src"; within:150; nocase; content:".php"; within:50; nocase; content:"<iframe"; within:200; nocase; content:"src"; within:150; nocase; content:"http"; within:50; nocase; content:"<script"; distance:0; nocase; content:"top["; within:50; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0072; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-018; classtype:attempted-user; sid:33898; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer javascript iframe injection attempt"; flow:to_client,established; file_data; content:"<iframe"; nocase; content:"src"; within:150; nocase; content:".php"; within:50; nocase; content:"<iframe"; within:200; nocase; content:"src"; within:150; nocase; content:"http"; within:50; nocase; content:"<script"; distance:0; nocase; content:"top["; within:50; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0072; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-018; classtype:attempted-user; sid:33897; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 VBScript redim preserve denial-of-service attempt"; flow:to_server,established; file_data; content:"76723"; content:"wrhc"; within:10; content:"wrhc"; within:20; content:"yarraym"; within:10; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6332; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-064; classtype:attempted-dos; sid:33980; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 VBScript redim preserve denial-of-service attempt"; flow:to_client,established; file_data; content:"76723"; content:"wrhc"; within:10; content:"wrhc"; within:20; content:"yarraym"; within:10; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6332; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-064; classtype:attempted-dos; sid:33979; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer MSXML3 external entity injection attempt"; flow:to_server,established; file_data; content:"ENTITY %"; content:"ENTITY % "; within:30; nocase; content:" SYSTEM"; within:20; nocase; content:"://"; within:10; pcre:"/ENTITY \x25 \w+ SYSTEM.{0,10}(http|file):\x2f\x2f/i"; metadata:policy security-ips drop, service smtp; reference:cve,2015-1646; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-039; classtype:attempted-admin; sid:34098; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer MSXML3 external entity injection attempt"; flow:to_client,established; file_data; content:"ENTITY %"; nocase; content:"ENTITY % "; within:30; nocase; content:" SYSTEM"; within:20; nocase; content:"://"; within:10; pcre:"/ENTITY \x25 \w+ SYSTEM.{0,10}(http|file):\x2f\x2f/i"; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-1646; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-039; classtype:attempted-admin; sid:34097; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer incorrect array element read information disclosure attempt"; flow:to_server,established; file_data; content:".insertBefore("; content:".createTextNode("; within:50; content:".childNodes"; within:50; content:".normalize()"; fast_pattern:only; content:"document.createElement("; content:"document.body.appendChild("; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-1657; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032; classtype:attempted-user; sid:34090; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer incorrect array element read information disclosure attempt"; flow:to_client,established; file_data; content:".insertBefore("; content:".createTextNode("; within:50; content:".childNodes"; within:50; content:".normalize()"; fast_pattern:only; content:"document.createElement("; content:"document.body.appendChild("; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-1657; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032; classtype:attempted-user; sid:34089; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CDocument use after free attempt"; flow:established,to_server; file_data; content:"window.location.href=baseURL|2B 22|?refresh="; fast_pattern:only; content:"createEvent"; content:"FocusEvent"; within:20; content:"initEvent"; within:50; content:"focus"; within:20; content:"dispatchEvent"; within:75; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-1652; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-032; classtype:attempted-user; sid:34085; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CDocument use after free attempt"; flow:established,to_client; file_data; content:"window.location.href=baseURL|2B 22|?refresh="; fast_pattern:only; content:"createEvent"; content:"FocusEvent"; within:20; content:"initEvent"; within:50; content:"focus"; within:20; content:"dispatchEvent"; within:75; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-1652; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-032; classtype:attempted-user; sid:34084; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer append and swap use after free attempt"; flow:to_server,established; file_data; content:".appendChild"; content:".appendChild"; within:100; content:".appendChild"; within:100; content:".appendChild"; within:100; content:".swapNode"; distance:0; content:".swapNode"; within:100; content:".swapNode"; within:100; content:".swapNode"; within:100; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-1659; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-032; classtype:attempted-user; sid:34077; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer append and swap use after free attempt"; flow:to_client,established; file_data; content:".appendChild"; content:".appendChild"; within:100; content:".appendChild"; within:100; content:".appendChild"; within:100; content:".swapNode"; distance:0; content:".swapNode"; within:100; content:".swapNode"; within:100; content:".swapNode"; within:100; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-1659; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-032; classtype:attempted-user; sid:34076; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer TextData object use after free attempt"; flow:to_server,established; file_data; content:".createTextRange"; fast_pattern:only; content:".moveToElementText"; nocase; content:".moveEnd"; within:500; nocase; content:".moveToElementText"; within:500; nocase; content:".removeChild"; nocase; content:".innerHTML"; nocase; content:":nth-child("; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-1665; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-032; classtype:attempted-user; sid:34075; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer TextData object use after free attempt"; flow:to_client,established; file_data; content:".createTextRange"; fast_pattern:only; content:".moveToElementText"; nocase; content:".moveEnd"; within:500; nocase; content:".moveToElementText"; within:500; nocase; content:".removeChild"; nocase; content:".innerHTML"; nocase; content:":nth-child("; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-1665; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-032; classtype:attempted-user; sid:34074; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CMetaElement use after free attempt"; flow:established,to_server; file_data; content:"createRange()"; content:"MutationObserver"; within:200; content:".insertBefore"; content:"mutationRecordsList"; within:50; content:".observe(document"; within:200; content:".removeChild"; within:200; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-1666; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-032; classtype:attempted-user; sid:34073; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CMetaElement use after free attempt"; flow:established,to_client; file_data; content:"createRange()"; content:"MutationObserver"; within:200; content:".insertBefore"; content:"mutationRecordsList"; within:50; content:".observe(document"; within:200; content:".removeChild"; within:200; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-1666; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-032; classtype:attempted-user; sid:34072; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CSVGMarkerElement use after free attempt"; flow:to_server,established; file_data; content:".baseVal.convertToSpecifiedUnits"; fast_pattern:only; content:"<svg"; content:"<circle"; distance:0; content:"<marker"; distance:0; content:"<marker"; distance:0; content:"document.createRange()"; content:".deleteContents()"; within:200; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-1668; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032; classtype:attempted-user; sid:34071; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSVGMarkerElement use after free attempt"; flow:to_client,established; file_data; content:".baseVal.convertToSpecifiedUnits"; fast_pattern:only; content:"<svg"; content:"<circle"; distance:0; content:"<marker"; distance:0; content:"<marker"; distance:0; content:"document.createRange()"; content:".deleteContents()"; within:200; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-1668; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032; classtype:attempted-user; sid:34070; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 invalid array element read attempt"; flow:to_server,established; file_data; content:".toString"; content:"function"; within:13; content:"typeof("; within:50; content:".offsetLeft"; within:50; content:"createTextRange"; distance:0; content:".removeNode"; within:100; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-1661; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-032; classtype:attempted-user; sid:34069; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 invalid array element read attempt"; flow:to_client,established; file_data; content:".toString"; content:"function"; within:13; content:"typeof("; within:50; content:".offsetLeft"; within:50; content:"createTextRange"; distance:0; content:".removeNode"; within:100; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-1661; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-032; classtype:attempted-user; sid:34068; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CMapStringToPtr use after free attempt"; flow:to_server,established; file_data; content:"appendChild"; nocase; content:"createElement"; within:40; nocase; content:"FRAMESET"; within:30; nocase; content:"innerHTML"; within:40; nocase; content:"<th id"; distance:0; nocase; content:"removeNode"; within:100; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-1667; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-032; classtype:attempted-user; sid:34065; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CMapStringToPtr use after free attempt"; flow:to_client,established; file_data; content:"appendChild"; nocase; content:"createElement"; within:40; nocase; content:"FRAMESET"; within:30; nocase; content:"innerHTML"; within:40; nocase; content:"<th id"; distance:0; nocase; content:"removeNode"; within:100; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-1667; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-032; classtype:attempted-user; sid:34064; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CBodyElement use after free attempt"; flow:to_server,established; file_data; content:"onpropertychange"; nocase; content:"defaultView.focus"; within:40; nocase; content:"<strong></strong>"; within:100; nocase; content:"<strong></strong>"; within:40; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-1660; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-032; classtype:attempted-user; sid:34060; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CBodyElement use after free attempt"; flow:to_client,established; file_data; content:"onpropertychange"; nocase; content:"defaultView.focus"; within:40; nocase; content:"<strong></strong>"; within:100; nocase; content:"<strong></strong>"; within:40; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-1660; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-032; classtype:attempted-user; sid:34059; rev:1;)
